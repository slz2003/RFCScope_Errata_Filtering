# Expert-Issues Summary (Excluding Router) — Section 2 (SSLKEYLOGFILE Format)

RFC: Unknown  
Section: 2 (format syntax/encoding + TLS 1.3 / ECH label rules)

This summarizes **all potential bugs raised by the experts** (not the router), deduplicated.

---

## 1) Incorrect Unicode code points for CR/LF line terminators

**Concise explanation:**  
Section 2 says parsers MUST accept CRLF/CR/LF as line terminators, but annotates them as **CRLF (U+13 followed by U+10), CR (U+13), LF (U+10)**. In Unicode `U+HHHH` is hexadecimal, so `U+13` = `U+0013` (DC3) and `U+10` = `U+0010` (DLE), not CR/LF. Correct code points are **CR = U+000D** and **LF = U+000A**.

**Justification:** ✅ Real inconsistency with clear interop impact  
All relevant experts agree this is a concrete, mechanistic spec bug:
- A literal implementation could treat **DC3/DLE** as line breaks and fail to parse normal files using standard platform newlines (CR/LF).
- This conflicts with ASCII (RFC 20) and the document’s own intent (“platform line ending convention”).

**Experts mentioning this issue:**  
- Causal (calls it a real mechanistic bug)  
- Quantitative  
- Deontic  
- Structural  
- CrossRFC

**Suggested fix (expert consensus):**
- Replace with:  
  - “CRLF (**U+000D** followed by **U+000A**), CR (**U+000D**), or LF (**U+000A**)”  
- Optionally add: “CR is decimal 13; LF is decimal 10” to avoid hex/decimal confusion.

---

## 2) Ambiguous / conflicting scope of `client_random` as a per-connection identifier under ECH (Inner vs Outer Random)

**Concise explanation:**  
Section 2 defines `client_random` globally as “the Random from the ClientHello that established the TLS connection” and says it “can be used to identify a connection.” But with ECH:
- TLS 1.3 traffic/exporter labels MUST use **Inner** ClientHello.Random when ECH is successfully negotiated.
- ECH labels (ECH_SECRET, ECH_CONFIG) MUST always use **Outer** ClientHello.Random.
Thus, a single underlying TLS connection can produce log entries with **two different** `client_random` values.

**Justification:** ⚠️ Likely real *underspecification / clarity* issue (not necessarily a protocol break)  
- **Scope** and **CrossRFC** argue the global wording implies “one random per connection,” which is no longer true under ECH; tools may fail to correlate ECH_* lines (outer random) with traffic secrets (inner random) unless the spec explicitly explains the two-key-space behavior.
- **Causal** views this as *not a fundamental bug*: the per-label rules are explicit and the mapping is deterministic for ECH-aware tools; the main problem is that the “identifies a connection” sentence becomes oversimplified and could mislead naive consumers.

**My take:** This is a **spec clarity gap** with realistic tooling/interoperability consequences, even if ECH-aware implementations can make it work. The definition should explicitly say that under ECH, `client_random` is **label-dependent** (inner vs outer), so consumers must not assume a 1:1 mapping between `client_random` and TCP/TLS connections.

**Experts mentioning this issue:**  
- Scope (primary)  
- CrossRFC (confidence: medium)

---

# Recap
**Expert-raised issues (deduplicated):**
1. **CR/LF code point bug** (hard inconsistency; must fix).
2. **`client_random` semantics under ECH** (underspecified / misleading global definition; should clarify).

---
