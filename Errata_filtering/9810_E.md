# Expert-Issues Summary (Excluding Router) — RFC 9810 Appendix E (KEM-based MAC Flows)

RFC: 9810  
Section: Appendix E  
(Profile status: Informative / Illustrative)

---

## Issue 1 — Ambiguity around `transactionID` usage in KEM handshakes (Appendix E vs core rules)

**Errata title:** Alleged ambiguity of `transactionID` in Appendix E KEM flows

**Concise explanation:**  
Appendix E’s figures show KEM setup exchanges (`genm/genp`) labeled as “unprotected” and do not explicitly mention `transactionID`. Since KEM-based MAC derivation requires `KemOtherInfo.transactionID` (taken from the message carrying the ciphertext), this raised concern that the flows might leave `transactionID` undefined.

**Justification:** ❌ **False positive**  
- Sections **5.1.1** and **5.1.3.4** already impose strict, normative rules:
  - **Any message that carries a `KemCiphertextInfo` with ciphertext MUST have a `transactionID`** (client-generated or server-generated).
  - `KemOtherInfo.transactionID` **MUST** be taken from *that* ciphertext-carrying message.
- In Appendix E:
  - When ciphertext is sent in a **response** (`genp`, Figure 3), the server is required to populate `transactionID`.
  - When ciphertext is sent in a **request** (Figure 4), the client is required to set `transactionID`.
- “Unprotected” in Appendix E refers only to **absence of PKIProtection**, not to omission of header fields.

**Conclusion:** The normative core fully determines `transactionID`; Appendix E is consistent though terse.

**Status:** False positive / no spec change needed.

---

## Issue 2 — Use of `wrongIntegrity` and *unprotected* ErrorMsg for KEM discovery (Figure 5)

**Errata title:** Appendix E Figure 5 conflicts with CA error-message protection requirements

**Concise explanation:**  
Figure 5 shows a “discovery/upgrade” flow where a PKI management entity replies with an **unprotected** `ErrorMsgContent` (`status = rejection`, `failInfo = wrongIntegrity`) and includes a KEM certificate in `extraCerts`, prompting the peer to retry using KEM-based MAC protection.

However, Section **5.3.21** states that **a CA MUST always sign ErrorMsgContent** with a signature key.

**Justification:** ⚠️ **Real but narrow inconsistency**  
- If the PKI management entity in Figure 5 is a **CA** (which is allowed by the text), then:
  - Appendix E instructs it to send an **unprotected** error, while
  - Section 5.3.21 mandates that **CA error messages must always be signed**.
- This is a genuine normative conflict for the CA role.
- Practical impact is limited:
  - Clients can process signed or unsigned errors.
  - Security is not fundamentally broken (the subsequent KEM handshake still authenticates the CA via its certificate).
- But implementers following Appendix E literally may violate a MUST-level requirement.

**Conclusion:** Real inconsistency between illustrative flow and base error-protection rules.

**Minimal clarification suggested:**
- Either:
  - State that the Figure 5 error **MUST still be signed when sent by a CA**, or
  - Scope the “unprotected error” example explicitly to **RA-only** behavior, or
  - Add an explicit exception for this KEM-discovery case.

---

## Non-Issue Clarifications

- **Use of `wrongIntegrity` as a KEM-upgrade signal**:  
  Acceptable but optional. The failure code already covers “integrity/protection mismatch,” which includes missing KEM ciphertext. Appendix E does not redefine `wrongIntegrity` normatively.
- **Alice/Bob naming confusion**:  
  Minor explanatory inconsistency (client vs server ownership of KEM key across figures), but protocol roles remain clear: *Alice = KEM private-key holder*, *Bob = ciphertext sender*. No wire-level impact.

---

## Final Assessment

- **Issue 1:** ❌ False positive (resolved by existing MUSTs in core sections)  
- **Issue 2:** ⚠️ Real, low-impact inconsistency (error-message protection for CA in Figure 5)

Appendix E remains implementable, but a small clarification would improve normative consistency.
