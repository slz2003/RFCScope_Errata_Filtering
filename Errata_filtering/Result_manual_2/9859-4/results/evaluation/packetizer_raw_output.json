{
  "reports": [
    {
      "label": "Ambiguous EDNS0 Report-Channel Option Usage in NOTIFY Messages vs RFC 9567",
      "bug_type": "Inconsistency",
      "explanation": "RFC 9859 permits senders to include an EDNS0 Report-Channel option in NOTIFY messages whereas RFC 9567 mandates that this option must not be included in queries, creating an ambiguity that could lead to divergent interpretations and implementations.",
      "justification": [
        "RFC 9859 Section 4.2.1 explicitly allows the inclusion of the EDNS0 Report-Channel option in NOTIFY messages to request error reporting, while RFC 9567 Section 6.1 states that the option MUST NOT be included in queries.",
        "This discrepancy in scope—where one document narrows the prohibition to resolver queries and the other does not—could result in inconsistent handling of NOTIFY messages."
      ],
      "evidence": {
        "snippets": [
          {
            "id": "E1",
            "text": "RFC 9859, Section 4.2.1: “senders MAY include an EDNS0 Report-Channel option [RFC9567] in the NOTIFY message to request that the receiving side report any errors by making a report query… (The prohibition of this option in queries ([RFC9567], Section 6.1) only applies to resolver queries and thus does not cover NOTIFY messages.)”"
          },
          {
            "id": "E2",
            "text": "RFC 9567, Section 6.1 (Reporting Resolver Specification): “The EDNS0 Report-Channel option MUST NOT be included in queries.”"
          }
        ],
        "summary": [
          "(E1) shows RFC 9859 granting permission to include the option in NOTIFY messages.",
          "(E2) shows RFC 9567’s blanket prohibition on including the option in queries."
        ]
      },
      "fix_direction": "Clarify the relationship between RFC 9859 and RFC 9567 by explicitly stating that NOTIFY messages are exempt from the prohibition, or update RFC 9567 to allow the option in this specific context.",
      "severity": "Medium",
      "severity_basis": "This issue may lead to implementation differences and interoperability risks if some implementations reject NOTIFY messages containing the Report-Channel option while others accept them.",
      "confidence": "High",
      "experts": [
        "Scope: Issue-1",
        "Causal: Issue 1",
        "Structural: Issue-1",
        "CrossRFC: Issue-1"
      ],
      "report_id": "9859-4-1"
    },
    {
      "label": "Ambiguous DNSSEC Validation Criteria for DSYNC Endpoint Discovery",
      "bug_type": "Underspecification",
      "explanation": "The specification does not clearly state which DNSSEC validation outcomes (Secure, Insecure, Bogus, or Indeterminate) qualify as a 'positive DSYNC answer', leaving room for divergent implementations.",
      "justification": [
        "RFC 9859 Section 4.1 instructs a sender to validate the DSYNC lookup if DNSSEC is enabled and to return the result if it constitutes a positive answer, but it does not define which DNSSEC validation states are acceptable.",
        "Multiple experts note that the lack of guidance on handling outcomes such as Bogus or Indeterminate leaves room for different security policies and behaviors."
      ],
      "evidence": {
        "snippets": [
          {
            "id": "E1",
            "text": "RFC 9859 Section 4.1 step 2: “Perform a lookup of type DSYNC for the lookup name, and validate the response if DNSSEC is enabled.  If this results in a positive DSYNC answer, return it.”"
          },
          {
            "id": "E2",
            "text": "It is RECOMMENDED that zones containing DSYNC records be secured with DNSSEC. … If so, the sender may choose to ignore unsigned DSYNC records."
          }
        ],
        "summary": [
          "(E1) outlines the DSYNC lookup and validation step without detailing acceptable validation outcomes.",
          "(E2) indicates the recommendation for DNSSEC without providing normative guidance on handling unsigned or failed validations."
        ]
      },
      "fix_direction": "Add explicit normative guidelines that specify which DNSSEC validation outcomes (e.g., Secure only, or Secure plus optionally Insecure) count as a positive DSYNC answer and how to handle Bogus or Indeterminate responses.",
      "severity": "Medium",
      "severity_basis": "Ambiguity in DNSSEC handling can lead to inconsistent endpoint selection, resulting either in missed notifications or potential exposure to spoofed targets.",
      "confidence": "High",
      "experts": [
        "Scope: Issue-2",
        "Causal: Issue 2",
        "Deontic: Issue-1",
        "Boundary: Finding-1"
      ],
      "report_id": "9859-4-2"
    },
    {
      "label": "Ambiguous Enforcement of Agent-Domain NS-Subordination for EDNS0 Report-Channel",
      "bug_type": "Underspecification",
      "explanation": "The document does not clearly specify which party (sender or receiver) is responsible for enforcing that the agent domain in the EDNS0 Report-Channel option is subordinate or equal to one of the child’s NS hostnames, and what action should be taken if the requirement is not met.",
      "justification": [
        "RFC 9859 Section 4.2.1 mandates that the agent domain in the Report-Channel option MUST be subordinate or equal to one of the NS hostnames, but Section 4.3 only states that if this condition is met, error reporting SHOULD occur.",
        "The ambiguity leaves uncertainty about whether the sender bears the responsibility to choose an appropriate agent domain or if the receiver must enforce the check and possibly reject or ignore the option if the condition is not fulfilled."
      ],
      "evidence": {
        "snippets": [
          {
            "id": "E1",
            "text": "RFC 9859 Section 4.2.1: “When including this EDNS0 option, the second label (QTYPE) of the report query name is equal to the qtype received in the NOTIFY message.  Its agent domain MUST be subordinate or equal to one of the NS hostnames, as listed in the child's delegation in the parent zone.  This is to prevent malicious senders from causing the NOTIFY recipient to send unsolicited report queries to unrelated third parties.”"
          },
          {
            "id": "E2",
            "text": "RFC 9859 Section 4.3: “If the NOTIFY message contains an EDNS0 Report-Channel option … with an agent domain subordinate or equal to one of the NS hostnames listed in the delegation, the processing party SHOULD report any errors occurring during CDS/CDNSKEY/CSYNC processing by sending a report query…”"
          }
        ],
        "summary": [
          "(E1) indicates the requirement for the agent domain but does not assign responsibility for enforcement.",
          "(E2) shows that receivers are only conditionally advised to send a report query, leaving the enforcement role ambiguous."
        ]
      },
      "fix_direction": "Clarify the text to specify whether the sender must select an agent domain that meets the requirement and/or if the receiver must ignore or reject the option when the agent domain does not satisfy the subordinate condition.",
      "severity": "Medium",
      "severity_basis": "Lack of clear enforcement could lead to unintended error-report traffic being sent to unrelated parties, undermining the intended security benefits.",
      "confidence": "High",
      "experts": [
        "Scope: Issue-3"
      ],
      "report_id": "9859-4-3"
    },
    {
      "label": "Undefined Error Handling and Fallback Behavior in DSYNC Endpoint Discovery",
      "bug_type": "Underspecification",
      "explanation": "The DSYNC endpoint discovery procedure does not define how to handle lookup errors (e.g., SERVFAIL, REFUSED, or timeouts) or how to proceed when a DSYNC RRset is returned that contains only unusable (no-op) records, leading to potential inconsistencies in fallback behavior.",
      "justification": [
        "Boundary Expert Finding-2 points out that the current text only distinguishes between a 'positive DSYNC answer' and a 'negative response', leaving ambiguous cases such as SERVFAIL or other non-standard error responses unaddressed.",
        "Boundary Expert Finding-3 highlights that if a DSYNC RRset exists but all records are no-op (e.g., Scheme=0 or Port=0), the procedure does not specify whether this should be treated as a positive answer or trigger fallback."
      ],
      "evidence": {
        "snippets": [
          {
            "id": "E1",
            "text": "Boundary Expert Finding-2: “Perform a lookup of type DSYNC … If this results in a positive DSYNC answer, return it.” (Section 4.1, step 2) and “If the query resulted in a negative response: … Otherwise, return null (no notification target available).” (Section 4.1, step 3)"
          },
          {
            "id": "E2",
            "text": "Boundary Expert Finding-3: “No behavior defined when DSYNC RRset exists but all RRs are unusable. Records with value 0 (null scheme) are ignored by consumers.” (Sections 2.1 and 4.1)"
          }
        ],
        "summary": [
          "(E1) shows that the discovery algorithm only defines paths for clearly positive or negative responses, omitting error conditions such as SERVFAIL or non-standard responses.",
          "(E2) indicates the absence of guidance for handling DSYNC RRsets that contain only no-op records."
        ]
      },
      "fix_direction": "Define normative fallback procedures for DSYNC lookup errors and specify that, if a DSYNC RRset is returned but contains only unusable records (e.g., all with Scheme=0 or Port=0), it should be treated as equivalent to a negative response to trigger fallback.",
      "severity": "Medium",
      "severity_basis": "Ambiguous error handling may result in different implementations choosing incompatible fallback behaviors, potentially affecting notification reliability and security.",
      "confidence": "High",
      "experts": [
        "Boundary: Finding-2",
        "Boundary: Finding-3"
      ],
      "report_id": "9859-4-4"
    }
  ]
}