================================================================================
SYSTEM PROMPT
================================================================================

You are ErrataPacketizer.
Input: an analyzer output containing router analysis and multiple expert analyses.
Task: produce deduplicated errata reports as structured JSON.

Constraints:
- Read the ENTIRE analysis carefully from start to finish. Do not skip any sections.
- Extract ALL issues mentioned anywhere in the analysis, including:
  * candidate issues (even if marked as "candidate" or "potential")
  * Expert-identified issues (even if experts conclude "no issue" or "editorial only")
  * Issues discussed in expert reasoning sections, even if not in formal issue lists
  * Any inconsistencies, ambiguities, or problems mentioned in any part of the text
  * Issues labeled as "potential", "candidate", "may cause", "underspecification", or similar
- Only use information present in the input text.
- Labels must be explicit and descriptive - clearly state what the problem is so readers understand it at a glance (include specific terms, values, or section references when relevant).
- Evidence snippets (5a) must be copied verbatim from the input text (without quotes). Snippets must be complete and sufficient - include all relevant context needed to understand and verify the issue. Do not use partial snippets.
- Evidence summary (5b) must be derived ONLY from the evidence snippets E1..En and must cite (E#) per bullet.
- Deduplicate: merge issues that refer to the same underlying erratum and list all experts.
- Severity/Confidence: prefer explicit expert values; otherwise infer conservatively and state "inferred".

================================================================================
USER PROMPT
================================================================================

Read the ENTIRE analyzer output below carefully from start to finish. Extract ALL issues, problems, inconsistencies, or ambiguities mentioned anywhere in the text.

Include ALL issues mentioned in the analysis:
- Router candidate issues (even if marked "candidate" or "potential")
- Expert-identified issues (check all expert sections: Scope, Causal, Quantitative, Structural, CrossRFC, Terminology, etc.)
- Issues discussed in expert reasoning/analysis sections, even if not in formal issue lists
- Any inconsistencies, ambiguities, underspecifications, or problems mentioned anywhere
- Issues labeled as "potential", "candidate", "may cause", "editorial", "underspecification", or similar
- Do NOT skip issues just because an expert concludes "no issue" or "editorial only" - if it's discussed, include it

Produce deduplicated errata reports as JSON.

Each errata report MUST contain exactly these fields:
1) label: Errata short Label (must be explicit and descriptive - readers should understand the problem at a glance, e.g., "Misnamed LDAP/X.509 CA certificate attribute ("caCertificate" vs "cACertificate")")
2) bug_type: Bug Type
3) explanation: Concise Explanation (1-2 sentences, neutral)
4) justification: Justification (array of bullets, must be supported by Evidence snippets)
5) evidence: Object with:
   - snippets: Array of {id: "E1", text: "..."} (verbatim, complete and sufficient excerpts, no quotes around text)
   - summary: Array of strings, each citing (E1), (E2), etc.
6) fix_direction: Fix Direction if exists, else null
7) severity: Low | Medium | High | Unspecified
8) severity_basis: Basis for severity
9) confidence: High | Medium | Low | Unspecified
10) experts: Array of "ExpertName: issue_id" strings

Constraints:
- Label must be explicit and descriptive - clearly state what the problem is so readers understand it at a glance (e.g., include specific terms, section references, or conflicting values when relevant).
- Evidence snippets must be verbatim from input (format: text directly, no quotes).
- Evidence snippets must be complete and sufficient - include all relevant context needed to understand the issue.
- Evidence summary must cite (E1), (E2), ... and contain no new facts beyond snippets.
- Keep each errata report concise.

Analyzer output:
<<<
================================================================================
COMPLETE ANALYSIS RESULT
================================================================================

RFC: Unknown
Section: Unknown
Model: gpt-5.1

================================================================================
ROUTER ANALYSIS
================================================================================
================================================================================
ROUTING SUMMARY
================================================================================

Excerpt Summary: Section 3 states that the new OSPFv2/OSPFv3 Prefix Extended Flags sub-TLV is backward compatible because implementations that do not recognize it will ignore it per the generic TLV processing rules in RFC 3630 (OSPFv2) and RFC 8362 (OSPFv3).
Overall Bug Likelihood: None

Dimensions:
  - Temporal: LOW - No sequencing, timers, or state transitions are involved in the backward-compatibility statement.
  - ActorDirectionality: LOW - The text talks generically about “an implementation” and does not define distinct roles or sender/receiver asymmetries.
  - Scope: LOW - The scope (unknown sub-TLVs in OSPFv2 TE LSAs and OSPFv3 Extended LSAs) is consistent with the referenced sections; no conflicting per-LSA or per-area rules are introduced.
  - Causal: LOW - The causal claim (“unknown sub-TLVs will be ignored”) directly matches the behavior mandated in RFC 3630 §2.3.2 and RFC 8362 §6.3; following the text does not appear to break anything.
  - Quantitative: LOW - No lengths, ranges, or numeric limits are discussed in Section 3 itself.
  - Deontic: LOW - Normative behavior is imported from the referenced RFCs; Section 3 is descriptive (“would ignore”) and does not introduce new or conflicting MUST/SHOULD requirements.
  - Structural: LOW - No new formats, diagrams, or grammars are defined in this section.
  - CrossRFC: LOW - References to RFC 3630 §2.3.2 and RFC 8362 §6.3 are correct in content (both specify that unknown TLVs/sub-TLVs are ignored), and the use is appropriate.
  - Terminology: LOW - Terms like “TLV”, “sub-TLV”, and “implementation” are used consistently with OSPF norms and the referenced documents.
  - Boundary: LOW - Edge cases (unknown sub-TLVs) are exactly what this section addresses, and the behavior aligns with the generic rules; no additional corner cases are left undefined.

Candidate Issues: 1

  Issue 1:
    Type: None
    Label: No apparent inconsistency or underspecification in the backward-compatibility text
    Relevant Dimensions: 
    Sketch: Section 3’s backward-compatibility claim aligns with the generic “ignore unknown TLVs/sub-TLVs” rule...

Response ID: resp_02542a0dc81f5e7b006954ba4f37f48197b07701fa35a40df1


Vector Stores Used: vs_6954b9df90a0819183e4729475a043a9
>>>

Return JSON array of errata reports:
{
  "reports": [
    {
      "label": "...",
      "bug_type": "...",
      "explanation": "...",
      "justification": ["...", "..."],
      "evidence": {
        "snippets": [
          {"id": "E1", "text": "..."}
        ],
        "summary": ["(E1) ...", "(E2) ..."]
      },
      "fix_direction": "..." or null,
      "severity": "...",
      "severity_basis": "...",
      "confidence": "...",
      "experts": ["..."]
    }
  ]
}