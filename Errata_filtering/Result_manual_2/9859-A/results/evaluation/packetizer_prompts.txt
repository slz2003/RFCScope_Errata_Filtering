================================================================================
SYSTEM PROMPT
================================================================================

You are ErrataPacketizer.
Input: an analyzer output containing router analysis and multiple expert analyses.
Task: produce deduplicated errata reports as structured JSON.

Constraints:
- Read the ENTIRE analysis carefully from start to finish. Do not skip any sections.
- Extract ALL issues mentioned anywhere in the analysis, including:
  * candidate issues (even if marked as "candidate" or "potential")
  * Expert-identified issues (even if experts conclude "no issue" or "editorial only")
  * Issues discussed in expert reasoning sections, even if not in formal issue lists
  * Any inconsistencies, ambiguities, or problems mentioned in any part of the text
  * Issues labeled as "potential", "candidate", "may cause", "underspecification", or similar
- Only use information present in the input text.
- Labels must be explicit and descriptive - clearly state what the problem is so readers understand it at a glance (include specific terms, values, or section references when relevant).
- Evidence snippets (5a) must be copied verbatim from the input text (without quotes). Snippets must be complete and sufficient - include all relevant context needed to understand and verify the issue. Do not use partial snippets.
- Evidence summary (5b) must be derived ONLY from the evidence snippets E1..En and must cite (E#) per bullet.
- Deduplicate: merge issues that refer to the same underlying erratum and list all experts.
- Severity/Confidence: prefer explicit expert values; otherwise infer conservatively and state "inferred".

================================================================================
USER PROMPT
================================================================================

Read the ENTIRE analyzer output below carefully from start to finish. Extract ALL issues, problems, inconsistencies, or ambiguities mentioned anywhere in the text.

Include ALL issues mentioned in the analysis:
- Router candidate issues (even if marked "candidate" or "potential")
- Expert-identified issues (check all expert sections: Scope, Causal, Quantitative, Structural, CrossRFC, Terminology, etc.)
- Issues discussed in expert reasoning/analysis sections, even if not in formal issue lists
- Any inconsistencies, ambiguities, underspecifications, or problems mentioned anywhere
- Issues labeled as "potential", "candidate", "may cause", "editorial", "underspecification", or similar
- Do NOT skip issues just because an expert concludes "no issue" or "editorial only" - if it's discussed, include it

Produce deduplicated errata reports as JSON.

Each errata report MUST contain exactly these fields:
1) label: Errata short Label (must be explicit and descriptive - readers should understand the problem at a glance, e.g., "Misnamed LDAP/X.509 CA certificate attribute ("caCertificate" vs "cACertificate")")
2) bug_type: Bug Type
3) explanation: Concise Explanation (1-2 sentences, neutral)
4) justification: Justification (array of bullets, must be supported by Evidence snippets)
5) evidence: Object with:
   - snippets: Array of {id: "E1", text: "..."} (verbatim, complete and sufficient excerpts, no quotes around text)
   - summary: Array of strings, each citing (E1), (E2), etc.
6) fix_direction: Fix Direction if exists, else null
7) severity: Low | Medium | High | Unspecified
8) severity_basis: Basis for severity
9) confidence: High | Medium | Low | Unspecified
10) experts: Array of "ExpertName: issue_id" strings

Constraints:
- Label must be explicit and descriptive - clearly state what the problem is so readers understand it at a glance (e.g., include specific terms, section references, or conflicting values when relevant).
- Evidence snippets must be verbatim from input (format: text directly, no quotes).
- Evidence snippets must be complete and sufficient - include all relevant context needed to understand the issue.
- Evidence summary must cite (E1), (E2), ... and contain no new facts beyond snippets.
- Keep each errata report concise.

Analyzer output:
<<<
================================================================================
COMPLETE ANALYSIS RESULT
================================================================================

RFC: Unknown
Section: Unknown
Model: gpt-5.1

================================================================================
ROUTER ANALYSIS
================================================================================
================================================================================
ROUTING SUMMARY
================================================================================

Excerpt Summary: Appendix A of RFC 9859 explains the motivation and efficiency problems around polling-based CDS/CDNSKEY and CSYNC scanning and relates them back to the original NOTIFY mechanism, while the rest of the excerpt defines the DSYNC RR, discovery, generalized NOTIFY use for delegation maintenance, and related registries and security considerations.
Overall Bug Likelihood: None

Dimensions:
  - Temporal: LOW - Explanatory timing/scanning and signature-validity discussions are present but match the referenced RFCs and do not introduce new normative timing logic that appears contradictory.
  - ActorDirectionality: LOW - Roles of parent/child, registry/registrar, resolvers, and authoritative servers are used consistently and align with the referenced RFCs.
  - Scope: LOW - The scope of DSYNC (delegation maintenance, endpoint discovery), generalized NOTIFY, and the applicability of error-report reporting is clearly delimited and coherent.
  - Causal: LOW - The causal chains (notifications merely accelerate existing checks, scanning vs NOTIFY, rate limiting to bound work) are straightforward and internally consistent.
  - Quantitative: LOW - Field sizes, ranges, and registry code ranges (DSYNC type 66, 8â€‘bit schemes, port field, EDE codes, etc.) agree with their descriptions and with referenced registries.
  - Deontic: LOW - Normative language (MUST/SHOULD/MAY) within RFC 9859 and as it relies on other RFCs does not show internal contradiction; requirements for DSYNC publication, endpoint discovery, rate limiting, and EDNS0 Report-Channel usage are coherent.
  - Structural: LOW - The DSYNC RDATA layout, IANA registry tables, and use of EDNS0 options are consistent with DNS wire-format conventions and with the referenced EDNS0-based RFCs.
  - CrossRFC: LOW - References to RFC 1996, 7344, 7477, 7583, 6781, 8078, 8901, 9567, 8914, and DNSSEC/terminology RFCs match their described behavior and do not appear to misquote or contradict them in a way that changes protocol behavior.
  - Terminology: LOW - Terms like NOTIFY(CDS), NOTIFY(CSYNC), parental agent, reporting resolver, monitoring agent, DSYNC schemes, etc., are used consistently, and old/new names across RFCs line up.
  - Boundary: LOW - Edge cases (no DSYNC records, unsigned DSYNC, multiple zones/providers, rate limiting, failure modes in CSYNC/CDS processing) are at least qualitatively addressed; no obvious unhandled but critical corner case stands out in the excerpt.

Candidate Issues: 1

  Issue 1:
    Type: None
    Label: 
    Relevant Dimensions: 
    Sketch: ...

Response ID: resp_07f55c1a07200d3b006954b89715f48196881b468c6302855c


Vector Stores Used: vs_6954b56ccec08191857d5b98195079cb
>>>

Return JSON array of errata reports:
{
  "reports": [
    {
      "label": "...",
      "bug_type": "...",
      "explanation": "...",
      "justification": ["...", "..."],
      "evidence": {
        "snippets": [
          {"id": "E1", "text": "..."}
        ],
        "summary": ["(E1) ...", "(E2) ..."]
      },
      "fix_direction": "..." or null,
      "severity": "...",
      "severity_basis": "...",
      "confidence": "...",
      "experts": ["..."]
    }
  ]
}