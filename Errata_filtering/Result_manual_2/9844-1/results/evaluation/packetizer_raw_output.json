{
  "reports": [
    {
      "label": "Overstating RFC 3493 Support for %zone_id in getaddrinfo()",
      "bug_type": "Inconsistency",
      "explanation": "RFC 9844 incorrectly asserts that socket API calls such as getaddrinfo() directly support IPv6 addresses with zone identifiers (e.g. fe80::1%eth0) based on RFC 3493, even though RFC 3493 only mandates support for standard IPv6 text forms without a zone suffix.",
      "justification": [
        "RFC 9844 Section 1 asserts that examples like fe80::1234%eth0 are directly supported by getaddrinfo() [RFC3493] (E1).",
        "RFC 3493 Section 6.1 specifies that valid addresses for getaddrinfo() are limited to standard IPv6 text forms as defined by inet_pton(), with no mention of a '%zone_id' suffix (E2).",
        "RFC 4007 Section 11.2 introduces the <address>%<zone_id> notation after RFC 3493 was published, indicating that such support is an implementation-specific extension, not a normative requirement (E3)."
      ],
      "evidence": {
        "snippets": [
          {
            "id": "E1",
            "text": "RFC 9844 Section 1: “Examples of a link-local unicast address qualified by a zone identifier are `fe80::1234%eth0` … Such addresses are directly supported by socket API calls including `getaddrinfo()` [RFC3493].”"
          },
          {
            "id": "E2",
            "text": "RFC 3493 Section 6.1: For `getaddrinfo()`, “If the specified address family is AF_INET6 or AF_UNSPEC, standard IPv6 text forms described in `inet_pton()` are valid.” The description does not mention zone identifiers or a `%` suffix."
          },
          {
            "id": "E3",
            "text": "RFC 4007 (Section 11.2) is where the `<address>%<zone_id>` textual form is introduced; RFC 4007 post-dates RFC 3493."
          }
        ],
        "summary": [
          "(E1) RFC 9844 explicitly claims direct support for zone-qualified addresses in getaddrinfo().",
          "(E2) RFC 3493 limits valid IPv6 address strings to those accepted by inet_pton(), excluding any '%zone_id' suffix.",
          "(E3) RFC 4007 later introduces the '%zone_id' syntax, reinforcing that its support in getaddrinfo() is not mandated by RFC 3493."
        ]
      },
      "fix_direction": "Rephrase the language in RFC 9844 to clarify that direct support for '%zone_id' in getaddrinfo() is an implementation-specific extension rather than a normative requirement of RFC 3493, and advise using a two-step parsing approach if necessary.",
      "severity": "Medium",
      "severity_basis": "The misleading claim may lead developers to assume universal support for zone-qualified addresses in getaddrinfo(), which can result in portability issues and unexpected API behavior on RFC3493‐conformant systems.",
      "confidence": "High",
      "experts": [
        "Scope Expert: Issue-1",
        "Causal Expert: Issue-1",
        "CrossRFC Expert: Issue-1"
      ],
      "report_id": "9844-1-1"
    }
  ]
}