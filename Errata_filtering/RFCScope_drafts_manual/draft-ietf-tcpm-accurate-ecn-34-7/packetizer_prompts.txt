================================================================================
SYSTEM PROMPT
================================================================================

You are ErrataPacketizer.
Input: an analyzer output containing router analysis and multiple expert analyses.
Task: produce deduplicated errata reports as structured JSON.

Constraints:
- Read the ENTIRE analysis carefully from start to finish. Do not skip any sections.
- Extract ALL issues mentioned anywhere in the analysis, including:
  * candidate issues (even if marked as "candidate" or "potential")
  * Expert-identified issues (even if experts conclude "no issue" or "editorial only")
  * Issues discussed in expert reasoning sections, even if not in formal issue lists
  * Any inconsistencies, ambiguities, or problems mentioned in any part of the text
  * Issues labeled as "potential", "candidate", "may cause", "underspecification", or similar
- Only use information present in the input text.
- Labels must be explicit and descriptive - clearly state what the problem is so readers understand it at a glance (include specific terms, values, or section references when relevant).
- Evidence snippets (5a) must be copied verbatim from the input text (without quotes). Snippets must be complete and sufficient - include all relevant context needed to understand and verify the issue. Do not use partial snippets.
- Evidence summary (5b) must be derived ONLY from the evidence snippets E1..En and must cite (E#) per bullet.
- Deduplicate: merge issues that refer to the same underlying erratum and list all experts.
- Severity/Confidence: prefer explicit expert values; otherwise infer conservatively and state "inferred".

================================================================================
USER PROMPT
================================================================================

Read the ENTIRE analyzer output below carefully from start to finish. Extract ALL issues, problems, inconsistencies, or ambiguities mentioned anywhere in the text.

Include ALL issues mentioned in the analysis:
- Router candidate issues (even if marked "candidate" or "potential")
- Expert-identified issues (check all expert sections: Scope, Causal, Quantitative, Structural, CrossRFC, Terminology, etc.)
- Issues discussed in expert reasoning/analysis sections, even if not in formal issue lists
- Any inconsistencies, ambiguities, underspecifications, or problems mentioned anywhere
- Issues labeled as "potential", "candidate", "may cause", "editorial", "underspecification", or similar
- Do NOT skip issues just because an expert concludes "no issue" or "editorial only" - if it's discussed, include it

Produce deduplicated errata reports as JSON.

Each errata report MUST contain exactly these fields:
1) label: Errata short Label (must be explicit and descriptive - readers should understand the problem at a glance, e.g., "Misnamed LDAP/X.509 CA certificate attribute ("caCertificate" vs "cACertificate")")
2) bug_type: Bug Type
3) explanation: Concise Explanation (1-2 sentences, neutral)
4) justification: Justification (array of bullets, must be supported by Evidence snippets)
5) evidence: Object with:
   - snippets: Array of {id: "E1", text: "..."} (verbatim, complete and sufficient excerpts, no quotes around text)
   - summary: Array of strings, each citing (E1), (E2), etc.
6) fix_direction: Fix Direction if exists, else null
7) severity: Low | Medium | High | Unspecified
8) severity_basis: Basis for severity
9) confidence: High | Medium | Low | Unspecified
10) experts: Array of "ExpertName: issue_id" strings

Constraints:
- Label must be explicit and descriptive - clearly state what the problem is so readers understand it at a glance (e.g., include specific terms, section references, or conflicting values when relevant).
- Evidence snippets must be verbatim from input (format: text directly, no quotes).
- Evidence snippets must be complete and sufficient - include all relevant context needed to understand the issue.
- Evidence summary must cite (E1), (E2), ... and contain no new facts beyond snippets.
- Keep each errata report concise.

Analyzer output:
<<<
REASONING EXPERT ANALYSES
================================================================================

## Structural Expert
--------------------------------------------------------------------------------

### Expert Analysis:
--------------------------------------------------------------------------------
AnalysisSummary:
- ExcerptSummary: I inspected Section 7 (IANA Considerations) and its supporting text for the TCP header flag reassignment (bit 7) and the new TCP option kinds 172 and 174, checking them against the internal definitions and the referenced RFC 3540 / RFC 8311 / RFC 6994 material.
- OverallBugLikelihood: None

Issues:
  - Issue-1:
    - BugType: None
    - ShortLabel: "No structural or syntactic issues detected in IANA actions"
    - TechnicalExplanation: |
        The IANA Considerations section cleanly matches the technical definitions elsewhere in the draft: bit 7 is consistently used as AE (Accurate ECN), aligning with the diagrams and negotiation rules, and the text correctly notes its prior use as NS by RFC 3540 and its historic status per RFC 8311. The two AccECN option kinds (172 and 174) are used consistently throughout (figures, normative text, and IANA table), and their variable-length nature (with specific allowed lengths defined earlier) is compatible with using “N” in the registry. The instructions to IANA about updating registry references and notes are procedural/administrative rather than wire-format- or grammar‑affecting. They do not introduce ambiguity about bit positions, field sizes, option formats, or encodings, and therefore do not constitute structural or syntactic bugs from an implementability standpoint.

[Used vector stores: vs_6958be564fdc81918f6c87dec1d36632]

## CrossRFC Expert
--------------------------------------------------------------------------------

### Expert Analysis:
--------------------------------------------------------------------------------
CrossRFCReport:
- ExcerptSummary: Section 7 reassigns TCP header flag bit 7 from the historic ECN Nonce Sum (NS) to the new AE (Accurate ECN) flag and allocates two TCP option kinds (172, 174) for AccECN options, while updating references to earlier experimental ExIDs as defined under RFC 6994. The text directly interacts with the existing IANA “TCP Header Flags”, “TCP Option Kind Numbers”, and “TCP ExIDs” registries, and with the prior changes made by RFC 3540 and RFC 8311.
- OverallCrossRFCLikelihood: Low
- Issues: []
- IfNoIssues:
  - Comment: The IANA Considerations text is broadly consistent with the prior RFCs and registries it touches. RFC 3540 originally assigned bit 7 as NS, and RFC 8311 reclassified RFC 3540 as Historic and caused IANA to mark bit 7 as Reserved with an annotation that it had been used as NS  . The new draft correctly notes that history and reuses bit 7 for AE, which is exactly what one expects to do with a previously reserved flag; RFC 8311 does not impose a permanent prohibition on future use of bit 7, it only documents that, at the time, it was Reserved and no longer NS. Asking IANA to change the bit‑7 row from “Reserved” to “AE (Accurate ECN)” with an assignment note “Previously used as NS (Nonce Sum) by [RFC3540], which is now historic [RFC8311]” is aligned with both the prior status and current IANA practice; the reference column naturally moves to the RFC that defines the current semantics, while the note still points back to RFC 3540/RFC 8311 for history. Similarly, the handling of experimental options via ExIDs (0xACC0, 0xACC1, 0xACCE) is consistent with RFC 6994’s model (use 253/254 with ExIDs, register them, then migrate to assigned kinds later)  . The text merely updates the *references* for those ExIDs to point at the final AccECN RFC and encourages migration; it does not redefine or conflict with the TCP ExIDs registry. Finally, while one could argue that this document “logically” updates RFC 8311 (since it changes the status of bit 7 from Reserved to AE), RFC 8311’s only normative action on that bit is via IANA, and there is no ongoing behavioral requirement that would be contradicted; omitting “Updates: 8311” is at most an editorial matter and does not create implementer-visible ambiguity or registry inconsistency.

[Used vector stores: vs_6958be564fdc81918f6c87dec1d36632]


Vector Stores Used: vs_6958be564fdc81918f6c87dec1d36632
>>>

Return JSON array of errata reports:
{
  "reports": [
    {
      "label": "...",
      "bug_type": "...",
      "explanation": "...",
      "justification": ["...", "..."],
      "evidence": {
        "snippets": [
          {"id": "E1", "text": "..."}
        ],
        "summary": ["(E1) ...", "(E2) ..."]
      },
      "fix_direction": "..." or null,
      "severity": "...",
      "severity_basis": "...",
      "confidence": "...",
      "experts": ["..."]
    }
  ]
}