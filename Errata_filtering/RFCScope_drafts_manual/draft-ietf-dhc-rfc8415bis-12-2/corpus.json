[
  {
    "rfc_number": "draft-ietf-dhc-rfc8415bis-12",
    "rfc_title": "Obsoletes: 8415 (if approved)                                    B. Volz",
    "content": "1. Introduction\n\n   This document specifies DHCP for IPv6 (DHCPv6), a client/server\n   protocol that provides managed configuration of devices.  The basic\n   operation of DHCPv6 provides configuration for clients connected to\n   the same link as the server.  Relay agent functionality is also\n   defined for enabling communication between clients and servers that\n   are not on the same link.\n\n   DHCPv6 can provide a device with addresses assigned by a DHCPv6\n   server and other configuration information; this data is carried in\n   options.  DHCPv6 can be extended through the definition of new\n   options to carry configuration information not specified in this\n   document.\n\n   DHCPv6 also supports a mechanism for automated delegation of IPv6\n   prefixes.  Through this mechanism, a server can delegate prefixes to\n   clients.  Use of this mechanism is specified as part of [RFC7084] and\n   by [TR-187].  Note that these documents use \"requesting router\" for\n   what this document uses client and \"delegating router\" for server.\n\n   DHCP can also be used just to provide other configuration options\n   (i.e., no addresses or prefixes).  That implies that the server does\n   not have to track any state; thus, this mode is called \"stateless\n   DHCPv6\".  Mechanisms necessary to support stateless DHCPv6 are much\n   simpler than mechanisms needed to support stateful DHCPv6.\n\n1.1. Relationship to Previous DHCPv6 Standards\n\n   [RFC8415] provided a unified, corrected, and cleaned-up definition of\n   DHCPv6 that also covered all applicable errata filed against older\n   RFCs.  It also obsoleted a small number of mechanisms: delayed\n   authentication, lifetime and timer hints sent by a client.\n\n   This document obsoletes [RFC8415] by applying all applicable errata\n   and obsoleting two features that have not been widely implemented -\n   the assignment of temporary addresses using the IA_TA option and\n   allowing clients to unicast some messages directly to the server if\n   the server sent the Server Unicast option to a client in an early\n   exchange.  It also clarifies the UDP ports used by clients, servers,\n   and relay agents (Section 7.2).  See Appendix A  for a list of\n   differences from [RFC8415]. \n\n\n\n\n\n\n1.2. Topics Out of Scope\n\n   This document specifies the DHCPv6 protocol behavior.  The server\n   policy, such as what options to assign to which clients, which\n   subnets or pools of resources to use, which clients' requests should\n   be denied etc. are out of scope for this document.\n\n   Server configuration, operation and management are also out of scope.\n   An approach to manage DHCPv6 relays and servers is specified in\n   [RFC9243].\n\n   Merging DHCPv4 [RFC2131] and DHCPv6 configuration is out of scope for\n   this document.  [RFC4477] discusses some issues and possible\n   strategies for running DHCPv4 and DHCPv6 services together.  While\n   [RFC4477] is a bit dated, it provides a good overview of the issues\n   at hand.  The current consensus of the IETF is that DHCPv4 should be\n   used rather than DHCPv6 when conveying IPv4 configuration information\n   to nodes.  For IPv6-only networks, [RFC7341] describes a transport\n   mechanism to carry DHCPv4 messages using the DHCPv6 protocol for the\n   dynamic provisioning of IPv4 address and configuration information.\n\n\n2. Requirements\n\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"NOT RECOMMENDED\", \"MAY\", and\n   \"OPTIONAL\" in this document are to be interpreted as described in BCP 14 [RFC2119] [RFC8174] when, and only when, they appear in all\n   capitals, as shown here.\n\n   This document also makes use of internal conceptual variables to\n   describe protocol behavior and external variables that an\n   implementation must allow system administrators to change.  The\n   specific variable names, how their values change, and how their\n   settings influence protocol behavior are provided to demonstrate\n   protocol behavior.  An implementation is not required to have them in\n   the exact form described here, as long as its external behavior is\n   consistent with that described in this document.\n\n3. Background\n\n   This section, which contained background on IPv6 specifications of\n   relevance to DHCPv6, has been removed; those interested should refer\n   to [RFC8415].  However, this section is retained to keep the major\n   section numbering consistent with [RFC8415]. \n\n\n\n\n\n4. Terminology\n\n   This section defines terminology specific to IPv6 and DHCP used in\n   this document.\n\n4.1. IPv6 Terminology\n\n   IPv6 terminology from [RFC8200], [RFC4291], and [RFC4862] relevant to\n   this specification is included below.\n\n   address                   An IP-layer identifier for an interface or\n                             a set of interfaces.\n\n   GUA                       Global unicast address (see [RFC4291]).\n\n   host                      Any node that is not a router.\n\n   IP                        Internet Protocol Version 6 (IPv6).  The\n                             terms \"IPv4\" and \"IPv6\" are used only in\n                             contexts where it is necessary to avoid\n                             ambiguity.\n\n   interface                 A node's attachment to a link.\n\n   link                      A communication facility or medium over\n                             which nodes can communicate at the link\n                             layer, i.e., the layer immediately below\n                             IP.  Examples are Ethernet (simple or\n                             bridged); Point-to-Point Protocol (PPP) and\n                             PPP over Ethernet (PPPoE) links; and\n                             Internet-layer (or higher) \"tunnels\", such\n                             as tunnels over IPv4 or IPv6 itself.\n\n   link-layer identifier     A link-layer identifier for an interface --\n                             for example, IEEE 802 addresses for\n                             Ethernet or Token Ring network interfaces.\n\n   link-local address        An IPv6 address having a link-only scope,\n                             indicated by having the prefix (fe80::/10),\n                             that can be used to reach neighboring nodes\n                             attached to the same link.  Every IPv6\n                             interface on which DHCPv6 can reasonably be\n                             useful has a link-local address.\n\n   multicast address         An identifier for a set of interfaces \n                             (typically belonging to different nodes).\n                             A packet sent to a multicast address is\n                             delivered to all interfaces identified by\n                             that address.\n\n   neighbor                  A node attached to the same link.\n\n   node                      A device that implements IP.\n\n   packet                    An IP header plus payload.\n\n   prefix                    The initial bits of an address, or a set\n                             of IP addresses that share the same\n                             initial bits.\n\n   prefix length             The number of bits in a prefix.\n\n   router                    A node that forwards IP packets not\n                             explicitly addressed to itself.\n\n   ULA                       Unique local address (see [RFC4193]).\n\n   unicast address           An identifier for a single interface.  A\n                             packet sent to a unicast address is\n                             delivered to the interface identified by\n                             that address.\n\n\n4.2. DHCP Terminology\n\n   Terminology specific to DHCP can be found below.\n\n   appropriate to the link   An address is \"appropriate to the link\"\n                             when the address is consistent with the\n                             DHCP server's knowledge of the network\n                             topology, prefix assignment, and address\n                             assignment policies.\n\n   binding                   A binding (or client binding) is a group of\n                             server data records containing the\n                             information the server has about the\n                             addresses or delegated prefixes in an\n                             Identity Association (IA) or configuration\n                             information explicitly assigned to the\n                             client.  Configuration information that has\n                             been returned to a client through a policy,\n                             such as the information returned to all\n                             clients on the same link, does not require\n                             a binding.  A binding containing \n                             information about an IA is indexed by the\n                             tuple <DUID, IA-type, IAID> (where IA-type\n                             is the type of lease in the IA -- for\n                             example, address or delegated prefix).  A\n                             binding containing configuration\n                             information for a client is indexed by\n                             <DUID>.  See below for definitions of DUID,\n                             IA, and IAID.\n\n   configuration parameter   An element of the configuration information\n                             set on the server and delivered to the\n                             client using DHCP.  Such parameters may be\n                             used to carry information to be used by a\n                             node to configure its network subsystem and\n                             enable communication on a link or\n                             internetwork, for example.\n\n   container option          An option that encapsulates other options\n                             (for example, the IA_NA option (see Section 21.4) may contain IA Address\n                             options (see Section 21.6)).\n\n   DHCP                      Dynamic Host Configuration Protocol for\n                             IPv6.  The terms \"DHCPv4\" and \"DHCPv6\" are\n                             used only in contexts where it is necessary\n                             to avoid ambiguity.\n\n   DHCP client               Also referred to as \"client\".  A node that\n                             initiates requests on a link to obtain\n                             configuration parameters from one or more\n                             DHCP servers.\n\n   DHCP domain               A set of links managed by DHCP and operated\n                             by a single administrative entity.\n\n   DHCP relay agent          Also referred to as \"relay agent\".  A node\n                             that acts as an intermediary to deliver\n                             DHCP messages between clients and servers.\n                             In certain configurations, there may be\n                             more than one relay agent between clients\n                             and servers, so a relay agent may send DHCP\n                             messages to another relay agent.\n\n   DHCP server               This document condenses this term to\n                             \"server\".  A node that responds to requests\n                             from clients.  It may or may not be on the\n                             same link as the client(s). \n   DUID                      A DHCP Unique Identifier for a DHCP\n                             participant.  Each DHCP client and server\n                             has exactly one DUID.  See Section 11 for\n                             details of the ways in which a DUID may be\n                             constructed.\n\n   encapsulated option       A DHCP option that is usually only\n                             contained in another option.  For example,\n                             the IA Address option is contained in IA_NA\n                             options (see Section 21.5).  See Section 9\n                             of [RFC7227] for a more complete\n                             definition.\n\n   IA                        Identity Association: a collection of\n                             leases assigned to a client.  Each IA has\n                             an associated IAID (see below).  A client\n                             may have more than one IA assigned to it --\n                             for example, one for each of its\n                             interfaces.  Each IA holds one type of\n                             lease; for example, an identity association\n                             for non-temporary addresses (IA_NA) holds\n                             addresses, and an identity association for\n                             prefix delegation (IA_PD) holds delegated\n                             prefixes.  Throughout this document, \"IA\"\n                             is used to refer to an identity association\n                             without identifying the type of a lease in\n                             the IA.  This document defines three IA\n                             types: IA_NA, IA_TA (obsoleted), and IA_PD.\n                             Another IA type (IA_LL) was defined in\n                             [RFC8947] and more may be defined.\n\n   IA option(s)              In this document, one or more IA_NA, IA_TA\n                             (obsoleted), and/or IA_PD.  Another IA type\n                             (IA_LL) was defined in [RFC8947] and more\n                             may be defined.\n\n   IAID                      Identity Association Identifier: an\n                             identifier for an IA, chosen by the client.\n                             Each IA has an IAID, which is chosen to be\n                             unique among IAIDs for IAs of a specific\n                             type that belong to that client.\n\n   IA_NA                     Identity Association for Non-temporary\n                             Addresses: an IA that carries assigned\n                             addresses.  See Section 21.4 for details on\n                             the IA_NA option.\n\n   IA_PD                     Identity Association for Prefix Delegation:\n                             an IA that carries delegated prefixes.  See Section 21.21 for details on the IA_PD\n                             option.\n\n   IA_TA                     Identity Association for Temporary\n                             Addresses: an IA that carries temporary\n                             addresses (see [RFC8981]).  This option is\n                             obsoleted by this document.  See [RFC8415]\n                             for details.\n\n   lease                     A contract by which the server grants the\n                             use of an address or delegated prefix to\n                             the client for a specified period of time.\n\n   message                   A unit of data carried as the payload of a\n                             UDP datagram, exchanged among DHCP servers,\n                             relay agents, and clients.\n\n   Reconfigure key           A key supplied to a client by a server.\n                             Used to provide security for Reconfigure\n                             messages (see Section 7.3 for the list of\n                             available message types).\n\n   relaying                  A DHCP relay agent relays DHCP messages\n                             between DHCP participants.\n\n   retransmission            Another attempt to send the same DHCP\n                             message by a client or server, as a result\n                             of not receiving a valid response to the\n                             previously sent messages.  The\n                             retransmitted message is typically modified\n                             prior to sending, as required by the DHCP\n                             specifications.  In particular, the client\n                             updates the value of the Elapsed Time\n                             option in the retransmitted message.\n\n   RKAP                      The Reconfiguration Key Authentication\n                             Protocol (see Section 20.4).\n\n   singleton option          An option that is allowed to appear only\n                             once as a top-level option or at any\n                             encapsulation level.  Most options are\n                             singletons.\n\n   T1                        The time interval after which the client is\n                             expected to contact the server that did the\n                             assignment to extend (renew) the lifetimes\n                             of the addresses assigned (via IA_NA \n                             option(s)) and/or prefixes delegated (via\n                             IA_PD option(s)) to the client.  T1 is\n                             expressed as an absolute value in messages\n                             (in seconds), is conveyed within IA\n                             containers (currently the IA_NA and IA_PD\n                             options), and is interpreted as a time\n                             interval since the message's reception.\n                             The value stored in the T1 field in IA\n                             options is referred to as the T1 value.\n                             The actual time when the timer expires is\n                             referred to as the T1 time.\n\n   T2                        The time interval after which the client is\n                             expected to contact any available server to\n                             extend (rebind) the lifetimes of the\n                             addresses assigned (via IA_NA option(s))\n                             and/or prefixes delegated (via IA_PD\n                             option(s)) to the client.  T2 is expressed\n                             as an absolute value in messages (in\n                             seconds), is conveyed within IA containers\n                             (currently the IA_NA and IA_PD options),\n                             and is interpreted as a time interval since\n                             the message's reception.  The value stored\n                             in the T2 field in IA options is referred\n                             to as the T2 value.  The actual time when\n                             the timer expires is referred to as the\n                             T2 time.\n\n   top-level option          An option conveyed in a DHCP message\n                             directly, i.e., not encapsulated in any\n                             other option, as described in Section 9 of\n                             [RFC7227].\n\n   transaction ID            An opaque value used to match responses\n                             with replies initiated by either a client\n                             or a server.\n\n\n5. Client/Server Exchanges\n\n   Clients and servers exchange DHCP messages using UDP (see [RFC0768]\n   and [BCP145]).  The client uses a link-local source address or\n   addresses determined through other mechanisms for transmitting and\n   receiving DHCP messages.\n\n   A DHCP client sends all messages using a reserved, link-scoped\n   multicast destination address (All_DHCP_Relay_Agents_and_Servers -\n   ff02::1:2) so that the client need not be configured with the address\n   or addresses of DHCP servers. \n   To allow a DHCP client to send a message to a DHCP server that is not\n   attached to the same link, a DHCP relay agent on the client's link\n   will relay messages between the client and server.  The operation of\n   the relay agent is transparent to the client.  The discussion of\n   message exchanges in the remainder of this section will omit the\n   description of the relaying of messages by relay agents.\n\n5.1. Client/Server Exchanges Involving Two Messages\n\n   When a DHCP client does not need to have a DHCP server assign IP\n   addresses or delegated prefixes to it, the client can obtain other\n   configuration information such as a list of available DNS servers\n   [RFC3646] or NTP servers [RFC5908] through a single message and reply\n   exchange with a DHCP server.  To obtain other configuration\n   information, the client first sends an Information-request message to\n   the All_DHCP_Relay_Agents_and_Servers multicast address.  Servers\n   respond with a Reply message containing the other configuration\n   information for the client.\n\n   A client may also request the server to expedite address assignment\n   and/or prefix delegation by using a two-message exchange instead of\n   the normal four-message exchange as discussed in the next section.\n   Expedited assignment can be requested by the client, and servers may\n   or may not honor the request (see Sections 18.3.1 and 21.14 for more\n   details and why servers may not honor this request).  Clients may\n   request this expedited service in environments where it is likely\n   that there is only one server available on a link and no expectation\n   that a second server would become available, or when completing the\n   configuration process as quickly as possible is a priority.\n\n   To request the expedited two-message exchange, the client sends a\n   Solicit message to the All_DHCP_Relay_Agents_and_Servers multicast\n   address requesting the assignment of addresses and/or delegated\n   prefixes and other configuration information.  This message includes\n   an indication (the Rapid Commit option; see Section 21.14) that the\n   client is willing to accept an immediate Reply message from the\n   server.  The server that is willing to commit the assignment of\n   addresses and/or delegated prefixes to the client immediately\n   responds with a Reply message.  The configuration information and the\n   addresses and/or delegated prefixes in the Reply message are then\n   immediately available for use by the client.\n\n   Each address or delegated prefix assigned to the client has\n   associated preferred and valid lifetimes specified by the server.  To\n   request an extension of the lifetimes assigned to an address or\n   delegated prefix, the client sends a Renew message to the server.\n   The server sends a Reply message to the client with the new\n   lifetimes, allowing the client to continue to use the address or \n   delegated prefix without interruption.  If the server is unable to\n   extend the lifetime of an address or delegated prefix, it indicates\n   this by returning the address or delegated prefix with lifetimes of\n   0.  At the same time, the server may assign other addresses or\n   delegated prefixes.\n\n   See Section 18 for descriptions of additional two-message exchanges\n   between the client and server.\n\n\n5.2. Client/Server Exchanges Involving Four Messages\n\n   To request the assignment of one or more addresses and/or delegated\n   prefixes, a client first locates a DHCP server and then requests the\n   assignment of addresses and/or delegated prefixes and other\n   configuration information from the server.  The client sends a\n   Solicit message to the All_DHCP_Relay_Agents_and_Servers multicast\n   address to find available DHCP servers.  Any server that can meet the\n   client's requirements responds with an Advertise message.  The client\n   then chooses one of the servers and sends a Request message to the\n   server asking for confirmed assignment of addresses and/or delegated\n   prefixes and other configuration information.  The server responds\n   with a Reply message that contains the confirmed addresses, delegated\n   prefixes, and configuration.\n\n   As described in the previous section, the client can request an\n   extension of the lifetimes assigned to addresses or delegated\n   prefixes (this is a two-message exchange).\n\n\n5.3. Server/Client Exchanges\n\n   A server that has previously communicated with a client and\n   negotiated for the client to listen for Reconfigure messages may send\n   the client a Reconfigure message to initiate the client to update its\n   configuration by sending an Information-request, Renew, or Rebind\n   message.  Reconfigure messages are authenticated as per Section 20.4.\n   The client then performs the two-message exchange as described\n   earlier.  This can be used to expedite configuration changes to a\n   client, such as the need to renumber a network (see [RFC6879] and\n   [RFC9096]).\n\n\n6. Operational Models\n\n   This section describes some of the current most common DHCP\n   operational models.  The described models are not mutually exclusive\n   and are sometimes used together.  For example, a device may start in\n   stateful mode to obtain an address and, at a later time when an\n   application is started, request additional parameters using stateless\n   mode. \n   This document assumes that the DHCP servers and the client,\n   communicating with the servers via a specific interface, belong to a\n   single provisioning domain.\n\n   DHCP may be extended to support additional stateful services that may\n   interact with one or more of the models described below.  Such\n   interaction should be considered and documented as part of any future\n   protocol extension.\n\n6.1. Stateless DHCP\n\n   Stateless DHCP can be used at any time, typically when a node\n   requires some missing or expired configuration information that is\n   available via DHCP.\n\n   This is the simplest and most basic operation for DHCP and requires a\n   client (and a server) to support only two messages --\n   Information-request and Reply.  Note that DHCP servers and relay\n   agents typically also need to support the Relay-forward and\n   Relay-reply messages to accommodate operation when clients and\n   servers are not on the same link.\n\n\n6.2. DHCP for Non-temporary Address Assignment\n\n   This model of operation was the original motivation for DHCP.  It is\n   appropriate for situations where stateless address autoconfiguration\n   alone is insufficient or impractical, e.g., because of network\n   policy, additional requirements such as dynamic updates to the DNS,\n   or client-specific requirements.\n\n   The model of operation for non-temporary address assignment is as\n   follows:\n\n   *  The server is provided with prefixes from which it may assign\n      addresses to clients, as well as any related network topology\n      information as to which prefixes are present on which links.\n\n   *  A client requests a non-temporary address to be assigned by the\n      server.  The server allocates an address or addresses appropriate\n      for the link on which the client is connected.\n\n   *  The server returns the allocated address or addresses to the\n      client. \n   Each address has associated preferred and valid lifetimes (see Section 12.1), which constitute an agreement about the length of time\n   over which the client is allowed to use the address.  A client can\n   request an extension of the lifetimes on an address and is required\n   to terminate the use of an address if the valid lifetime of the\n   address expires.\n\n   Typically, clients request other configuration parameters, such as\n   the DNS name server addresses and domain search lists, when\n   requesting addresses.\n\n   Clients can also request more than one address or set of addresses\n   (see Sections 6.5 and 12).\n\n\n6.3. DHCP for Prefix Delegation\n\n   The prefix delegation mechanism is another stateful mode of operation\n   and was originally intended for simple delegation of prefixes from a\n   DHCP server to DHCP clients (typically routers).  It is appropriate\n   for situations in which the client (1) does not have knowledge about\n   the topology of the networks to which it is attached and (2) does not\n   require other information to choose a prefix for delegation.  This\n   mechanism is appropriate for use by an ISP to delegate a prefix to a\n   subscriber, where the delegated prefix would possibly be subnetted\n   and assigned to the links within the subscriber's network.  [RFC7084]\n   and [RFC7368] describe such use in detail.\n\n   The design of this prefix delegation mechanism meets the requirements\n   for prefix delegation in [RFC3769].\n\n   DHCP prefix delegation itself does not require that the client\n   forward IP packets not addressed to itself and thus does not require\n   that the client (or server) be a router as defined in [RFC8200].\n   Also, in many cases (such as tethering or hosting virtual machines),\n   hosts are already forwarding IP packets and thus are operating as\n   routers as defined in [RFC8200].\n\n   The model of operation for prefix delegation is as follows:\n\n   *  The server is provisioned with prefixes to be delegated to\n      clients.\n\n   *  A client requests prefix(es) from the server, as described in Section 18.\n\n   *  The server chooses prefix(es) for delegation and responds with\n      prefix(es) to the client. \n   *  The client is then responsible for the delegated prefix(es).  For\n      example, the client might assign a subnet from a delegated prefix\n      to one of its interfaces and begin sending Router Advertisements\n      for the prefix on that link.\n\n   Each prefix has an associated preferred lifetime and valid lifetime\n   (see Section 12.2), which constitute an agreement about the length of\n   time over which the client is allowed to use the prefix.  A client\n   can request an extension of the lifetimes on a delegated prefix and\n   is required to terminate the use of a delegated prefix if the valid\n   lifetime of the prefix expires.\n\n   Figure 1 illustrates a network architecture in which prefix\n   delegation could be used.\n\n                      ______________________         \\\n                     /                      \\         \\\n                    |    ISP core network    |         \\\n                     \\__________ ___________/           |\n                                |                       |\n                        +-------+-------+               |\n                        |  Aggregation  |               | ISP\n                        |    device     |               | network\n                        +-------+-------+               |\n                                |                      /\n                                |Network link to      /\n                                |subscriber premises /\n                                |\n                         +-------+-------+           \\\n                         |      CPE      |            \\\n                         | (DHCP client) |             \\\n                         +----+---+------+              |\n                              |   |                     | Subscriber\n       ---+-------------+-----+   +-----+------         | network\n          |             |               |               |\n     +----+-----+ +-----+----+     +----+-----+         |\n     |Subscriber| |Subscriber|     |Subscriber|        /\n     |    PC    | |    PC    |     |    PC    |       /\n     +----------+ +----------+     +----------+      /\n\n                    Figure 1: Prefix Delegation Network\n\n   In this example, the server (in the ISP core network or integrated in\n   the aggregation device) is configured with a set of prefixes to be\n   used for assignment to customers at the time of each customer's first\n   connection to the ISP service.  The prefix delegation process begins\n   when the client (CPE) requests configuration information through\n   DHCP.  The DHCP messages from the client are received by the server \n   via the aggregation device.  When the server receives the request, it\n   selects an available prefix or prefixes for delegation to the client.\n   The server then returns the prefix or prefixes to the client.\n\n   The client subnets the delegated prefix and assigns the longer\n   prefixes to links in the subscriber's network.  In a typical scenario\n   based on the network shown in Figure 1, the client subnets a single\n   delegated /48 prefix into /64 prefixes and assigns one /64 prefix to\n   each of the links in the subscriber network.\n\n   The prefix delegation options can be used in conjunction with other\n   DHCP options carrying other configuration information to the client.\n   The client may, in turn, provide DHCP service to nodes attached to\n   the internal network.  For example, the client may obtain the\n   addresses of DNS and NTP servers from the ISP server and then pass\n   that configuration information on to the subscriber hosts through a\n   DHCP server in the client.\n\n   If the client uses a delegated prefix to configure addresses on\n   interfaces on itself or other nodes behind it, the preferred and\n   valid lifetimes of those addresses MUST be no longer than the\n   remaining preferred and valid lifetimes, respectively, for the\n   delegated prefix at any time.  In particular, if the delegated prefix\n   or a prefix derived from it is advertised for stateless address\n   autoconfiguration [RFC4862], the advertised preferred and valid\n   lifetimes MUST NOT exceed the corresponding remaining lifetimes of\n   the delegated prefix.\n\n   A client that has delegated any of the address space received through\n   DHCP Prefix Delegation MUST NOT issue a DHCP Release on the relevant\n   delegated prefix while any of the address space is outstanding.  That\n   includes addresses leased out by DHCPv6 (IA_NA), prefixes delegated\n   via DHCPv6-PD (IA_PD), and addresses autoconfigured by IPv6 Router\n   Advertisements.  Requirement WPD-9 in [RFC9096] makes this the Best\n   Current Practice.\n\n   [RFC9096] section 3.3 further provides more guidance on coordination\n   of lifetimes between WAN (DHCPv6-PD client) and LAN (DHCPv6-PD\n   server) sides.\n\n   Several problems related to Prefix Delegation and Relay Agents and a\n   set of requirements to address them are defined in [RFC8987]. \n\n\n\n\n\n\n6.4. DHCP for Customer Edge Routers\n\n   The DHCP requirements and network architecture for Customer Edge\n   Routers are described in [RFC7084], with improvements for renumbering\n   described in [RFC9096].  This model of operation combines address\n   assignment (see Section 6.2) and prefix delegation (see Section 6.3).\n   In general, this model assumes that a single set of transactions\n   between the client and server will assign or extend the client's non-\n   temporary addresses and delegated prefixes.\n\n\n6.5. Multiple Addresses and Prefixes\n\n   DHCP allows a client to receive multiple addresses.  During typical\n   operation, a client sends one instance of an IA_NA option and the\n   server assigns at most one address from each prefix assigned to the\n   link to which the client is attached.  In particular, the server can\n   be configured to serve addresses out of multiple prefixes for a given\n   link.  This is useful in cases such as when a network renumbering\n   event is in progress.  In a typical deployment, the server will grant\n   one address for each IA_NA option (see Section 21.4).\n\n   To meet the recommendations of [RFC7934], a client can explicitly\n   request multiple addresses by sending multiple IA_NA options.  A\n   client can send multiple IA_NA options in its initial transmissions.\n   Alternatively, it can send an extra Request message with additional\n   new IA_NA options (or include them in a Renew message).\n\n   The same principle also applies to prefix delegation.  In principle,\n   DHCP allows a client to request new prefixes to be delegated by\n   sending additional IA_PD options (see Section 21.21).  However, a\n   typical operator usually prefers to delegate a single, larger prefix.\n   In most deployments, it is recommended that the client request a\n   larger prefix in its initial transmissions rather than request\n   additional prefixes later on.\n\n   The exact behavior of the server (whether to grant additional\n   addresses and prefixes or not) is up to the server policy and is out\n   of scope for this document.\n\n   For more information on how the server distinguishes between IA\n   option instances, see Section 12. \n\n\n\n\n\n\n6.6. Registering Self-generated Addresses\n\n   [RFC9686] introduces a method for devices to register their self-\n   generated or statically configured addresses in the DHCPv6 servers.\n   The general idea is that devices would notify the server about\n   addresses that they are using, so that the server can log or record\n   these addresses as required by local policy.\n\n   The major specificity of this mechanism is that the address selection\n   is not done by the DHCP server, but by the device itself.  The most\n   of the lifecycle remains the same in principle: a lease is created by\n   the server, and the device performs periodic actions to get the lease\n   renewed, and eventually the lease can expire.  However, this\n   mechanism uses different message types (ADDR-REG-INFORM and ADDR-REG-\n   REPLY) and has different source address requirements, as defined in\n   [RFC9686].\n\n\n7. DHCP Constants\n\n   This section describes various program and networking constants used\n   by DHCP.\n\n7.1. Multicast Addresses\n\n   The following multicast addresses are used by DHCPv6:\n\n   All_DHCP_Relay_Agents_and_Servers (ff02::1:2)\n      A link-scoped multicast address used by a client to communicate\n      with neighboring (i.e., on-link) relay agents and servers.  All\n      servers and relay agents are members of this multicast group.\n\n   All_DHCP_Servers (ff05::1:3)\n      A site-scoped multicast address used by a relay agent to\n      communicate with servers, either because the relay agent wants to\n      send messages to all servers or because it does not know the\n      unicast addresses of the servers.  Note that in order for a relay\n      agent to use this address, it must have an address of sufficient\n      scope to be reachable by the servers.  All servers within the site\n      are members of this multicast group on the interfaces that are\n      within the site.\n\n\n7.2. UDP Ports\n\n   Clients MUST listen for DHCP messages on UDP port 546.  Servers and\n   relay agents MUST listen for DHCP messages on UDP port 547. \n   Therefore, clients MUST send DHCP messages to UDP destination port\n   547.  Servers MUST send Relay-reply messages to UDP destination port\n   547 and client messages to UDP destination port 546.  Relay agents\n   MUST send Relay-forward and Relay-reply messages to UDP destination\n   port 547 and client messages to UDP destination port 546.\n\n   It is RECOMMENDED for clients to send messages from UDP source port\n   546, and servers and relay agents from UDP source port 547.  However,\n   clients, servers, and relay agents MAY send DHCP messages from any\n   UDP source port they are allowed to use.\n\n   Please note that the Relay Source Port Option [RFC8357] changes some\n   of these rules for servers and relays agents.\n\n\n7.3. DHCP Message Types\n\n   DHCP defines the following message types.  The formats of these\n   messages are provided in Sections 8 and 9.  Additional message types\n   have been defined and may be defined in the future; see\n   <https://www.iana.org/assignments/dhcpv6-parameters >.  The numeric\n   encoding for each message type is shown in parentheses.\n\n   SOLICIT (1)               A client sends a Solicit message to locate\n                             servers.\n\n   ADVERTISE (2)             A server sends an Advertise message to\n                             indicate that it is available for DHCP\n                             service, in response to a Solicit message\n                             received from a client.\n\n   REQUEST (3)               A client sends a Request message to request\n                             configuration parameters, including\n                             addresses and/or delegated prefixes, from a\n                             specific server.\n\n   CONFIRM (4)               A client sends a Confirm message to any\n                             available server to determine whether the\n                             addresses it was assigned are still\n                             appropriate to the link to which the client\n                             is connected.\n\n   RENEW (5)                 A client sends a Renew message to the\n                             server that originally provided the\n                             client's leases and configuration\n                             parameters to extend the lifetimes on the\n                             leases assigned to the client and to update\n                             other configuration parameters. \n   REBIND (6)                A client sends a Rebind message to any\n                             available server to extend the lifetimes on\n                             the leases assigned to the client and to\n                             update other configuration parameters; this\n                             message is sent after a client receives no\n                             response to a Renew message.\n\n   REPLY (7)                 A server sends a Reply message containing\n                             assigned leases and configuration\n                             parameters in response to a Solicit,\n                             Request, Renew, or Rebind message received\n                             from a client.  A server sends a Reply\n                             message containing configuration parameters\n                             in response to an Information-request\n                             message.  A server sends a Reply message in\n                             response to a Confirm message confirming or\n                             denying that the addresses assigned to the\n                             client are appropriate to the link to which\n                             the client is connected.  A server sends a\n                             Reply message to acknowledge receipt of a\n                             Release or Decline message.\n\n   RELEASE (8)               A client sends a Release message to the\n                             server that assigned leases to the client\n                             to indicate that the client will no longer\n                             use one or more of the assigned leases.\n\n   DECLINE (9)               A client sends a Decline message to a\n                             server to indicate that the client has\n                             determined that one or more addresses\n                             assigned by the server are already in use\n                             on the link to which the client is\n                             connected.\n\n   RECONFIGURE (10)          A server sends a Reconfigure message to a\n                             client to inform the client that the server\n                             has new or updated configuration parameters\n                             and that the client is to initiate a\n                             Renew/Reply, Rebind/Reply, or\n                             Information-request/Reply transaction with\n                             the server in order to receive the updated\n                             information.\n\n   INFORMATION-REQUEST (11)  A client sends an Information-request\n                             message to a server to request\n                             configuration parameters without the\n                             assignment of any leases to the client. \n   RELAY-FORW (12)           A relay agent sends a Relay-forward message\n                             to relay messages to servers, either\n                             directly or through another relay agent.\n                             The received message -- either a client\n                             message or a Relay-forward message from\n                             another relay agent -- is encapsulated in\n                             an option in the Relay-forward message.\n\n   RELAY-REPL (13)           A server sends a Relay-reply message to a\n                             relay agent containing a message that the\n                             relay agent delivers to a client.  The\n                             Relay-reply message may be relayed by other\n                             relay agents for delivery to the\n                             destination relay agent.\n\n                             The server encapsulates the client message\n                             as an option in the Relay-reply message,\n                             which the relay agent extracts and relays\n                             to the client.\n\n\n7.4. DHCP Option Codes\n\n   DHCP makes extensive use of options in messages; some of these are\n   defined later, in Section 21.  Additional options are defined in\n   other documents or may be defined in the future (see [RFC7227] for\n   guidance on new option definitions).\n\n\n7.5. Status Codes\n\n   DHCP uses status codes to communicate the success or failure of\n   operations requested in messages from clients and servers and to\n   provide additional information about the specific cause of the\n   failure of a message.  The specific status codes are defined in Section 21.13.\n\n   If the Status Code option (see Section 21.13) does not appear in a\n   message in which the option could appear, the status of the message\n   is assumed to be Success.\n\n\n7.6. Transmission and Retransmission Parameters\n\n   The table of values (Table 1) is used to describe the message\n   transmission behavior of clients and servers.  Some of the values are\n   adjusted by a randomization factor and backoffs (see Section 15).\n   Transmissions may also be influenced by rate limiting (see Section 14.1). \n       +=================+============+============================+\n       | Parameter       | Default    | Description                |\n       +=================+============+============================+\n       | SOL_MAX_DELAY   | 1 sec      | Max delay of first Solicit |\n       +-----------------+------------+----------------------------+\n       | SOL_TIMEOUT     | 1 sec      | Initial Solicit timeout    |\n       +-----------------+------------+----------------------------+\n       | SOL_MAX_RT      | 3600 secs  | Max Solicit timeout value  |\n       +-----------------+------------+----------------------------+\n       | REQ_TIMEOUT     | 1 sec      | Initial Request timeout    |\n       +-----------------+------------+----------------------------+\n       | REQ_MAX_RT      | 30 secs    | Max Request timeout value  |\n       +-----------------+------------+----------------------------+\n       | REQ_MAX_RC      | 10         | Max Request retry attempts |\n       +-----------------+------------+----------------------------+\n       | CNF_MAX_DELAY   | 1 sec      | Max delay of first Confirm |\n       +-----------------+------------+----------------------------+\n       | CNF_TIMEOUT     | 1 sec      | Initial Confirm timeout    |\n       +-----------------+------------+----------------------------+\n       | CNF_MAX_RT      | 4 secs     | Max Confirm timeout        |\n       +-----------------+------------+----------------------------+\n       | CNF_MAX_RD      | 10 secs    | Max Confirm duration       |\n       +-----------------+------------+----------------------------+\n       | REN_TIMEOUT     | 10 secs    | Initial Renew timeout      |\n       +-----------------+------------+----------------------------+\n       | REN_MAX_RT      | 600 secs   | Max Renew timeout value    |\n       +-----------------+------------+----------------------------+\n       | REB_TIMEOUT     | 10 secs    | Initial Rebind timeout     |\n       +-----------------+------------+----------------------------+\n       | REB_MAX_RT      | 600 secs   | Max Rebind timeout value   |\n       +-----------------+------------+----------------------------+\n       | INF_MAX_DELAY   | 1 sec      | Max delay of first         |\n       |                 |            | Information-request        |\n       +-----------------+------------+----------------------------+\n       | INF_TIMEOUT     | 1 sec      | Initial Information-       |\n       |                 |            | request timeout            |\n       +-----------------+------------+----------------------------+\n       | INF_MAX_RT      | 3600 secs  | Max Information-request    |\n       |                 |            | timeout value              |\n       +-----------------+------------+----------------------------+\n       | REL_TIMEOUT     | 1 sec      | Initial Release timeout    |\n       +-----------------+------------+----------------------------+\n       | REL_MAX_RC      | 4          | Max Release retry attempts |\n       +-----------------+------------+----------------------------+\n       | DEC_TIMEOUT     | 1 sec      | Initial Decline timeout    |\n       +-----------------+------------+----------------------------+\n       | DEC_MAX_RC      | 4          | Max Decline retry attempts |\n       +-----------------+------------+----------------------------+\n       | REC_TIMEOUT     | 2 secs     | Initial Reconfigure        |\n       |                 |            | timeout                    |\n       +-----------------+------------+----------------------------+\n       | REC_MAX_RC      | 8          | Max Reconfigure attempts   |\n       +-----------------+------------+----------------------------+\n       | HOP_COUNT_LIMIT | 8          | Max hop count in a Relay-  |\n       |                 |            | forward message            |\n       +-----------------+------------+----------------------------+\n       | IRT_DEFAULT     | 86400 secs | Default information        |\n       |                 | (24 hours) | refresh time               |\n       +-----------------+------------+----------------------------+\n       | IRT_MINIMUM     | 600 secs   | Min information refresh    |\n       |                 |            | time                       |\n       +-----------------+------------+----------------------------+\n       | MAX_WAIT_TIME   | 60 secs    | Max required time to wait  |\n       |                 |            | for a response             |\n       +-----------------+------------+----------------------------+\n\n            Table 1: Transmission and Retransmission Parameters\n\n\n7.7. Representation of Time Values and \"Infinity\" as a Time Value\n\n   All time values for lifetimes, T1, and T2 are unsigned 32-bit\n   integers and are expressed in units of seconds.  The value 0xffffffff\n   is taken to mean \"infinity\" when used as a lifetime (as in [RFC4861])\n   or a value for T1 or T2.\n\n   Setting the valid lifetime of an address or a delegated prefix to\n   0xffffffff (\"infinity\") amounts to a permanent assignment of an\n   address or delegation to a client and should only be used in cases\n   where permanent assignments are desired.\n\n   Care should be taken in setting T1 or T2 to 0xffffffff (\"infinity\").\n   A client will never attempt to extend the lifetimes of any addresses\n   in an IA with T1 set to 0xffffffff.  A client will never attempt to\n   use a Rebind message to locate a different server to extend the\n   lifetimes of any addresses in an IA with T2 set to 0xffffffff.\n\n\n8. Client/Server Message Formats\n\n   All DHCP messages sent between clients and servers share an identical\n   fixed-format header and a variable-format area for options.\n\n   All values in the message header and in options are in network byte\n   order. \n   Options are stored serially in the \"options\" field, with no padding\n   between the options.  Options are byte-aligned but are not aligned in\n   any other way (such as on 2-byte or 4-byte boundaries).\n\n   The following diagram illustrates the format of DHCP messages sent\n   between clients and servers:\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |    msg-type   |               transaction-id                  |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                                                               |\n      .                            options                            .\n      .                 (variable number and length)                  .\n      |                                                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                   Figure 2: Client/Server Message Format\n\n   msg-type                Identifies the DHCP message type; the\n                           available message types are listed in Section 7.3.  A 1-octet field.\n\n   transaction-id          The transaction ID for this message exchange.\n                           A 3-octet field.\n\n   options                 Options carried in this message; options are\n                           described in Section 21.  A variable-length\n                           field (4 octets less than the size of the\n                           message).\n\n9. Relay Agent/Server Message Formats\n\n   Relay agents exchange messages with other relay agents and servers to\n   relay messages between clients and servers that are not connected to\n   the same link.\n\n   All values in the message header and in options are in network byte\n   order.\n\n   Options are stored serially in the \"options\" field, with no padding\n   between the options.  Options are byte-aligned but are not aligned in\n   any other way (such as on 2-byte or 4-byte boundaries).\n\n   There are two relay agent messages (Relay-forward and Relay-reply),\n   which share the following format:\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |    msg-type   |   hop-count   |                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |\n      |                                                               |\n      |                         link-address                          |\n      |                                                               |\n      |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-|\n      |                               |                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |\n      |                                                               |\n      |                         peer-address                          |\n      |                                                               |\n      |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-|\n      |                               |                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |\n      .                                                               .\n      .            options (variable number and length)   ....        .\n      |                                                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                Figure 3: Relay Agent/Server Message Format\n\n   The following sections describe the use of the relay agent message\n   header.\n\n9.1. Relay-forward Message\n\n   The following table defines the use of message fields in a\n   Relay-forward message.\n\n   msg-type                RELAY-FORW (12).  A 1-octet field.\n\n   hop-count               Number of relay agents that have already\n                           relayed this message.  A 1-octet field.\n\n   link-address            An address that may be used by the server to\n                           identify the link on which the client is\n                           located.  This is typically a globally scoped\n                           unicast address (i.e., GUA or ULA), but see\n                           the discussion in Section 19.1.1.  A 16-octet\n                           field.\n\n   peer-address            The address of the client or relay agent from\n                           which the message to be relayed was received.\n                           A 16-octet field. \n   options                 MUST include a Relay Message option (see Section 21.10); MAY include other options,\n                           such as the Interface-Id option (see Section 21.18), added by the relay agent.  A\n                           variable-length field (34 octets less than\n                           the size of the message).\n\n   See Section 13.1 for an explanation of how the link-address field\n   is used.\n\n\n9.2. Relay-reply Message\n\n   The following table defines the use of message fields in a\n   Relay-reply message.\n\n   msg-type                RELAY-REPL (13).  A 1-octet field.\n\n   hop-count               Copied from the Relay-forward message.\n                           A 1-octet field.\n\n   link-address            Copied from the Relay-forward message.\n                           A 16-octet field.\n\n   peer-address            Copied from the Relay-forward message.\n                           A 16-octet field.\n\n   options                 MUST include a Relay Message option (see Section 21.10); MAY include other options,\n                           such as the Interface-Id option (see Section 21.18).  A variable-length field\n                           (34 octets less than the size of the\n                           message).\n\n\n10. Representation and Use of Domain Names\n\n   So that domain names may be encoded uniformly, a domain name or a\n   list of domain names is encoded using the technique described in Section 3.1 of [RFC1035].  The message compression scheme in Section 4.1.4 of [RFC1035] MUST NOT be used.\n\n11. DHCP Unique Identifier (DUID)\n\n   Each DHCP client and server has a DUID.  DHCP servers use DUIDs to\n   identify clients for the selection of configuration parameters and in\n   the association of IAs with clients.  DHCP clients use DUIDs to\n   identify a server in messages where a server needs to be identified.\n   See Sections 21.2 and 21.3 for details regarding the representation\n   of a DUID in a DHCP message. \n   Clients and servers MUST treat DUIDs as opaque values and MUST only\n   compare DUIDs for equality.  Clients and servers SHOULD NOT in any\n   other way interpret DUIDs.  Clients and servers MUST NOT restrict\n   DUIDs to the types defined in this document, as additional DUID types\n   may be defined in the future.  It should be noted that an attempt to\n   parse a DUID to obtain a client's link-layer address is unreliable,\n   as there is no guarantee that the client is still using the same\n   link-layer address as when it generated its DUID.  Also, such an\n   attempt will be more and more unreliable as more clients adopt\n   privacy measures such as those defined in [RFC7844].  If this\n   capability is required, it is recommended to rely on the Client\n   Link-Layer Address option instead [RFC6939].\n\n   The DUID is carried in an option because it may be variable in length\n   and because it is not required in all DHCP messages.  The DUID is\n   designed to be unique across all DHCP clients and servers, and stable\n   for any specific client or server.  That is, the DUID used by a\n   client or server SHOULD NOT change over time if at all possible; for\n   example, a device's DUID should not change as a result of a change in\n   the device's network hardware or changes to virtual interfaces (e.g.,\n   logical PPP (over Ethernet) interfaces that may come and go in\n   Customer Premises Equipment routers).  The client may change its DUID\n   as specified in [RFC7844].\n\n   The motivation for having more than one type of DUID is that the DUID\n   must be globally unique and must also be easy to generate.  The sort\n   of globally unique identifier that is easy to generate for any given\n   device can differ quite widely.  Also, some devices may not contain\n   any persistent storage.  Retaining a generated DUID in such a device\n   is not possible, so the DUID scheme must accommodate such devices.\n\n11.1. DUID Contents\n\n   A DUID consists of a 2-octet type code represented in network byte\n   order, followed by a variable number of octets that make up the\n   actual identifier.  The length of the DUID (not including the type\n   code) is at least 1 octet and at most 128 octets.  The following\n   types are currently defined:\n      +======+======================================================+\n      | Type | Description                                          |\n      +======+======================================================+\n      | 1    | Link-layer address plus time                         |\n      +------+------------------------------------------------------+\n      | 2    | Vendor-assigned unique ID based on Enterprise Number |\n      +------+------------------------------------------------------+\n      | 3    | Link-layer address                                   |\n      +------+------------------------------------------------------+\n      | 4    | Universally Unique Identifier (UUID) [RFC6355]       |\n      +------+------------------------------------------------------+\n\n                            Table 2: DUID Types\n\n   Formats for the variable field of the DUID for the first three of the\n   above types are shown below.  The fourth type, DUID-UUID [RFC6355],\n   can be used in situations where there is a UUID stored in a device's\n   firmware settings.\n\n\n11.2. DUID Based on Link-Layer Address Plus Time (DUID-LLT)\n\n   This type of DUID consists of a 2-octet type field containing the\n   value 1, a 2-octet hardware type code, and 4 octets containing a time\n   value, followed by the link-layer address of any one network\n   interface that is connected to the DHCP device at the time that the\n   DUID is generated.  The time value is the time that the DUID is\n   generated, represented in seconds since midnight (UTC), January 1,\n   2000, modulo 2^32.  The hardware type MUST be a valid hardware type\n   assigned by IANA; see [IANA-HARDWARE-TYPES ].  Both the time and the\n   hardware type are stored in network byte order.  For Ethernet\n   hardware types, the link-layer address is stored in canonical form,\n   as described in [RFC2464].\n\n   The following diagram illustrates the format of a DUID-LLT:\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |         DUID-Type (1)         |    hardware type (16 bits)    |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                        time (32 bits)                         |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      .                                                               .\n      .             link-layer address (variable length)              .\n      .                                                               .\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                         Figure 4: DUID-LLT Format \n   The choice of network interface can be completely arbitrary, as long\n   as that interface provides a globally unique link-layer address for\n   the link type; the same DUID-LLT SHOULD be used in configuring all\n   network interfaces connected to the device, regardless of which\n   interface's link-layer address was used to generate the DUID-LLT.\n\n   Clients and servers using this type of DUID MUST store the DUID-LLT\n   in stable storage and MUST continue to use this DUID-LLT even if the\n   network interface used to generate the DUID-LLT is removed.  Clients\n   and servers that do not have any stable storage MUST NOT use this\n   type of DUID.\n\n   Clients and servers that use this DUID SHOULD attempt to configure\n   the time prior to generating the DUID, if that is possible, and MUST\n   use some sort of time source (for example, a real-time clock) in\n   generating the DUID, even if that time source could not be configured\n   prior to generating the DUID.  The use of a time source makes it\n   unlikely that two identical DUID-LLTs will be generated if the\n   network interface is removed from the client and another client then\n   uses the same network interface to generate a DUID-LLT.  A collision\n   between two DUID-LLTs is very unlikely even if the clocks have not\n   been configured prior to generating the DUID.\n\n   This method of DUID generation is recommended for all general-purpose\n   computing devices such as desktop computers and laptop computers, and\n   also for devices such as printers, routers, and so on, that contain\n   some form of writable non-volatile storage.\n\n   It is possible that this algorithm for generating a DUID could result\n   in a client identifier collision.  A DHCP client that generates a\n   DUID-LLT using this mechanism MUST provide an administrative\n   interface that replaces the existing DUID with a newly generated\n   DUID-LLT.\n\n\n11.3. DUID Assigned by Vendor Based on Enterprise Number (DUID-EN)\n\n   The vendor assigns this form of DUID to the device.  This DUID\n   consists of the 4-octet vendor's registered Private Enterprise Number\n   as maintained by IANA [IANA-PEN ] followed by a unique identifier\n   assigned by the vendor.  The following diagram summarizes the\n   structure of a DUID-EN:\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |         DUID-Type (2)         |       enterprise-number       |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |   enterprise-number (contd)   |                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |\n      .                           identifier                          .\n      .                       (variable length)                       .\n      .                                                               .\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                          Figure 5: DUID-EN Format\n\n   The source of the identifier is left up to the vendor defining it,\n   but each identifier part of each DUID-EN MUST be unique to the device\n   that is using it, and MUST be assigned to the device no later than at\n   the first usage and stored in some form of non-volatile storage.\n   This typically means being assigned during the manufacturing process\n   in the case of physical devices or, in the case of virtual machines,\n   when the image is created or booted for the first time.  The\n   generated DUID SHOULD be recorded in non-erasable storage.  The\n   enterprise-number is the vendor's registered Private Enterprise\n   Number as maintained by IANA [IANA-PEN ].  The enterprise-number is\n   stored as an unsigned 32-bit number.\n\n   An example DUID of this type might look like this:\n\n      +---+---+---+---+---+---+---+---+\n      | 0 | 2 | 0 | 0 |126|217| 12|192|\n      +---+---+---+---+---+---+---+---+\n      |132|211| 3 | 0 | 9 | 18|\n      +---+---+---+---+---+---+\n\n                         Figure 6: DUID-EN Example\n\n   This example includes the 2-octet type of 2 and the Enterprise Number\n   (32473) (from [RFC5612]), followed by 8 octets of identifier data\n   (0x0CC084D303000912).\n\n\n11.4. DUID Based on Link-Layer Address (DUID-LL)\n\n   This type of DUID consists of 2 octets containing a DUID type of 3\n   and a 2-octet network hardware type code, followed by the link-layer\n   address of any one network interface that is permanently connected to\n   the client or server device.  For example, a node that has a network\n   interface implemented in a chip that is unlikely to be removed and\n   used elsewhere could use a DUID-LL.  The hardware type MUST be a \n   valid hardware type assigned by IANA; see [IANA-HARDWARE-TYPES ].  The\n   hardware type is stored in network byte order.  The link-layer\n   address is stored in canonical form, as described in [RFC2464].  The\n   following diagram illustrates the format of a DUID-LL:\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |         DUID-Type (3)         |    hardware type (16 bits)    |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      .                                                               .\n      .             link-layer address (variable length)              .\n      .                                                               .\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                          Figure 7: DUID-LL Format\n\n   The choice of network interface can be completely arbitrary, as long\n   as that interface provides a unique link-layer address and is\n   permanently attached to the device on which the DUID-LL is being\n   generated.  The same DUID-LL SHOULD be used in configuring all\n   network interfaces connected to the device, regardless of which\n   interface's link-layer address was used to generate the DUID.\n\n   A DUID-LL is recommended for devices that have a permanently\n   connected network interface with a link-layer address and do not have\n   nonvolatile, writable stable storage.  A DUID-LL SHOULD NOT be used\n   by DHCP clients or servers that cannot tell whether or not a network\n   interface is permanently attached to the device on which the DHCP\n   client is running.\n\n\n11.5. DUID Based on Universally Unique Identifier (DUID-UUID)\n\n   This type of DUID consists of 16 octets containing a 128-bit UUID.\n   [RFC6355] details when to use this type and how to pick an\n   appropriate source of the UUID.\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |         DUID-Type (4)         |        UUID (128 bits)        |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |\n      |                                                               |\n      |                                                               |\n      |                                -+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                                |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-\n                         Figure 8: DUID-UUID Format\n\n\n12. Identity Association\n\n   An Identity Association (IA) is a construct through which a server\n   and a client can identify, group, and manage a set of related IPv6\n   addresses or delegated prefixes.  Each IA consists of an IAID and\n   associated configuration information.\n\n   The IAID uniquely identifies the IA and MUST be chosen to be unique\n   among the IAIDs for that IA type on the client (e.g., an IA_NA with\n   an IAID of 0 and an IA_PD with an IAID of 0 are each considered\n   unique).  The IAID is chosen by the client.  For any given use of an\n   IA by the client, the IAID for that IA MUST be consistent across\n   restarts of the DHCP client.  The client may maintain consistency by\n   either storing the IAID in non-volatile storage or using an algorithm\n   that will consistently produce the same IAID as long as the\n   configuration of the client has not changed.  There may be no way for\n   a client to maintain consistency of the IAIDs if it does not have\n   non-volatile storage and the client's hardware configuration changes.\n   If the client uses only one IAID, it can use a well-known value,\n   e.g., zero.\n\n   If the client wishes to obtain a distinctly new address or prefix and\n   deprecate the existing one, the client sends a Release message to the\n   server for the IAs using the original IAID.  The client then creates\n   a new IAID, to be used in future messages to obtain leases for the\n   new IA.\n\n12.1. Identity Associations for Address Assignment\n\n   A client must associate at least one distinct IA with each of its\n   network interfaces for which it is to request the assignment of IPv6\n   addresses from a DHCP server.  The client uses the IAs assigned to an\n   interface to obtain configuration information from a server for that\n   interface.  Each such IA must be associated with exactly one\n   interface.\n\n   The configuration information in an IA_NA option consists of one or\n   more IPv6 addresses along with the T1 and T2 values for the IA.  See Section 21.4 for details regarding the representation of an IA_NA in\n   a DHCP message.\n\n   Each address in an IA has a preferred lifetime and a valid lifetime,\n   as defined in [RFC4862].  The lifetimes are transmitted from the DHCP\n   server to the client in the IA Address option (see Section 21.6).\n   The lifetimes apply to the use of addresses; see Section 5.5.4 of\n   [RFC4862]. \n\n\n\n\n\n\n12.2. Identity Associations for Prefix Delegation\n\n   An IA_PD is different from an IA for address assignment in that it\n   does not need to be associated with exactly one interface.  One IA_PD\n   can be associated with the client, with a set of interfaces, or with\n   exactly one interface.  A client configured to request delegated\n   prefixes must create at least one distinct IA_PD.  It may associate a\n   distinct IA_PD with each of its downstream network interfaces and use\n   that IA_PD to obtain a prefix for that interface from the server.\n\n   The configuration information in an IA_PD option consists of one or\n   more prefixes along with the T1 and T2 values for the IA_PD.  See Section 21.21 for details regarding the representation of an IA_PD in\n   a DHCP message.\n\n   Each delegated prefix in an IA has a preferred lifetime and a valid\n   lifetime, as defined in [RFC4862].  The lifetimes are transmitted\n   from the DHCP server to the client in the IA Prefix option (see Section 21.22).  The lifetimes apply to the use of delegated\n   prefixes; see Section 5.5.4 of [RFC4862].\n\n\n13. Assignment to an IA\n\n\n\n\n\n13.1. Selecting Addresses for Assignment to an IA_NA\n\n   A server selects addresses to be assigned to an IA_NA according to\n   the address assignment policies determined by the server\n   administrator and the specific information the server determines\n   about the client from some combination of the following sources:\n\n   *  The link to which the client is attached.  The server determines\n      the link as follows:\n\n      -  If the server receives the message directly from the client and\n         the source address in the IP datagram in which the message was\n         received is a link-local address, then the client is on the\n         same link to which the interface over which the message was\n         received is attached.\n\n      -  If the server receives the message from a forwarding relay\n         agent, then the client is on the same link as the one to which\n         the interface, identified by the link-address field in the\n         message from the relay agent, is attached.  According to\n         [RFC6221], the server MUST ignore any link-address field whose\n         value is zero.  The link-address in this case may come from any\n         of the Relay-forward messages encapsulated in the received\n         Relay-forward, and in general the most encapsulated (closest\n         Relay-forward to the client) has the most useful value. \n   *  The DUID supplied by the client.\n\n   *  Other information in options supplied by the client, e.g., IA\n      Address options (see Section 21.6) that include the client's\n      requests for specific addresses.\n\n   *  Other information in options supplied by the relay agent.\n\n   By default, DHCP server implementations SHOULD NOT generate\n   predictable addresses (see Section 4.7 of [RFC7721]).  Server\n   implementers are encouraged to review [RFC8981], [RFC7824],\n   [RFC7707], and [RFC7943] as to possible considerations for how to\n   generate addresses.\n\n   A server MUST NOT assign an address that is otherwise reserved for\n   some other purpose.  For example, a server MUST NOT assign addresses\n   that use a reserved IPv6 Interface Identifier [RFC5453] [RFC7136]\n   [IANA-RESERVED-IID ].\n\n   See [RFC7969] for a more detailed discussion on how servers determine\n   a client's location on the network.\n\n\n13.2. Assignment of Prefixes for IA_PD\n\n   The mechanism through which the server selects prefix(es) for\n   delegation is not specified in this document.  Examples of ways in\n   which the server might select prefix(es) for a client include static\n   assignment based on subscription to an ISP, dynamic assignment from a\n   pool of available prefixes, and selection based on an external\n   authority such as a RADIUS server using the Framed-IPv6-Prefix option\n   as described in [RFC3162].\n\n\n14. Transmission of Messages by a Client\n\n   Unless otherwise specified in this document or in a document that\n   describes how IPv6 is carried over a specific type of link (for link\n   types that do not support multicast), a client sends DHCP messages to\n   the All_DHCP_Relay_Agents_and_Servers multicast address.\n\n   DHCP servers SHOULD NOT check to see whether the Layer 2 address used\n   was multicast or not, as long as the Layer 3 address was correct.\n\n   A client uses multicast to reach all servers or an individual server.\n   An individual server is indicated by specifying that server's DUID in\n   a Server Identifier option (see Section 21.3) in the client's\n   message.  (All servers will receive this message, but only the\n   indicated server will respond.)  All servers are indicated when this\n   option is not supplied. \n\n\n\n\n\n14.1. Rate Limiting\n\n   A DHCPv6 client MUST limit the rate of DHCP messages it transmits or\n   retransmits.  This will minimise the impact of prolonged message\n   bursts or loops, for example when a client rejects a server's\n   response, repeats the request and gets the same server response which\n   again gets rejected by the client.\n\n   This loop can repeat infinitely if there is not a quit/stop\n   mechanism.  Therefore, a client must not initiate transmissions too\n   frequently.\n\n   A recommended method for implementing the rate-limiting function is a\n   token bucket (see Appendix A of [RFC3290]), limiting the average rate\n   of transmission to a certain number in a certain time interval.  This\n   method of bounding burstiness also guarantees that the long-term\n   transmission rate will not be exceeded.\n\n   A transmission rate limit SHOULD be configurable.  A possible default\n   could be 20 messages in 20 seconds.\n\n   For a device that has multiple interfaces, the limit MUST be enforced\n   on a per-interface basis.\n\n   Rate limiting of forwarded DHCP messages and server-side messages is\n   out of scope for this specification.\n\n\n14.2. Client Behavior when T1 and/or T2 Are 0\n\n   In certain cases, T1 and/or T2 values may be set to 0.  Currently,\n   there are two such cases:\n\n   1.  a client received an IA_NA option (see Section 21.4) with a zero\n       value\n\n   2.  a client received an IA_PD option (see Section 21.21) with a zero\n       value\n\n   This is an indication that the renew and rebind times are left to the\n   discretion of the client.  However, they are not completely\n   discretionary. \n   When T1 and/or T2 values are set to 0, the client MUST choose a time\n   to avoid message storms.  In particular, it MUST NOT transmit\n   immediately.  If the client received multiple IA options, it SHOULD\n   pick renew and/or rebind transmission times so all IA options are\n   handled in one exchange, if possible.  The client MUST choose renew\n   and rebind times to not violate rate-limiting restrictions as defined\n   in Section 14.1.\n\n\n15. Reliability of Client-Initiated Message Exchanges\n\n   DHCP clients are responsible for reliable delivery of messages in the\n   client-initiated message exchanges described in Section 18.  If a\n   DHCP client fails to receive an expected response from a server, the\n   client must retransmit its message according to the retransmission\n   strategy described below.\n\n   Note that the procedure described in this section is slightly\n   modified when used with the Solicit message.  The modified procedure\n   is described in Section 18.2.1.\n\n   The client begins the message exchange by transmitting a message to\n   the server.  The message exchange terminates when either (1) the\n   client successfully receives the appropriate response or responses\n   from a server or servers or (2) the message exchange is considered to\n   have failed according to the retransmission mechanism described\n   below.\n\n   The client MUST update an \"elapsed-time\" value within an Elapsed Time\n   option (see Section 21.9) in the retransmitted message.  In some\n   cases, the client may also need to modify values in IA Address\n   options (see Section 21.6) or IA Prefix options (see Section 21.22)\n   if a valid lifetime for any of the client's leases expires before\n   retransmission.  Thus, whenever this document refers to a\n   \"retransmission\" of a client's message, it refers to both modifying\n   the original message and sending this new message instance to the\n   server.\n\n   The client retransmission behavior is controlled and described by the\n   following variables:\n\n   RT         Retransmission timeout\n\n   IRT        Initial retransmission time\n\n   MRC        Maximum retransmission count\n\n   MRT        Maximum retransmission time \n   MRD        Maximum retransmission duration\n\n   RAND       Randomization factor\n\n   Specific values for each of these parameters relevant to the various\n   messages are given in the subsections of Section 18.2, using values\n   defined in Table 1 in Section 7.6.  The algorithm for RAND is common\n   across all message transmissions.\n\n   With each message transmission or retransmission, the client sets RT\n   according to the rules given below.  If RT expires before the message\n   exchange terminates, the client recomputes RT and retransmits the\n   message.\n\n   Each of the computations of a new RT includes a randomization factor\n   (RAND), which is a random number chosen with a uniform distribution\n   between -0.1 and +0.1.  The randomization factor is included to\n   minimize synchronization of messages transmitted by DHCP clients.\n\n   The algorithm for choosing a random number does not need to be\n   cryptographically sound.  The algorithm SHOULD produce a different\n   sequence of random numbers from each invocation of the DHCP client.\n\n   RT for the first message transmission is based on IRT:\n\n      RT = IRT + RAND*IRT\n\n   RT for each subsequent message transmission is based on the previous\n   value of RT:\n\n      RT = 2*RTprev + RAND*RTprev\n\n   MRT specifies an upper bound on the value of RT (disregarding the\n   randomization added by the use of RAND).  If MRT has a value of 0,\n   there is no upper limit on the value of RT.  Otherwise:\n\n      if (RT > MRT)\n         RT = MRT + RAND*MRT\n\n   MRC specifies an upper bound on the number of times a client may\n   retransmit a message.  Unless MRC is zero, the message exchange fails\n   once the client has transmitted the message MRC times.\n\n   MRD specifies an upper bound on the length of time a client may\n   retransmit a message.  Unless MRD is zero, the message exchange fails\n   once MRD seconds have elapsed since the client first transmitted the\n   message. \n   If both MRC and MRD are non-zero, the message exchange fails whenever\n   either of the conditions specified in the previous two paragraphs\n   is met.\n\n   If both MRC and MRD are zero, the client continues to transmit the\n   message until it receives a response.\n\n   A client is not expected to listen for a response during the entire\n   RT period and may turn off listening capabilities after waiting at\n   least the shorter of RT and MAX_WAIT_TIME due to power consumption\n   saving or other reasons.  Of course, a client MUST listen for a\n   Reconfigure if it has negotiated for its use with the server.\n\n16. Message Validation\n\n   This section describes which options are valid in which kinds of\n   message types and explains what to do when a client or server\n   receives a message that contains known options that are invalid for\n   that message.  For example, an IA option is not allowed to appear in\n   an Information-request message.\n\n   Clients and servers MAY choose to either (1) extract information from\n   such a message if the information is of use to the recipient or\n   (2) ignore such a message completely and just discard it.\n\n   If a server receives a message that it considers invalid, it MAY send\n   a Reply message (or Advertise message, as appropriate) with a Server\n   Identifier option (see Section 21.3), a Client Identifier option (see Section 21.2) (if one was included in the message), and a Status Code\n   option (see Section 21.13) with status UnspecFail.\n\n   Clients, relay agents, and servers MUST NOT discard messages that\n   contain unknown options (or instances of vendor options with unknown\n   enterprise-number values).  These options should be ignored as if\n   they were not present.  This is critical to provide for future\n   extensions of DHCP.\n\n   A client or server MUST discard any received DHCP messages with an\n   unknown message type.\n\n   Clients SHOULD NOT accept multicast messages.\n\n   Servers SHOULD NOT accept unicast traffic from clients.  The Server\n   Unicast option (see Section 21.12) and UseMulticast status code (see Section 21.13) have been obsoleted and hence clients should no longer\n   send messages to a server's unicast address nor receive the\n   UseMulticast status code.  However, a server that previously\n   supported the Server Unicast option and is upgraded to not support \n   it, MAY continue to receive unicast messages if it previously sent\n   the client the Server Unicast option.  But this causes no harm and\n   the client will eventually switch back to sending multicast messages\n   (such as after the lease's rebinding time is reached or the client is\n   rebooted).\n\n   Relay agents SHOULD NOT accept unicast messages from clients.\n\n   Note: The multicast/unicast rules mentioned above apply to the DHCP\n   messages within this document.  Messages defined in other and future\n   documents may have different rules.\n\n16.1. Use of Transaction IDs\n\n   The \"transaction-id\" field holds a value used by clients and servers\n   to synchronize server responses to client messages.  A client SHOULD\n   generate a random number that cannot easily be guessed or predicted\n   to use as the transaction ID for each new message it sends.  Note\n   that if a client generates easily predictable transaction\n   identifiers, it may become more vulnerable to certain kinds of\n   attacks from off-path intruders.  A client MUST leave the transaction\n   ID unchanged in retransmissions of a message.\n\n\n16.2. Solicit Message\n\n   Clients MUST discard any received Solicit messages.\n\n   Servers MUST discard any Solicit messages that do not include a\n   Client Identifier option or that do include a Server Identifier\n   option.\n\n\n16.3. Advertise Message\n\n   Clients MUST discard any received Advertise message that meets any of\n   the following conditions:\n\n   *  the message does not include a Server Identifier option (see Section 21.3).\n\n   *  the message does not include a Client Identifier option (see Section 21.2).\n\n   *  the contents of the Client Identifier option do not match the\n      client's DUID.\n\n   *  the \"transaction-id\" field value does not match the value the\n      client used in its Solicit message. \n   Servers and relay agents MUST discard any received Advertise\n   messages.\n\n\n16.4. Request Message\n\n   Clients MUST discard any received Request messages.\n\n   Servers MUST discard any received Request message that meets any of\n   the following conditions:\n\n   *  the message does not include a Server Identifier option (see Section 21.3).\n\n   *  the contents of the Server Identifier option do not match the\n      server's DUID.\n\n   *  the message does not include a Client Identifier option (see Section 21.2).\n\n\n16.5. Confirm Message\n\n   Clients MUST discard any received Confirm messages.\n\n   Servers MUST discard any received Confirm messages that do not\n   include a Client Identifier option (see Section 21.2) or that do\n   include a Server Identifier option (see Section 21.3).\n\n\n16.6. Renew Message\n\n   Clients MUST discard any received Renew messages.\n\n   Servers MUST discard any received Renew message that meets any of the\n   following conditions:\n\n   *  the message does not include a Server Identifier option (see Section 21.3).\n\n   *  the contents of the Server Identifier option do not match the\n      server's identifier.\n\n   *  the message does not include a Client Identifier option (see Section 21.2).\n\n\n16.7. Rebind Message\n\n   Clients MUST discard any received Rebind messages. \n   Servers MUST discard any received Rebind messages that do not include\n   a Client Identifier option (see Section 21.2) or that do include a\n   Server Identifier option (see Section 21.3).\n\n\n16.8. Decline Message\n\n   Clients MUST discard any received Decline messages.\n\n   Servers MUST discard any received Decline message that meets any of\n   the following conditions:\n\n   *  the message does not include a Server Identifier option (see Section 21.3).\n\n   *  the contents of the Server Identifier option do not match the\n      server's identifier.\n\n   *  the message does not include a Client Identifier option (see Section 21.2).\n\n\n16.9. Release Message\n\n   Clients MUST discard any received Release messages.\n\n   Servers MUST discard any received Release message that meets any of\n   the following conditions:\n\n   *  the message does not include a Server Identifier option (see Section 21.3).\n\n   *  the contents of the Server Identifier option do not match the\n      server's identifier.\n\n   *  the message does not include a Client Identifier option (see Section 21.2).\n\n\n16.10. Reply Message\n\n   Clients MUST discard any received Reply message that meets any of the\n   following conditions:\n\n   *  the message does not include a Server Identifier option (see Section 21.3).\n\n   *  the \"transaction-id\" field in the message does not match the value\n      used in the original message. \n   If the client included a Client Identifier option (see Section 21.2)\n   in the original message, the Reply message MUST include a Client\n   Identifier option, and the contents of the Client Identifier option\n   MUST match the DUID of the client.  If the client did not include a\n   Client Identifier option in the original message, the Reply message\n   MUST NOT include a Client Identifier option.\n\n   Servers and relay agents MUST discard any received Reply messages.\n\n\n16.11. Reconfigure Message\n\n   Servers and relay agents MUST discard any received Reconfigure\n   messages.\n\n   Clients MUST discard any Reconfigure message that meets any of the\n   following conditions:\n\n   *  the message was not unicast to the client.\n\n   *  the message does not include a Server Identifier option (see Section 21.3).\n\n   *  the message does not include a Client Identifier option (see Section 21.2) that contains the client's DUID.\n\n   *  the message does not include a Reconfigure Message option (see Section 21.19).\n\n   *  the Reconfigure Message option msg-type is not a valid value.\n\n   *  the message does not include authentication (such as RKAP; see Section 20.4) or fails authentication validation.\n\n\n16.12. Information-request Message\n\n   Clients MUST discard any received Information-request messages.\n\n   Servers MUST discard any received Information-request message that\n   meets any of the following conditions:\n\n   *  the message includes a Server Identifier option (see Section 21.3), and the DUID in the option does not match the\n      server's DUID.\n\n   *  the message includes an IA option. \n\n\n\n\n\n\n16.13. Relay-forward Message\n\n   Clients MUST discard any received Relay-forward messages.\n\n\n16.14. Relay-reply Message\n\n   Clients and servers MUST discard any received Relay-reply messages.\n\n\n17. Client Source Address and Interface Selection\n\n   The client's behavior regarding interface selection is different,\n   depending on the purpose of the configuration.\n\n17.1. Source Address and Interface Selection for Address Assignment\n\n   When a client sends a DHCP message to the\n   All_DHCP_Relay_Agents_and_Servers multicast address, it SHOULD send\n   the message through the interface for which configuration information\n   (including the addresses) is being requested.  However, the client\n   MAY send the message through another interface if the interface for\n   which configuration is being requested is a logical interface without\n   direct link attachment or the client is certain that two interfaces\n   are attached to the same link.\n\n\n17.2. Source Address and Interface Selection for Prefix Delegation\n\n   Delegated prefixes are not associated with a particular interface in\n   the same way as addresses are for address assignment as mentioned in Section 17.1 above.\n\n   When a client sends a DHCP message for the purpose of prefix\n   delegation, it SHOULD be sent on the interface associated with the\n   upstream router (typically, connected to an ISP network); see\n   [RFC7084].  The upstream interface is typically determined by\n   configuration.  This rule applies even in the case where a separate\n   IA_PD is used for each downstream interface.\n\n\n18. DHCP Configuration Exchanges\n\n   A client initiates a message exchange with a server or servers to\n   acquire or update configuration information of interest.  A client\n   has many reasons to initiate the configuration exchange.  Some of the\n   more common ones are:\n\n   1.  as part of the operating system configuration/bootstrap process,\n\n   2.  when requested to do so by the application layer (through an\n       operating-system-specific API),\n   3.  when a Router Advertisement indicates that DHCPv6 is available\n       for address configuration (see Section 4.2 of [RFC4861]),\n\n   4.  as required to extend the lifetime of address(es) and/or\n       delegated prefix(es), using Renew and Rebind messages, or\n\n   5.  upon the receipt of a Reconfigure message, when requested to do\n       so by a server.\n\n   The client is responsible for creating IAs and requesting that a\n   server assign addresses and/or delegated prefixes to the IAs.  The\n   client first creates the IAs and assigns IAIDs to them.  The client\n   then transmits a Solicit message containing the IA options describing\n   the IAs.  The client MUST NOT be using any of the addresses or\n   delegated prefixes for which it tries to obtain the bindings by\n   sending the Solicit message.  In particular, if the client had some\n   valid bindings and has chosen to start the server discovery process\n   to obtain the same bindings from a different server, the client MUST\n   stop using the addresses and delegated prefixes for the bindings that\n   it had obtained from the previous server (see Section 18.2.7 for more\n   details on what \"stop using\" means in this context) and that it is\n   now trying to obtain from a new server.\n\n   A DHCP client that does not need to have a DHCP server assign IP\n   addresses or delegated prefixes to it can obtain configuration\n   information such as a list of available DNS servers [RFC3646] or NTP\n   servers [RFC5908] through a single message and reply exchange with a\n   DHCP server.  To obtain configuration information, the client first\n   sends an Information-request message (see Section 18.2.6) to the\n   All_DHCP_Relay_Agents_and_Servers multicast address.  Servers respond\n   with a Reply message containing the configuration information for the\n   client (see Section 18.3.6).\n\n   To request the assignment of one or more addresses or delegated\n   prefixes, a client first locates a DHCP server and then requests the\n   assignment of addresses/prefixes and other configuration information\n   from the server.  The client does this by sending the Solicit message\n   (see Section 18.2.1) to the All_DHCP_Relay_Agents_and_Servers\n   multicast address and collecting Advertise messages from the servers\n   that respond to the client's message; the client then selects a\n   server from which it wants to obtain configuration information.  This\n   process is referred to as server discovery.  When the client has\n   selected the server, it sends a Request message to that server as\n   described in Section 18.2.2.\n\n   A client willing to perform the Solicit/Reply message exchange\n   described in Section 18.2.1 includes a Rapid Commit option (see Section 21.14) in its Solicit message. \n   Servers that can assign addresses or delegated prefixes to the IAs\n   respond to the client with an Advertise message or Reply message if\n   the client included a Rapid Commit option and the server is\n   configured to accept it.\n\n   If the server responds with an Advertise message, the client\n   initiates a configuration exchange as described in Section 18.2.2.\n\n   A server may initiate a message exchange with a client by sending a\n   Reconfigure message to cause the client to send a Renew, Rebind, or\n   Information-request message to refresh its configuration information\n   as soon as the Reconfigure message is received by the client.\n\n   Figure 9 shows a timeline diagram of the messages exchanged between a\n   client and two servers for the typical lifecycle of one or more\n   leases.  This starts with the four-message Solicit/Advertise/\n   Request/Reply exchange to obtain the lease(s), followed by a\n   two-message Renew/Reply exchange to extend the lifetime on the\n   lease(s), and then ends with a two-message Release/Reply exchange to\n   end the client's use of the lease(s).\n\n                Server                          Server\n            (not selected)      Client        (selected)\n\n                  v               v               v\n                  |               |               |\n                  |     Begins initialization     |\n                  |               |               |\n     start of     | _____________/|\\_____________ |\n     4-message    |/ Solicit      | Solicit      \\|\n     exchange     |               |               |\n              Determines          |          Determines\n             configuration        |         configuration\n                  |               |               |\n                  |\\              |  ____________/|\n                  | \\________     | /Advertise    |\n                  | Advertise\\    |/              |\n                  |           \\   |               |\n                  |      Collects Advertises      |\n                  |             \\ |               |\n                  |     Selects configuration     |\n                  |               |               |\n                  | _____________/|\\_____________ |\n                  |/ Request      |  Request     \\|\n                  |               |               |\n                  |               |     Commits configuration\n                  |               |               |\n     end of       |               | _____________/|\n     4-message    |               |/ Reply        |\n     exchange     |               |               |\n                  |    Initialization complete    |\n                  |               |               |\n                  .               .               .\n                  .               .               .\n                  |   T1 (renewal) timer expires  |\n                  |               |               |\n     2-message    | _____________/|\\_____________ |\n     exchange     |/ Renew        |  Renew       \\|\n                  |               |               |\n                  |               | Commits extended lease(s)\n                  |               |               |\n                  |               | _____________/|\n                  |               |/ Reply        |\n                  .               .               .\n                  .               .               .\n                  |               |               |\n                  |      Graceful shutdown        |\n                  |               |               |\n     2-message    | _____________/|\\_____________ |\n     exchange     |/ Release      |  Release     \\|\n                  |               |               |\n                  |               |         Discards lease(s)\n                  |               |               |\n                  |               | _____________/|\n                  |               |/ Reply        |\n                  |               |               |\n                  v               v               v\n\n       Figure 9: Timeline Diagram of the Messages Exchanged between a\n      Client and Two Servers for the Typical Lifecycle of One or More\n                                   Leases\n\n18.1. A Single Exchange for Multiple IA Options\n\n   This document assumes that a client SHOULD use a single transaction\n   for all of the IA options required on an interface; this simplifies\n   the client implementation and reduces the potential number of\n   transactions required.  To facilitate a client's use of a single\n   transaction for all IA options, servers MUST return the same T1/T2\n   values for all IA options in a Reply (see Sections 18.3.2, 18.3.4,\n   and 18.3.5) so that the client will generate a single transaction\n   when renewing or rebinding its leases.  However, because some servers\n   may not yet conform to this requirement, a client MUST be prepared to\n   select appropriate T1/T2 times as described in Section 18.2.4. \n\n\n\n\n\n\n18.2. Client Behavior\n\n   A client uses the Solicit message to discover DHCP servers configured\n   to assign leases or return other configuration parameters on the link\n   to which the client is attached.\n\n   A client uses Request, Renew, Rebind, Release, and Decline messages\n   during the normal lifecycle of addresses and delegated prefixes.\n   When a client detects that it may have moved to a new link, it uses\n   Confirm if it only has addresses and Rebind if it has delegated\n   prefixes (and addresses).  It uses Information-request messages when\n   it needs configuration information but no addresses and no prefixes.\n\n   When a client requests multiple IA option types or multiple instances\n   of the same IA types in a Solicit, Request, Renew, or Rebind, it is\n   possible that the available server(s) may only be configured to offer\n   a subset of them.  When possible, the client SHOULD use the best\n   configuration available and continue to request the additional IAs in\n   subsequent messages.  This allows the client to maintain a single\n   session and state machine.  In practice, especially in the case of\n   handling IA_NA and IA_PD requests [RFC7084], this situation should be\n   rare or a result of a temporary operational error.  Thus, it is more\n   likely that the client will get all configuration if it continues, in\n   each subsequent configuration exchange, to request all the\n   configuration information it is programmed to try to obtain,\n   including any stateful configuration options for which no results\n   were returned in previous message exchanges.\n\n   Upon receipt of a Reconfigure message from the server, a client\n   responds with a Renew, Rebind, or Information-request message as\n   indicated by the Reconfigure Message option (see Section 21.19).  The\n   client SHOULD be suspicious of the Reconfigure message (they may be\n   faked), and it MUST NOT abandon any resources it might have already\n   obtained.  The client SHOULD treat the Reconfigure message as if the\n   T1 timer had expired.  The client will expect the server to send IAs\n   and/or other configuration information to the client in a Reply\n   message.\n\n18.2.1. Creation and Transmission of Solicit Messages\n\n   The client sets the \"msg-type\" field to SOLICIT.  The client\n   generates a transaction ID and inserts this value in the\n   \"transaction-id\" field.\n\n   The client MUST include a Client Identifier option (see Section 21.2)\n   to identify itself to the server.  The client includes IA options for\n   any IAs to which it wants the server to assign leases. \n   The client MUST include an Elapsed Time option (see Section 21.9) to\n   indicate how long the client has been trying to complete the current\n   DHCP message exchange.\n\n   The client uses IA_NA options (see Section 21.4) to request the\n   assignment of non-temporary addresses and IA_PD options (see Section 21.21) to request prefix delegation.  IA_NA or IA_PD options,\n   or a combination, can be included in DHCP messages.  In addition,\n   multiple instances of any IA option type can be included.\n\n   The client MAY include addresses in IA Address options (see Section 21.6) encapsulated within IA_NA option as hints to the server\n   about the addresses for which the client has a preference.\n\n   The client MAY include values in IA Prefix options (see Section 21.22) encapsulated within IA_PD options as hints for the\n   delegated prefix and/or prefix length for which the client has a\n   preference.  See Section 18.2.4 for more on prefix-length hints.\n\n   The client MUST include an Option Request option (ORO) (see Section 21.7) to request the SOL_MAX_RT option (see Section 21.24)\n   and any other options the client is interested in receiving.  The\n   client MAY additionally include instances of those options that are\n   identified in the Option Request option, with data values as hints to\n   the server about parameter values the client would like to have\n   returned.\n\n   The client includes a Reconfigure Accept option (see Section 21.20)\n   if the client is willing to accept Reconfigure messages from the\n   server.\n\n   The client MUST NOT include any other options in the Solicit message,\n   except as specifically allowed in the definition of individual\n   options.\n\n   The first Solicit message from the client on the interface SHOULD be\n   delayed by a random amount of time between 0 and SOL_MAX_DELAY.  This\n   random delay helps desynchronize clients that start a DHCP session at\n   the same time, such as after recovery from a power failure or after a\n   router outage after seeing that DHCP is available in Router\n   Advertisement messages (see Section 4.2 of [RFC4861]).\n\n   The client transmits the message according to Section 15, using the\n   following parameters:\n\n   IRT        SOL_TIMEOUT\n\n   MRT        SOL_MAX_RT \n   MRC        0\n\n   MRD        0\n\n   A client that wishes to use the Rapid Commit two-message exchange\n   includes a Rapid Commit option (see Section 21.14) in its Solicit\n   message.  The client may receive a number of different replies from\n   different servers.  The client will make note of any valid Advertise\n   messages that it receives.  The client will discard any Reply\n   messages that do not contain the Rapid Commit option.\n\n   Upon receipt of a valid Reply with the Rapid Commit option, the\n   client processes the message as described in Section 18.2.10.\n\n   At the end of the first RT period, if no suitable Reply messages are\n   received but the client has valid Advertise messages, then the client\n   processes the Advertise as described in Section 18.2.9.\n\n   If the client subsequently receives a valid Reply message that\n   includes a Rapid Commit option, it does one of the following:\n\n   *  processes the Reply message as described in Section 18.2.10 and\n      discards any Reply messages received in response to the Request\n      message\n\n   *  processes any Reply messages received in response to the Request\n      message and discards the Reply message that includes the Rapid\n      Commit option\n\n   If the client is waiting for an Advertise message, the mechanism\n   described in Section 15 is modified as follows for use in the\n   transmission of Solicit messages.  The message exchange is not\n   terminated by the receipt of an Advertise before the first RT has\n   elapsed.  Rather, the client collects valid Advertise messages until\n   the first RT has elapsed.  Also, the first RT MUST be selected to be\n   strictly greater than IRT by choosing RAND to be strictly greater\n   than 0.\n\n   A client MUST collect valid Advertise messages for the first\n   RT seconds, unless it receives a valid Advertise message with a\n   preference value of 255.  The preference value is carried in the\n   Preference option (see Section 21.8).  Any valid Advertise that does\n   not include a Preference option is considered to have a preference\n   value of 0.  If the client receives a valid Advertise message that\n   includes a Preference option with a preference value of 255, the\n   client immediately begins a client-initiated message exchange (as\n   described in Section 18.2.2) by sending a Request message to the\n   server from which the Advertise message was received.  If the client \n   receives a valid Advertise message that does not include a Preference\n   option with a preference value of 255, the client continues to wait\n   until the first RT elapses.  If the first RT elapses and the client\n   has received a valid Advertise message, the client SHOULD continue\n   with a client-initiated message exchange by sending a Request\n   message.\n\n   If the client does not receive any valid Advertise messages before\n   the first RT has elapsed, it then applies the retransmission\n   mechanism described in Section 15.  The client terminates the\n   retransmission process as soon as it receives any valid Advertise\n   message, and the client acts on the received Advertise message\n   without waiting for any additional Advertise messages.\n\n   A DHCP client SHOULD choose MRC and MRD values of 0.  If the DHCP\n   client is configured with either MRC or MRD set to a value other than\n   0, it MUST stop trying to configure the interface if the message\n   exchange fails.  After the DHCP client stops trying to configure the\n   interface, it SHOULD restart the reconfiguration process after some\n   external event, such as user input, system restart, or when the\n   client is attached to a new link.\n\n\n18.2.2. Creation and Transmission of Request Messages\n\n   The client uses a Request message to populate IAs with leases and\n   obtain other configuration information.  The client includes one or\n   more IA options in the Request message.  The server then returns\n   leases and other information about the IAs to the client in IA\n   options in a Reply message.\n\n   The client sets the \"msg-type\" field to REQUEST.  The client\n   generates a transaction ID and inserts this value in the\n   \"transaction-id\" field.\n\n   The client MUST include the identifier of the destination server in a\n   Server Identifier option (see Section 21.3).\n\n   The client MUST include a Client Identifier option (see Section 21.2)\n   to identify itself to the server.  The client adds any other\n   appropriate options, including one or more IA options.\n\n   The client MUST include an Elapsed Time option (see Section 21.9) to\n   indicate how long the client has been trying to complete the current\n   DHCP message exchange.\n\n   The client MUST include an Option Request option (see Section 21.7)\n   to request the SOL_MAX_RT option (see Section 21.24) and any other\n   options the client is interested in receiving.  The client MAY \n   additionally include instances of those options that are identified\n   in the Option Request option, with data values as hints to the server\n   about parameter values the client would like to have returned.\n\n   The client includes a Reconfigure Accept option (see Section 21.20)\n   if the client is willing to accept Reconfigure messages from the\n   server.\n\n   The client transmits the message according to Section 15, using the\n   following parameters:\n\n   IRT        REQ_TIMEOUT\n\n   MRT        REQ_MAX_RT\n\n   MRC        REQ_MAX_RC\n\n   MRD        0\n\n   If the message exchange fails, the client takes an action based on\n   the client's local policy.  Examples of actions the client might take\n   include the following:\n\n   *  Select another server from a list of servers known to the client\n      -- for example, servers that responded with an Advertise message.\n\n   *  Initiate the server discovery process described in Section 18.\n\n   *  Terminate the configuration process and report failure.\n\n\n18.2.3. Creation and Transmission of Confirm Messages\n\n   The client uses a Confirm message when it has only addresses (no\n   delegated prefixes) assigned by a DHCP server to determine if it is\n   still connected to the same link when the client detects a change in\n   network information as described in Section 18.2.12.\n\n   The client sets the \"msg-type\" field to CONFIRM.  The client\n   generates a transaction ID and inserts this value in the\n   \"transaction-id\" field.\n\n   The client MUST include a Client Identifier option (see Section 21.2)\n   to identify itself to the server.\n\n   The client MUST include an Elapsed Time option (see Section 21.9) to\n   indicate how long the client has been trying to complete the current\n   DHCP message exchange. \n   The client includes IA options for all of the IAs assigned to the\n   interface for which the Confirm message is being sent.  The IA\n   options include all of the addresses the client currently has\n   associated with those IAs.  The client SHOULD set the T1 and T2\n   fields in any IA_NA options (see Section 21.4) and the\n   preferred-lifetime and valid-lifetime fields in the IA Address\n   options (see Section 21.6) to 0, as the server will ignore these\n   fields.\n\n   The first Confirm message from the client on the interface MUST be\n   delayed by a random amount of time between 0 and CNF_MAX_DELAY.  The\n   client transmits the message according to Section 15, using the\n   following parameters:\n\n   IRT        CNF_TIMEOUT\n\n   MRT        CNF_MAX_RT\n\n   MRC        0\n\n   MRD        CNF_MAX_RD\n\n   If the client receives no responses before the message transmission\n   process terminates, as described in Section 15, the client SHOULD\n   continue to use any leases, using the last known lifetimes for those\n   leases, and SHOULD continue to use any other previously obtained\n   configuration parameters.\n\n\n18.2.4. Creation and Transmission of Renew Messages\n\n   To extend the preferred and valid lifetimes for the leases assigned\n   to the IAs and obtain new addresses or delegated prefixes for IAs,\n   the client sends a Renew message to the server from which the leases\n   were obtained; the Renew message includes IA options for the IAs\n   whose lease lifetimes are to be extended.  The client includes IA\n   Address options (see Section 21.6) within IA_NA (see Section 21.4)\n   options for the addresses assigned to the IAs.  The client includes\n   IA Prefix options (see Section 21.22) within IA_PD options (see Section 21.21) for the delegated prefixes assigned to the IAs.\n\n   The server controls the time at which the client should contact the\n   server to extend the lifetimes on assigned leases through the T1 and\n   T2 values assigned to an IA.  However, as the client SHOULD\n   renew/rebind all IAs from the server at the same time, the client\n   MUST select T1 and T2 times from all IA options that will guarantee\n   that the client initiates transmissions of Renew/Rebind messages not\n   later than at the T1/T2 times associated with any of the client's\n   bindings (earliest T1/T2). \n   At time T1, the client initiates a Renew/Reply message exchange to\n   extend the lifetimes on any leases in the IA.\n\n   A client MUST also initiate a Renew/Reply message exchange before\n   time T1 if the client's link-local address used in previous\n   interactions with the server is no longer valid and it is willing to\n   receive Reconfigure messages.  This updates the server's information\n   so it is able to continue to communicate with the client (either\n   directly or via Relay-reply's).\n\n   If T1 or T2 had been set to 0 by the server (for an IA_NA or IA_PD)\n   in a previous Reply, the client may, at its discretion, send a Renew\n   or Rebind message, respectively.  The client MUST follow the rules\n   defined in Section 14.2.\n\n   The client sets the \"msg-type\" field to RENEW.  The client generates\n   a transaction ID and inserts this value in the \"transaction-id\"\n   field.\n\n   The client MUST include a Server Identifier option (see Section 21.3)\n   in the Renew message, identifying the server with which the client\n   most recently communicated.\n\n   The client MUST include a Client Identifier option (see Section 21.2)\n   to identify itself to the server.  The client adds any appropriate\n   options, including one or more IA options.\n\n   The client MUST include an Elapsed Time option (see Section 21.9) to\n   indicate how long the client has been trying to complete the current\n   DHCP message exchange.\n\n   For IAs to which leases have been assigned, the client includes a\n   corresponding IA option containing an IA Address option for each\n   address assigned to the IA and an IA Prefix option for each prefix\n   assigned to the IA.  The client MUST NOT include addresses and\n   prefixes in any IA option that the client did not obtain from the\n   server or that are no longer valid (that have a valid lifetime of 0).\n\n   The client MAY include an IA option for each binding it desires but\n   has been unable to obtain.  In this case, if the client includes the\n   IA_PD option to request prefix delegation, the client MAY include the\n   IA Prefix option encapsulated within the IA_PD option, with the\n   \"IPv6-prefix\" field set to 0 and the \"prefix-length\" field set to the\n   desired length of the prefix to be delegated.  The server MAY use\n   this value as a hint for the prefix length.  The client SHOULD NOT\n   include an IA Prefix option with the \"IPv6-prefix\" field set to 0\n   unless it is supplying a hint for the prefix length. \n   The client includes an Option Request option (see Section 21.7) to\n   request the SOL_MAX_RT option (see Section 21.24) and any other\n   options the client is interested in receiving.  The client MAY\n   include options with data values as hints to the server about\n   parameter values the client would like to have returned.\n\n   The client transmits the message according to Section 15, using the\n   following parameters:\n\n   IRT        REN_TIMEOUT\n\n   MRT        REN_MAX_RT\n\n   MRC        0\n\n   MRD        Remaining time until earliest T2\n\n   The message exchange is terminated when the earliest time T2 is\n   reached.  While the client is responding to a Reconfigure, the client\n   ignores and discards any additional Reconfigure messages it may\n   receive.\n\n   The message exchange is terminated when the earliest time T2 is\n   reached, at which point the client begins the Rebind message exchange\n   (see Section 18.2.5).\n\n\n18.2.5. Creation and Transmission of Rebind Messages\n\n   At time T2 (which will only be reached if the server to which the\n   Renew message was sent starting at time T1 has not responded), the\n   client initiates a Rebind/Reply message exchange with any available\n   server.\n\n   A Rebind is also used to verify delegated prefix bindings but with\n   different retransmission parameters as described in Section 18.2.3.\n\n   The client constructs the Rebind message as described in Section 18.2.4, with the following differences:\n\n   *  The client sets the \"msg-type\" field to REBIND.\n\n   *  The client does not include the Server Identifier option (see Section 21.3) in the Rebind message.\n\n   The client transmits the message according to Section 15, using the\n   following parameters:\n\n   IRT        REB_TIMEOUT \n   MRT        REB_MAX_RT\n\n   MRC        0\n\n   MRD        Remaining time until valid lifetimes of all leases in all\n              IAs have expired\n\n   If all leases for an IA have expired, the client may choose to\n   include this IA in subsequent Rebind messages to indicate that the\n   client is interested in assignment of the leases to this IA.\n\n   The message exchange is terminated when the valid lifetimes of all\n   leases across all IAs have expired, at which time the client uses the\n   Solicit message to locate a new DHCP server and sends a Request for\n   the expired IAs to the new server.  If the terminated Rebind exchange\n   was initiated as a result of receiving a Reconfigure message, the\n   client terminates the reconfigure process and resumes as if the\n   Reconfigure message had not been received.\n\n\n18.2.6. Creation and Transmission of Information-request Messages\n\n   The client uses an Information-request message to obtain\n   configuration information without requesting addresses and/or\n   delegated prefixes to be assigned.\n\n   The client sets the \"msg-type\" field to INFORMATION-REQUEST.  The\n   client generates a transaction ID and inserts this value in the\n   \"transaction-id\" field.\n\n   The client SHOULD include a Client Identifier option (see Section 21.2) to identify itself to the server (however, see Section 4.3.1 of [RFC7844] for reasons why a client may not want to\n   include this option).  If the client does not include a Client\n   Identifier option, the server will not be able to return any\n   client-specific options to the client, or the server may choose not\n   to respond to the message at all.\n\n   The client MUST include an Elapsed Time option (see Section 21.9) to\n   indicate how long the client has been trying to complete the current\n   DHCP message exchange.\n\n   The client MUST include an Option Request option (see Section 21.7)\n   to request the INF_MAX_RT option (see Section 21.25), the Information\n   Refresh Time option (see Section 21.23), and any other options the\n   client is interested in receiving.  The client MAY include options\n   with data values as hints to the server about parameter values the\n   client would like to have returned. \n   When responding to a Reconfigure, the client MUST include a Server\n   Identifier option (see Section 21.3) with the identifier from the\n   Reconfigure message to which the client is responding.\n\n   The first Information-request message from the client on the\n   interface MUST be delayed by a random amount of time between 0 and\n   INF_MAX_DELAY.  The client transmits the message according to Section 15, using the following parameters:\n\n   IRT        INF_TIMEOUT\n\n   MRT        INF_MAX_RT\n\n   MRC        0\n\n   MRD        0\n\n\n18.2.7. Creation and Transmission of Release Messages\n\n   To release one or more leases, a client sends a Release message to\n   the server.\n\n   The client sets the \"msg-type\" field to RELEASE.  The client\n   generates a transaction ID and places this value in the\n   \"transaction-id\" field.\n\n   The client MUST include a Server Identifier option (see Section 21.3)\n   in the Renew message, identifying the server which allocated the\n   lease(s).\n\n   The client MUST include a Client Identifier option (see Section 21.2)\n   to identify itself to the server.\n\n   The client MUST include an Elapsed Time option (see Section 21.9) to\n   indicate how long the client has been trying to complete the current\n   DHCP message exchange.\n\n   The client includes options containing the IAs for the leases it is\n   releasing in the \"options\" field.  The leases to be released MUST be\n   included in the IAs.  Any leases for the IAs the client wishes to\n   continue to use MUST NOT be added to the IAs. \n   The client MUST stop using all of the leases being released before\n   the client begins the Release message exchange process.  For an\n   address, this means the address MUST have been removed from the\n   interface.  For a delegated prefix, this means the prefix MUST have\n   been advertised with a Preferred Lifetime and a Valid Lifetime of 0\n   in a Router Advertisement message as described in part (e) of Section 5.5.3 of [RFC4862]; also see requirement L-13 in Section 4.3\n   of [RFC7084].\n\n   The client MUST NOT use any of the addresses it is releasing as the\n   source address in the Release message or in any subsequently\n   transmitted message.\n\n   Because Release messages may be lost, the client should retransmit\n   the Release if no Reply is received.  However, there are scenarios\n   where the client may not wish to wait for the normal retransmission\n   timeout before giving up (e.g., on power down).  Implementations\n   SHOULD retransmit one or more times but MAY choose to terminate the\n   retransmission procedure early.\n\n   The client transmits the message according to Section 15, using the\n   following parameters:\n\n   IRT        REL_TIMEOUT\n\n   MRT        0\n\n   MRC        REL_MAX_RC\n\n   MRD        0\n\n   If leases are released but the Reply from a DHCP server is lost, the\n   client will retransmit the Release message, and the server may\n   respond with a Reply indicating a status of NoBinding.  Therefore,\n   the client does not treat a Reply message with a status of NoBinding\n   in a Release message exchange as if it indicates an error.\n\n   Note that if the client fails to release the lease, each lease\n   assigned to the IA will be reclaimed by the server when the valid\n   lifetime of that lease expires.\n\n\n18.2.8. Creation and Transmission of Decline Messages\n\n   If a client detects that one or more addresses assigned to it by a\n   server are already in use by another node, the client sends a Decline\n   message to the server to inform it that the address is suspect. \n   The Decline message is not used in prefix delegation; thus, the\n   client MUST NOT include IA_PD options (see Section 21.21) in the\n   Decline message.\n\n   The client sets the \"msg-type\" field to DECLINE.  The client\n   generates a transaction ID and places this value in the\n   \"transaction-id\" field.\n\n   The client MUST include a Server Identifier option (see Section 21.3)\n   in the Decline message, identifying the server which allocated the\n   lease(s).\n\n   The client MUST include a Client Identifier option (see Section 21.2)\n   to identify itself to the server.\n\n   The client MUST include an Elapsed Time option (see Section 21.9) to\n   indicate how long the client has been trying to complete the current\n   DHCP message exchange.\n\n   The client includes options containing the IAs for the addresses it\n   is declining in the \"options\" field.  The addresses to be declined\n   MUST be included in the IAs.  Any addresses for the IAs the client\n   wishes to continue to use should not be added to the IAs.\n\n   The client MUST NOT use any of the addresses it is declining as the\n   source address in the Decline message or in any subsequently\n   transmitted message.\n\n   The client transmits the message according to Section 15, using the\n   following parameters:\n\n   IRT        DEC_TIMEOUT\n\n   MRT        0\n\n   MRC        DEC_MAX_RC\n\n   MRD        0\n\n   If addresses are declined but the Reply from a DHCP server is lost,\n   the client will retransmit the Decline message, and the server may\n   respond with a Reply indicating a status of NoBinding.  Therefore,\n   the client does not treat a Reply message with a status of NoBinding\n   in a Decline message exchange as if it indicates an error.\n\n   The client SHOULD NOT send a Release message for other bindings it\n   may have received just because it sent a Decline message.  The client\n   SHOULD retain the non-conflicting bindings.  The client SHOULD treat \n   the failure to acquire a binding (due to the conflict) as equivalent\n   to not having received the binding, insofar as how it behaves when\n   sending Renew and Rebind messages.\n\n\n18.2.9. Receipt of Advertise Messages\n\n   Upon receipt of one or more valid Advertise messages, the client\n   selects one or more Advertise messages based upon the following\n   criteria.\n\n   *  Those Advertise messages with the highest server preference value\n      SHOULD be preferred over all other Advertise messages.  The client\n      MAY choose a less preferred server if that server has a better set\n      of advertised parameters, such as the available set of IAs, as\n      well as the set of other configuration options advertised.\n\n   *  Within a group of Advertise messages with the same server\n      preference value, a client MAY select those servers whose\n      Advertise messages advertise information of interest to the\n      client.\n\n   Once a client has selected Advertise message(s), the client will\n   typically store information about each server, such as the server\n   preference value, addresses advertised, when the advertisement was\n   received, and so on.\n\n   In practice, this means that the client will maintain independent\n   per-IA state machines for each selected server.\n\n   If the client needs to select an alternate server in the case that a\n   chosen server does not respond, the client chooses the next server\n   according to the criteria given above.\n\n   The client MUST process any SOL_MAX_RT option (see Section 21.24) and\n   INF_MAX_RT option (see Section 21.25) present in an Advertise\n   message, even if the message contains a Status Code option (see Section 21.13) indicating a failure, and the Advertise message will\n   be discarded by the client.  A client SHOULD only update its\n   SOL_MAX_RT and INF_MAX_RT values if all received Advertise messages\n   that contained the corresponding option specified the same value;\n   otherwise, it should use the default value (see Section 7.6).\n\n   The client MUST ignore any Advertise message that contains no\n   addresses (IA Address options (see Section 21.6) encapsulated in\n   IA_NA options (see Section 21.4)) and no delegated prefixes (IA\n   Prefix options (see Section 21.22) encapsulated in IA_PD options (see Section 21.21)), with the exception that the client:\n   *  MUST process an included SOL_MAX_RT option and\n\n   *  MUST process an included INF_MAX_RT option.\n\n   A client can record in an activity log or display to the user any\n   associated status message(s).\n\n   The client ignoring an Advertise message MUST NOT restart the Solicit\n   retransmission timer.\n\n\n18.2.10. Receipt of Reply Messages\n\n   Upon the receipt of a valid Reply message in response to a Solicit\n   with a Rapid Commit option (see Section 21.14), Request, Confirm,\n   Renew, Rebind, or Information-request message, the client extracts\n   the top-level Status Code option (see Section 21.13) if present.\n\n   The client MUST process any SOL_MAX_RT option (see Section 21.24) and\n   INF_MAX_RT option (see Section 21.25) present in a Reply message,\n   even if the message contains a Status Code option indicating a\n   failure.\n\n   If the client receives a Reply message with a status code of\n   UnspecFail, the server is indicating that it was unable to process\n   the client's message due to an unspecified failure condition.  If the\n   client retransmits the original message to the same server to retry\n   the desired operation, the client MUST limit the rate at which it\n   retransmits the message and limit the duration of the time during\n   which it retransmits the message (see Section 14.1).\n\n   Otherwise (no status code or another status code), the client\n   processes the Reply as described below based on the original message\n   for which the Reply was received.\n\n   The client MAY choose to report any status code or message from the\n   Status Code option in the Reply message.\n\n   The topic of revoking previously assigned options is discussed in Section 18.2.10.5.\n\n   When a client receives a requested option that has an updated value\n   from what was previously received, the client SHOULD make use of that\n   updated value as soon as possible for its configuration information. \n\n\n\n\n\n18.2.10.1. Reply for Solicit (with Rapid Commit), Request, Renew, or\n\n\n            Rebind    If the client receives a NotOnLink status from the server in response\n   to a Solicit (with a Rapid Commit option; see Section 21.14) or a\n   Request, the client can either reissue the message without specifying\n   any addresses or restart the DHCP server discovery process (see Section 18 or Section 18.2.13).\n\n   If the Reply was received in response to a Solicit (with a Rapid\n   Commit option), Request, Renew, or Rebind message, the client updates\n   the information it has recorded about IAs from the IA options\n   contained in the Reply message:\n\n   *  Calculate T1 and T2 times (based on T1 and T2 values sent in the\n      message and the message reception time), if appropriate for the IA\n      type.\n\n   *  Add any new leases in the IA option to the IA as recorded by the\n      client.\n\n   *  Update lifetimes for any leases in the IA option that the client\n      already has recorded in the IA.\n\n   *  Discard any leases from the IA, as recorded by the client, that\n      have a valid lifetime of 0 in the IA Address or IA Prefix option.\n\n   *  Leave unchanged any information about leases the client has\n      recorded in the IA but that were not included in the IA from the\n      server.\n\n   If the client can operate with the addresses and/or prefixes obtained\n   from the server:\n\n   *  The client uses the addresses, delegated prefixes, and other\n      information from any IAs that do not contain a Status Code option\n      with the NoAddrsAvail or NoPrefixAvail status code.  The client\n      MAY include the IAs for which it received the NoAddrsAvail or\n      NoPrefixAvail status code, with no addresses or prefixes, in\n      subsequent Renew and Rebind messages sent to the server, to retry\n      obtaining the addresses or prefixes for these IAs.\n\n   *  The client MUST perform duplicate address detection as per Section 5.4 of [RFC4862], which does list some exceptions, on each\n      of the received addresses in any IAs on which it has not performed\n      duplicate address detection during processing of any of the\n      previous Reply messages from the server.  The client performs the\n      duplicate address detection before using the received addresses \n      for any traffic.  If any of the addresses are found to be in use\n      on the link, the client sends a Decline message to the server for\n      those addresses as described in Section 18.2.8.\n\n   *  For each assigned address that does not have any associated\n      reachability information (see the definition of \"on-link\" in Section 2.1 of [RFC4861]), in order to avoid the problems\n      described in [RFC4943], the client MUST NOT assume that any\n      addresses are reachable on-link as a result of receiving an IA\n      Address option (see Section 21.6).  Addresses obtained from an IA\n      Address option MUST NOT be used to form an implicit prefix with a\n      length other than 128.\n\n   *  For each delegated prefix, the client assigns a subnet to each of\n      the links to which the associated interfaces are attached.\n\n      When a client subnets a delegated prefix, it must assign\n      additional bits to the prefix to generate unique, longer prefixes.\n      For example, if the client in Figure 1 were delegated\n      2001:db8:0::/48, it might generate 2001:db8:0:1::/64 and\n      2001:db8:0:2::/64 for assignment to the two links in the\n      subscriber network.  If the client were delegated 2001:db8:0::/48\n      and 2001:db8:5::/48, it might assign 2001:db8:0:1::/64 and\n      2001:db8:5:1::/64 to one of the links, and 2001:db8:0:2::/64 and\n      2001:db8:5:2::/64 for assignment to the other link.\n\n      If the client uses a delegated prefix to configure addresses on\n      interfaces on itself or other nodes behind it, the preferred and\n      valid lifetimes of those addresses MUST be no longer than the\n      remaining preferred and valid lifetimes, respectively, for the\n      delegated prefix at any time.  In particular, if the delegated\n      prefix or a prefix derived from it is advertised for stateless\n      address autoconfiguration [RFC4862], the advertised preferred and\n      valid lifetimes MUST NOT exceed the corresponding remaining\n      lifetimes of the delegated prefix.\n\n   Management of the specific configuration information is detailed in\n   the definition of each option in Section 21.\n\n   If the Reply message contains any IAs but the client finds no usable\n   addresses and/or delegated prefixes in any of these IAs, the client\n   may either try another server (perhaps restarting the DHCP server\n   discovery process) or use the Information-request message to obtain\n   other configuration information only.\n\n   When the client receives a Reply message in response to a Renew or\n   Rebind message, the client:\n   *  Sends a Request message to the server that responded if any of the\n      IAs in the Reply message contain the NoBinding status code.  The\n      client places IA options in this message for all IAs.  The client\n      continues to use other bindings for which the server did not\n      return an error.\n\n   *  Sends a Renew/Rebind if any of the IAs are not in the Reply\n      message, but as this likely indicates that the server that\n      responded does not support that IA type, sending immediately is\n      unlikely to produce a different result.  Therefore, the client\n      MUST rate-limit its transmissions (see Section 14.1) and MAY just\n      wait for the normal retransmission time (as if the Reply message\n      had not been received).  The client continues to use other\n      bindings for which the server did return information.\n\n   *  Otherwise accepts the information in the IA.\n\n\n18.2.10.2. Reply for Release and Decline\n\n   When the client receives a valid Reply message in response to a\n   Release message, the client considers the Release event completed,\n   regardless of the Status Code option (see Section 21.13) returned by\n   the server.\n\n   When the client receives a valid Reply message in response to a\n   Decline message, the client considers the Decline event completed,\n   regardless of the Status Code option(s) returned by the server.\n\n\n18.2.10.3. Reply for Confirm\n\n   If the client receives any Reply messages that indicate a status of\n   Success (explicit or implicit), the client can use the addresses in\n   the IA and ignore any messages that indicate a NotOnLink status.\n   When the client only receives one or more Reply messages with the\n   NotOnLink status in response to a Confirm message, the client\n   performs DHCP server discovery as described in Section 18.\n\n\n18.2.10.4. Reply for Information-request\n\n   Refer to Section 21.23 for details on how the Information Refresh\n   Time option (whether or not present in the Reply) should be handled\n   by the client. \n\n\n\n\n\n\n18.2.10.5. Revoking Previously Provided Options\n\n   When a client received a configuration option in an earlier Reply and\n   then sends a Renew, Rebind, or Information-request and the requested\n   option is not present in the Reply, the client SHOULD stop using the\n   previously received configuration information.  In other words, the\n   client should behave as if it never received this configuration\n   option and return to the relevant default state.  If there is no\n   viable way to stop using the received configuration information, the\n   values received/configured from the option MAY persist if there are\n   no other sources for that data and they have no external impact.  For\n   example, a client that previously received a Client FQDN option (see\n   [RFC4704]) and used it to set up its hostname is allowed to continue\n   using it if there is no reasonable way for a node to unset its\n   hostname and it has no external impact.  As a counter-example, a\n   client that previously received an NTP server address from the DHCP\n   server and does not receive it anymore MUST stop using the configured\n   NTP server address.  The client SHOULD be open to other sources of\n   the same configuration information.  This behavior does not apply to\n   any IA options, as their processing is described in Section 18.2.10.1\n\n\n\n\n\n18.2.11. Receipt of Reconfigure Messages\n\n   A client receives Reconfigure messages sent to UDP port 546 on\n   interfaces for which it has acquired configuration information\n   through DHCP.  These messages may be sent at any time.  Since the\n   results of a reconfiguration event may affect application-layer\n   programs, the client SHOULD log these events and MAY notify these\n   programs of the change through an implementation-specific interface.\n\n   The message MUST be dropped if it doesn't pass the validation, as\n   explained in (see Section 16.11), in particular in case the\n   authentication is missing or fails.\n\n   Upon receipt of a valid Reconfigure message, the client responds with\n   a Renew message, a Rebind message, or an Information-request message\n   as indicated by the Reconfigure Message option (see Section 21.19).\n   The client ignores the \"transaction-id\" field in the received\n   Reconfigure message.  While the transaction is in progress, the\n   client discards any Reconfigure messages it receives.\n\n   The Reconfigure message acts as a trigger that signals the client to\n   complete a successful message exchange.  Once the client has received\n   a Reconfigure, the client proceeds with the message exchange\n   (retransmitting the Renew, Rebind, or Information-request message if\n   necessary); the client MUST ignore any additional Reconfigure\n   messages until the exchange is complete. \n   Duplicate messages will be ignored because the client will begin the\n   exchange after the receipt of the first Reconfigure.  Retransmitted\n   messages will either (1) trigger the exchange (if the first\n   Reconfigure was not received by the client) or (2) be ignored.  The\n   server MAY discontinue retransmission of Reconfigure messages to the\n   client once the server receives the Renew, Rebind, or\n   Information-request message from the client.\n\n   It might be possible for a duplicate or retransmitted Reconfigure to\n   be sufficiently delayed (and delivered out of order) that it arrives\n   at the client after the exchange (initiated by the original\n   Reconfigure) has been completed.  In this case, the client would\n   initiate a redundant exchange.  The likelihood of delayed and\n   out-of-order delivery is small enough to be ignored.  The consequence\n   of the redundant exchange is inefficiency rather than incorrect\n   operation.\n\n\n18.2.12. Refreshing Configuration Information\n\n   Whenever a client may have moved to a new link, the\n   prefixes/addresses assigned to the interfaces on that link may no\n   longer be appropriate for the link to which the client is attached.\n   Examples of times when a client may have moved to a new link include\n   the following:\n\n   *  The client reboots (and has stable storage and persistent DHCP\n      state).\n\n   *  The client is reconnected to a link on which it has obtained\n      leases.\n\n   *  The client returns from sleep mode.\n\n   *  The client changes access points (e.g., if using Wi-Fi\n      technology).\n\n   *  The client's network interface indicates a disconnection event,\n      followed by a connection event.\n\n   Specific algorithms for detecting network attachment changes are out\n   of scope for this document.  Two possible mechanisms for detecting\n   situations where refreshing configuration information may be needed\n   are defined in [RFC6059] and [RFC4957].\n\n   When the client detects that it may have moved to a new link and it\n   has obtained addresses and no delegated prefixes from a server, the\n   client SHOULD initiate a Confirm/Reply message exchange.  The client\n   MUST include any IAs assigned to the interface that may have moved to \n   a new link, along with the addresses associated with those IAs, in\n   its Confirm message.  Any responding servers will indicate whether\n   those addresses are appropriate for the link to which the client is\n   attached with the status in the Reply message it returns to the\n   client.\n\n   If the client has any valid delegated prefixes obtained from the DHCP\n   server, the client MUST initiate a Rebind/Reply message exchange as\n   described in Section 18.2.5, with the exception that the\n   retransmission parameters should be set as for the Confirm message\n   (see Section 18.2.3).  The client includes IA_NAs and IA_PDs, along\n   with the associated leases, in its Rebind message.\n\n   If the client has only obtained network information using\n   Information-request/Reply message exchanges, the client MUST initiate\n   an Information-request/Reply message exchange as described in Section 18.2.6.\n\n   If not associated with a detection of having moved to a new link, a\n   client SHOULD initiate one of the Renew/Reply, Confirm/Reply or\n   Information-request/Reply exchanges, if the client detects a\n   significant change regarding the prefixes available on the link.  A\n   change is considered significant when one or more on-link prefixes\n   are added, and/or one or more existing on-link prefixes are\n   deprecated.  The reason for this is that such a significant change\n   may indicate a configuration change at the server.  However, a client\n   MUST rate-limit such initiation attempts to avoid flooding a server\n   with requests when there are link issues (for example, only doing one\n   of these at most every 30 seconds).\n\n   The above selection of an exchange to initiate depends on the\n   client's current state:\n\n   *  If the client has any valid delegated prefixes obtained from the\n      server, it sends Renew (as if the T1 time expired) as described in Section 18.2.4.\n\n   *  Else, if the client obtained address(es) from the server, it sends\n      Confirm as described in Section 18.2.3.\n\n   *  Else, if only network information was obtained from the server, it\n      sends Information-request as described in Section 18.2.6\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n18.2.13. Restarting Server Discovery Process\n\n   Whenever a client restarts the DHCP server discovery process or\n   selects an alternate server as described in Section 18.2.9, the\n   client SHOULD stop using any addresses and delegated prefixes for\n   which it has bindings (see Section 18.2.7) and if possible, any\n   previously received other configuration information, and try to\n   obtain new bindings and other configuration information from a \"new\"\n   server for the same interface.  This facilitates the client using a\n   single state machine for all bindings.\n\n\n\n18.3. Server Behavior\n\n   For this discussion, the server is assumed to have been configured in\n   an implementation-specific manner with configurations of interest to\n   clients.\n\n   A server sends an Advertise message in response to each valid Solicit\n   message it receives to announce the availability of the server to the\n   client.\n\n   In most cases, the server will send a Reply in response to Request,\n   Confirm, Renew, Rebind, Decline, Release, and Information-request\n   messages sent by a client.  The server will also send a Reply in\n   response to a Solicit with a Rapid Commit option (see Section 21.14)\n   when the server is configured to respond with committed lease\n   assignments.\n\n   These Advertise and Reply messages MUST always contain the Server\n   Identifier option (see Section 21.3) containing the server's DUID and\n   the Client Identifier option (see Section 21.2) from the client\n   message if one was present.\n\n   In most response messages, the server includes options containing\n   configuration information for the client.  The server must be aware\n   of the recommendations on message sizes and the use of fragmentation\n   as discussed in Section 5 of [RFC8200].  If the client included an\n   Option Request option (see Section 21.7) in its message, the server\n   includes options in the response message containing configuration\n   parameters for all of the options identified in the Option Request\n   option that the server has been configured to return to the client.\n   The server MAY return additional options to the client if it has been\n   configured to do so.\n\n   Any message sent from a client may arrive at the server encapsulated\n   in one or more Relay-forward messages.  The server MUST use the\n   received message to construct the proper Relay-reply message to allow\n   the response to the received message to be relayed through the same \n   relay agents (in reverse order) as the original client message; see Section 19.3 for more details.  The server may also need to record\n   this information with each client in case it is needed to send a\n   Reconfigure message at a later time, unless the server has been\n   configured with addresses that can be used to send Reconfigure\n   messages directly to the client (see Section 18.3.11).  Note that\n   servers that support leasequery [RFC5007] also need to record this\n   information.\n\n   By sending Reconfigure messages, the server MAY initiate a\n   configuration exchange to cause DHCP clients to obtain new addresses,\n   prefixes, and other configuration information.  For example, an\n   administrator may use a server-initiated configuration exchange when\n   links in the DHCP domain are to be renumbered or when other\n   configuration options are updated, perhaps because servers are moved,\n   added, or removed.\n\n   When a client receives a Reconfigure message from the server, the\n   client initiates sending a Renew, Rebind, or Information-request\n   message as indicated by msg-type in the Reconfigure Message option\n   (see Section 21.19).  The server sends IAs and/or other configuration\n   information to the client in a Reply message.  The server MAY include\n   options containing the IAs and new values for other configuration\n   parameters in the Reply message, even if those IAs and parameters\n   were not requested in the client's message.\n\n18.3.1. Receipt of Solicit Messages\n\n   The server determines the information about the client and its\n   location as described in Section 13 and checks its administrative\n   policy about responding to the client.  If the server is not\n   permitted to respond to the client, the server discards the Solicit\n   message.  For example, if the administrative policy for the server is\n   that it may only respond to a client that is willing to accept a\n   Reconfigure message, if the client does not include a Reconfigure\n   Accept option (see Section 21.20) in the Solicit message, the server\n   discards the Solicit message.\n\n   If (1) the server is permitted to respond to the client, (2) the\n   client has not included a Rapid Commit option (see Section 21.14) in\n   the Solicit message, or (3) the server has not been configured to\n   respond with committed assignments of leases and other resources, the\n   server sends an Advertise message to the client as described in Section 18.3.9.\n\n   If the client has included a Rapid Commit option in the Solicit\n   message and the server has been configured to respond with committed\n   assignments of leases and other resources, the server responds to the \n   Solicit with a Reply message.  The server produces the Reply message\n   as though it had received a Request message as described in Section 18.3.2.  The server transmits the Reply message as described\n   in Section 18.3.10.  The server MUST commit the assignment of any\n   addresses and delegated prefixes or other configuration information\n   before sending a Reply message to a client.  In this case, the server\n   includes a Rapid Commit option in the Reply message to indicate that\n   the Reply is in response to a Solicit message.\n\n   DISCUSSION:\n\n      When using the Solicit/Reply message exchange, the server commits\n      the assignment of any leases before sending the Reply message.\n      The client can assume that it has been assigned the leases in the\n      Reply message and does not need to send a Request message for\n      those leases.\n\n      Typically, servers that are configured to use the Solicit/Reply\n      message exchange will be deployed so that only one server will\n      respond to a Solicit message.  If more than one server responds,\n      the client will only use the leases from one of the servers, while\n      the leases from the other servers will be committed to the client\n      but not used by the client.\n\n\n18.3.2. Receipt of Request Messages\n\n   When the server receives a valid Request message, the server creates\n   the bindings for that client according to the server's policy and\n   configuration information and records the IAs and other information\n   requested by the client.\n\n   The server constructs a Reply message by setting the \"msg-type\" field\n   to REPLY and copying the transaction ID from the Request message into\n   the \"transaction-id\" field.\n\n   The server MUST include in the Reply message a Server Identifier\n   option (see Section 21.3) containing the server's DUID and the Client\n   Identifier option (see Section 21.2) from the Request message.\n\n   The server examines all IAs in the message from the client.\n\n   For each IA_NA option (see Section 21.4) in the Request message, the\n   server checks if the prefixes of included addresses are appropriate\n   for the link to which the client is connected.  If any of the\n   prefixes of the included addresses are not appropriate for the link\n   to which the client is connected, the server MUST return the IA to\n   the client with a Status Code option (see Section 21.13) with the\n   value NotOnLink.  If the server does not send the NotOnLink status \n   code but it cannot assign any IP addresses to an IA, the server MUST\n   return the IA option in the Reply message with no addresses in the IA\n   and a Status Code option containing status code NoAddrsAvail in the\n   IA.\n\n   For any IA_PD option (see Section 21.21) in the Request message to\n   which the server cannot assign any delegated prefixes, the server\n   MUST return the IA_PD option in the Reply message with no prefixes in\n   the IA_PD and with a Status Code option containing status code\n   NoPrefixAvail in the IA_PD.\n\n   The server MAY assign different addresses and/or delegated prefixes\n   to an IA than those included within the IA of the client's Request\n   message.\n\n   For all IAs to which the server can assign addresses or delegated\n   prefixes, the server includes the IAs with addresses (for IA_NAs),\n   prefixes (for IA_PDs), and other configuration parameters and records\n   the IA as a new client binding.  The server MUST NOT include any\n   addresses or delegated prefixes in the IA that the server does not\n   assign to the client.\n\n   The T1/T2 times set in each applicable IA option for a Reply MUST be\n   the same values across all IAs.  The server MUST determine the T1/T2\n   times across all of the applicable client's bindings in the Reply.\n   This facilitates the client being able to renew all of the bindings\n   at the same time.\n\n   The server SHOULD include a Reconfigure Accept option (see Section 21.20) if the server policy enables the reconfigure mechanism\n   and the client supports it.  Currently, sending this option in a\n   Reply is technically redundant, as the use of the reconfiguration\n   mechanism requires authentication; at present, the only defined\n   mechanism is RKAP (see Section 20.4), and the presence of the\n   reconfigure key signals support for the acceptance of Reconfigure\n   messages.  However, there may be better security mechanisms defined\n   in the future that would cause RKAP to not be used anymore.\n\n   The server includes other options containing configuration\n   information to be returned to the client as described in Section 18.3.\n\n   If the server finds that the client has included an IA in the Request\n   message for which the server already has a binding that associates\n   the IA with the client, the server sends a Reply message with\n   existing bindings, possibly with updated lifetimes.  The server may\n   update the bindings according to its local policies, but the server\n   SHOULD generate the response again and not simply retransmit \n   previously sent information, even if the \"transaction-id\" field value\n   matches a previous transmission.  The server MUST NOT cache its\n   responses.\n\n   DISCUSSION:\n\n      Cached replies are bad because lifetimes need to be updated\n      (either decrease the timers by the amount of time elapsed since\n      the original transmission or keep the lifetime values and update\n      the lease information in the server's database).  Also, if the\n      message uses any security protection (such as the Replay Detection\n      Method (RDM), as described in Section 20.3), its value must be\n      updated.  Additionally, any digests must be updated.  Given all of\n      the above, caching replies is far more complex than simply sending\n      the same buffer as before, and it is easy to miss some of those\n      steps.\n\n\n18.3.3. Receipt of Confirm Messages\n\n   When the server receives a Confirm message, the server determines\n   whether the addresses in the Confirm message are appropriate for the\n   link to which the client is attached.  If all of the addresses in the\n   Confirm message pass this test, the server returns a status of\n   Success.  If any of the addresses do not pass this test, the server\n   returns a status of NotOnLink.  If the server is unable to perform\n   this test (for example, the server does not have information about\n   prefixes on the link to which the client is connected) or there were\n   no addresses in any of the IAs sent by the client, the server\n   MUST NOT send a Reply to the client.\n\n   The server ignores the T1 and T2 fields in the IA options and the\n   preferred-lifetime and valid-lifetime fields in the IA Address\n   options (see Section 21.6).\n\n   The server constructs a Reply message by setting the \"msg-type\" field\n   to REPLY and copying the transaction ID from the Confirm message into\n   the \"transaction-id\" field.\n\n   The server MUST include in the Reply message a Server Identifier\n   option (see Section 21.3) containing the server's DUID and the Client\n   Identifier option (see Section 21.2) from the Confirm message.  The\n   server includes a Status Code option (see Section 21.13) indicating\n   the status of the Confirm message. \n\n\n\n\n\n\n18.3.4. Receipt of Renew Messages\n\n   For each IA in the Renew message from a client, the server locates\n   the client's binding and verifies that the information in the IA from\n   the client matches the information stored for that client.\n\n   If the server finds the client entry for the IA, the server sends the\n   IA back to the client with new lifetimes and, if applicable, T1/T2\n   times.  If the server is unable to extend the lifetimes of an address\n   or delegated prefix in the IA, the server MAY choose not to include\n   the IA Address option (see Section 21.6) for that address or IA\n   Prefix option (see Section 21.22) for that delegated prefix.  If the\n   server chooses to include the IA Address or IA Prefix option for such\n   an address or delegated prefix, the server SHOULD set T1 and T2\n   values to the valid lifetime for the IA option unless the server also\n   includes other addresses or delegated prefixes that the server is\n   able to extend for the IA.  Setting T1 and T2 to values equal to the\n   valid lifetime informs the client that the leases associated with\n   said IA will not be extended, so there is no point in trying.  Also,\n   it avoids generating unnecessary traffic as the remaining lifetime\n   approaches 0.\n\n   The server may choose to change the list of addresses or delegated\n   prefixes and the lifetimes in IAs that are returned to the client.\n\n   If the server finds that any of the addresses in the IA are not\n   appropriate for the link to which the client is attached, the server\n   returns the address to the client with lifetimes of 0.\n\n   If the server finds that any of the delegated prefixes in the IA are\n   not appropriate for the link to which the client is attached, the\n   server returns the delegated prefix to the client with lifetimes\n   of 0.\n\n   For each IA for which the server cannot find a client entry, the\n   server has the following choices, depending on the server's policy\n   and configuration information:\n\n   *  If the server is configured to create new bindings as a result of\n      processing Renew messages, the server SHOULD create a binding and\n      return the IA with assigned addresses or delegated prefixes with\n      lifetimes and, if applicable, T1/T2 times and other information\n      requested by the client.  If the client included the IA Prefix\n      option within the IA_PD option (see Section 21.21) with a zero\n      value in the \"IPv6-prefix\" field and a non-zero value in the\n      \"prefix-length\" field, the server MAY use the \"prefix-length\"\n      value as a hint for the length of the prefixes to be assigned (see\n      [RFC8168] for further details on prefix-length hints). \n   *  If the server is configured to create new bindings as a result of\n      processing Renew messages but the server will not assign any\n      leases to an IA, the server returns the IA option containing a\n      Status Code option (see Section 21.13) with the NoAddrsAvail or\n      NoPrefixAvail status code and a status message for a user.\n\n   *  If the server does not support creation of new bindings for the\n      client sending a Renew message or if this behavior is disabled\n      according to the server's policy or configuration information, the\n      server returns the IA option containing a Status Code option with\n      the NoBinding status code and a status message for a user.\n\n   The server constructs a Reply message by setting the \"msg-type\" field\n   to REPLY and copying the transaction ID from the Renew message into\n   the \"transaction-id\" field.\n\n   The server MUST include in the Reply message a Server Identifier\n   option (see Section 21.3) containing the server's DUID and the Client\n   Identifier option (see Section 21.2) from the Renew message.\n\n   The server includes other options containing configuration\n   information to be returned to the client as described in Section 18.3.\n\n   The server MAY include options containing the IAs and values for\n   other configuration parameters, even if those parameters were not\n   requested in the Renew message.\n\n   The T1/T2 values set in each applicable IA option for a Reply MUST be\n   the same across all IAs.  The server MUST determine the T1/T2 values\n   across all of the applicable client's bindings in the Reply.  This\n   facilitates the client being able to renew all of the bindings at the\n   same time.\n\n\n18.3.5. Receipt of Rebind Messages\n\n   When the server receives a Rebind message that contains an IA option\n   from a client, it locates the client's binding and verifies that the\n   information in the IA from the client matches the information stored\n   for that client.\n\n   If the server finds the client entry for the IA and the server\n   determines that the addresses or delegated prefixes in the IA are\n   appropriate for the link to which the client's interface is attached\n   according to the server's explicit configuration information, the\n   server SHOULD send the IA back to the client with new lifetimes and,\n   if applicable, T1/T2 values.  If the server is unable to extend the\n   lifetimes of an address in the IA, the server MAY choose not to \n   include the IA Address option (see Section 21.6) for this address.\n   If the server is unable to extend the lifetimes of a delegated prefix\n   in the IA, the server MAY choose not to include the IA Prefix option\n   (see Section 21.22) for this prefix.\n\n   If the server finds that the client entry for the IA and any of the\n   addresses or delegated prefixes are no longer appropriate for the\n   link to which the client's interface is attached according to the\n   server's explicit configuration information, the server returns those\n   addresses or delegated prefixes to the client with lifetimes of 0.\n\n   If the server cannot find a client entry for the IA, the server\n   checks if the IA contains addresses (for IA_NAs) or delegated\n   prefixes (for IA_PDs).  The server checks if the addresses and\n   delegated prefixes are appropriate for the link to which the client's\n   interface is attached according to the server's explicit\n   configuration information.  For any address that is not appropriate\n   for the link to which the client's interface is attached, the server\n   MAY include the IA Address option with lifetimes of 0.  For any\n   delegated prefix that is not appropriate for the link to which the\n   client's interface is attached, the server MAY include the IA Prefix\n   option with lifetimes of 0.  The Reply with lifetimes of 0\n   constitutes an explicit notification to the client that the specific\n   addresses and delegated prefixes are no longer valid and MUST NOT be\n   used by the client.  If the server chooses to not include any IAs\n   containing IA Address or IA Prefix options with lifetimes of 0 and\n   the server does not include any other IAs with leases and/or status\n   codes, the server does not send a Reply message.  In this situation,\n   the server discards the Rebind message.\n\n   Otherwise, for each IA for which the server cannot find a client\n   entry, the server has the following choices, depending on the\n   server's policy and configuration information:\n\n   *  If the server is configured to create new bindings as a result of\n      processing Rebind messages (also see the note below about the\n      Rapid Commit option (Section 21.14)), the server SHOULD create a\n      binding and return the IA with allocated leases with lifetimes\n      and, if applicable, T1/T2 values and other information requested\n      by the client.  The server MUST NOT return any addresses or\n      delegated prefixes in the IA that the server does not assign to\n      the client.\n\n   *  If the server is configured to create new bindings as a result of\n      processing Rebind messages but the server will not assign any\n      leases to an IA, the server returns the IA option containing a\n      Status Code option (see Section 21.13) with the NoAddrsAvail or\n      NoPrefixAvail status code and a status message for a user. \n   *  If the server does not support creation of new bindings for the\n      client sending a Rebind message or if this behavior is disabled\n      according to the server's policy or configuration information, the\n      server returns the IA option containing a Status Code option with\n      the NoBinding status code and a status message for a user.\n\n   When the server creates new bindings for the IA, it is possible that\n   other servers also create bindings as a result of receiving the same\n   Rebind message; see the \"DISCUSSION\" text in Section 21.14.\n   Therefore, the server SHOULD only create new bindings during\n   processing of a Rebind message if the server is configured to respond\n   with a Reply message to a Solicit message containing the Rapid Commit\n   option.\n\n   The server constructs a Reply message by setting the \"msg-type\" field\n   to REPLY and copying the transaction ID from the Rebind message into\n   the \"transaction-id\" field.\n\n   The server MUST include in the Reply message a Server Identifier\n   option (see Section 21.3) containing the server's DUID and the Client\n   Identifier option (see Section 21.2) from the Rebind message.\n\n   The server includes other options containing configuration\n   information to be returned to the client as described in Section 18.3.\n\n   The server MAY include options containing the IAs and values for\n   other configuration parameters, even if those IAs and parameters were\n   not requested in the Rebind message.\n\n   The T1 or T2 values set in each applicable IA option for a Reply MUST\n   be the same values across all IAs.  The server MUST determine the T1\n   or T2 values across all of the applicable client's bindings in the\n   Reply.  This facilitates the client being able to renew all of the\n   bindings at the same time.\n\n\n18.3.6. Receipt of Information-request Messages\n\n   When the server receives an Information-request message, the client\n   is requesting configuration information that does not include the\n   assignment of any leases.  The server determines all configuration\n   parameters appropriate to the client, based on the server\n   configuration policies known to the server.\n\n   The server constructs a Reply message by setting the \"msg-type\" field\n   to REPLY and copying the transaction ID from the Information-request\n   message into the \"transaction-id\" field. \n   The server MUST include a Server Identifier option (see Section 21.3)\n   containing the server's DUID in the Reply message.  If the client\n   included a Client Identifier option (see Section 21.2) in the\n   Information-request message, the server copies that option to the\n   Reply message.\n\n   The server includes options containing configuration information to\n   be returned to the client as described in Section 18.3.  The server\n   MAY include additional options that were not requested by the client\n   in the Information-request message.\n\n   If the Information-request message received from the client did not\n   include a Client Identifier option, the server SHOULD respond with a\n   Reply message containing any configuration parameters that are not\n   determined by the client's identity.  If the server chooses not to\n   respond, the client may continue to retransmit the\n   Information-request message indefinitely.\n\n\n18.3.7. Receipt of Release Messages\n\n   The server constructs a Reply message by setting the \"msg-type\" field\n   to REPLY and copying the transaction ID from the Release message into\n   the \"transaction-id\" field.\n\n   Upon the receipt of a valid Release message, the server examines the\n   IAs and the leases in the IAs for validity.  If the IAs in the\n   message are in a binding for the client and the leases in the IAs\n   have been assigned by the server to those IAs, the server deletes the\n   leases from the IAs and makes the leases available for assignment to\n   other clients.  The server ignores leases not assigned to the IAs,\n   although it may choose to log an error.\n\n   After all the leases have been processed, the server generates a\n   Reply message and includes a Status Code option (see Section 21.13)\n   with the value Success, a Server Identifier option (see Section 21.3)\n   with the server's DUID, and a Client Identifier option (see Section 21.2) with the client's DUID.  For each IA in the Release\n   message for which the server has no binding information, the server\n   adds an IA option using the IAID from the Release message and\n   includes a Status Code option with the value NoBinding in the IA\n   option.  No other options are included in the IA option.\n\n   A server may choose to retain a record of assigned leases and IAs\n   after the lifetimes on the leases have expired to allow the server to\n   reassign the previously assigned leases to a client. \n\n\n\n\n\n\n18.3.8. Receipt of Decline Messages\n\n   Upon the receipt of a valid Decline message, the server examines the\n   IAs and the addresses in the IAs for validity.  If the IAs in the\n   message are in a binding for the client and the addresses in the IAs\n   have been assigned by the server to those IAs, the server deletes the\n   addresses from the IAs.  The server ignores addresses not assigned to\n   the IAs (though it may choose to log an error if it finds such\n   addresses).\n\n   The client has found any addresses in the Decline messages to be\n   already in use on its link.  Therefore, the server SHOULD mark the\n   addresses declined by the client so that those addresses are not\n   assigned to other clients and MAY choose to make a notification that\n   addresses were declined.  Local policy on the server determines when\n   the addresses identified in a Decline message may be made available\n   for assignment.\n\n   After all the addresses have been processed, the server generates a\n   Reply message by setting the \"msg-type\" field to REPLY and copying\n   the transaction ID from the Decline message into the \"transaction-id\"\n   field.  The server includes a Status Code option (see Section 21.13)\n   with the value Success, a Server Identifier option (see Section 21.3)\n   with the server's DUID, and a Client Identifier option (see Section 21.2) with the client's DUID.  For each IA in the Decline\n   message for which the server has no binding information, the server\n   adds an IA option using the IAID from the Decline message and\n   includes a Status Code option with the value NoBinding in the IA\n   option.  No other options are included in the IA option.\n\n\n18.3.9. Creation of Advertise Messages\n\n   The server sets the \"msg-type\" field to ADVERTISE and copies the\n   contents of the \"transaction-id\" field from the Solicit message\n   received from the client to the Advertise message.  The server\n   includes its server identifier in a Server Identifier option (see Section 21.3) and copies the Client Identifier option (see Section 21.2) from the Solicit message into the Advertise message.\n\n   The server MAY add a Preference option (see Section 21.8) to carry\n   the preference value for the Advertise message.  The server\n   implementation SHOULD allow the setting of a server preference value\n   by the administrator.  The server preference value MUST default to 0\n   unless otherwise configured by the server administrator. \n   The server includes a Reconfigure Accept option (see Section 21.20)\n   if the server wants to indicate that it supports the Reconfigure\n   mechanism.  This information may be used by the client during the\n   server selection process.\n\n   The server includes the options the server will return to the client\n   in a subsequent Reply message.  The information in these options may\n   be used by the client in the selection of a server if the client\n   receives more than one Advertise message.  The server MUST include\n   options in the Advertise message containing configuration parameters\n   for all of the options identified in the Option Request option (see Section 21.7) in the Solicit message that the server has been\n   configured to return to the client.  If the Option Request option\n   includes a container option, the server MUST include all the options\n   that are eligible to be encapsulated in the container.  The Option\n   Request option MAY be used to signal support for a feature even when\n   that option is encapsulated, as in the case of the Prefix Exclude\n   option [RFC6603].  In this case, special processing is required by\n   the server.  The server MAY return additional options to the client\n   if it has been configured to do so.\n\n   The server MUST include IA options in the Advertise message\n   containing any addresses and/or delegated prefixes that would be\n   assigned to IAs contained in the Solicit message from the client.  If\n   the client has included addresses in the IA Address options (see Section 21.6) in the Solicit message, the server MAY use those\n   addresses as hints about the addresses that the client would like to\n   receive.  If the client has included IA Prefix options (see Section 21.22), the server MAY use the prefix contained in the\n   \"IPv6-prefix\" field and/or the prefix length contained in the\n   \"prefix-length\" field as hints about the prefixes the client would\n   like to receive.  If the server is not going to assign an address or\n   delegated prefix received as a hint in the Solicit message, the\n   server MUST NOT include this address or delegated prefix in the\n   Advertise message.\n\n   If the server will not assign any addresses to an IA_NA in subsequent\n   Request messages from the client, the server MUST include the IA\n   option in the Advertise message with no addresses in that IA and a\n   Status Code option (see Section 21.13) encapsulated in the IA option\n   containing status code NoAddrsAvail.\n\n   If the server will not assign any prefixes to an IA_PD in subsequent\n   Request messages from the client, the server MUST include the IA_PD\n   option (see Section 21.21) in the Advertise message with no prefixes\n   in the IA_PD option and a Status Code option encapsulated in the\n   IA_PD containing status code NoPrefixAvail. \n   Transmission of Advertise messages is described in the next section.\n\n\n18.3.10. Transmission of Advertise and Reply Messages\n\n   If the original message was received directly by the server, the\n   server unicasts the Advertise or Reply message directly to the client\n   using the address in the source address field from the IP datagram in\n   which the original message was received.  The Advertise or Reply\n   message MUST be unicast through the interface on which the original\n   message was received.\n\n   If the original message was received in a Relay-forward message, the\n   server constructs a Relay-reply message with the Reply message in the\n   payload of a Relay Message option (see Section 21.10).  If the\n   Relay-forward messages included an Interface-Id option (see Section 21.18), the server copies that option to the Relay-reply\n   message.  The server unicasts the Relay-reply message directly to the\n   relay agent using the address in the source address field from the IP\n   datagram in which the Relay-forward message was received.  See Section 19.3 for more details on the construction of Relay-reply\n   messages.\n\n\n18.3.11. Creation and Transmission of Reconfigure Messages\n\n   The server sets the \"msg-type\" field to RECONFIGURE and sets the\n   \"transaction-id\" field to 0.  The server includes a Server Identifier\n   option (see Section 21.3) containing its DUID and a Client Identifier\n   option (see Section 21.2) containing the client's DUID in the\n   Reconfigure message.\n\n   Because of the risk of denial-of-service (DoS) attacks against DHCP\n   clients, the use of a security mechanism is mandated in Reconfigure\n   messages.  The server MUST use DHCP authentication in the Reconfigure\n   message (see Section 20.4).\n\n   The server MUST include a Reconfigure Message option (see Section 21.19) to select whether the client responds with a Renew\n   message, a Rebind message, or an Information-request message.\n\n   The server MUST NOT include any other options in the Reconfigure\n   message, except as specifically allowed in the definition of\n   individual options.\n\n   A server sends each Reconfigure message to a single DHCP client,\n   using an IPv6 unicast address of sufficient scope belonging to the\n   DHCP client.  If the server does not have an address to which it can\n   send the Reconfigure message directly to the client, the server uses\n   a Relay-reply message (as described in Section 19.3) to send the \n   Reconfigure message to a relay agent that will relay the message to\n   the client.  The server may obtain the address of the client (and the\n   appropriate relay agent, if required) through the information the\n   server has about clients that have been in contact with the server\n   (see Section 18.3) or through some external agent.\n\n   To reconfigure more than one client, the server unicasts a separate\n   message to each client.  The server may initiate the reconfiguration\n   of multiple clients concurrently; for example, a server may send a\n   Reconfigure message to additional clients while previous\n   reconfiguration message exchanges are still in progress.\n\n   The Reconfigure message causes the client to initiate a Renew/Reply,\n   Rebind/Reply, or Information-request/Reply message exchange with the\n   server.  The server interprets the receipt of a Renew, Rebind, or\n   Information-request message (whichever was specified in the original\n   Reconfigure message) from the client as satisfying the Reconfigure\n   message request.\n\n   When transmitting the Reconfigure message, the server sets the\n   retransmission time (RT) to REC_TIMEOUT.  If the server does not\n   receive a Renew, Rebind, or Information-request message from the\n   client before the RT elapses, the server retransmits the Reconfigure\n   message, doubles the RT value, and waits again.  The server continues\n   this process until REC_MAX_RC unsuccessful attempts have been made,\n   at which point the server SHOULD abort the reconfigure process for\n   that client.\n\n   Default and initial values for REC_TIMEOUT and REC_MAX_RC are\n   documented in Section 7.6.\n\n\n\n19. Relay Agent Behavior\n\n   The relay agent SHOULD be configured to use a list of destination\n   addresses that includes unicast addresses.  The list of destination\n   addresses MAY include the All_DHCP_Servers multicast address or other\n   addresses selected by the network administrator.  If the relay agent\n   has not been explicitly configured, it MUST use the All_DHCP_Servers\n   multicast address as the default.\n\n   If the relay agent relays messages to the All_DHCP_Servers multicast\n   address or other multicast addresses, it sets the Hop Limit field\n   to 8.\n\n   If the relay agent receives a message other than Relay-forward and\n   Relay-reply and the relay agent does not recognize its message type,\n   it MUST forward the message as described in Section 19.1.1. \n\n\n\n\n\n19.1. Relaying a Client Message or a Relay-forward Message\n\n   A relay agent relays both messages from clients and Relay-forward\n   messages from other relay agents.  When a relay agent receives a\n   Relay-forward message, a recognized message type for which it is not\n   the intended target, or an unrecognized message type, it constructs a\n   new Relay-forward message.  The relay agent copies the source address\n   from the header of the IP datagram in which the message was received\n   into the peer-address field of the Relay-forward message.  The relay\n   agent copies the received DHCP message (excluding any IP or UDP\n   headers) into a Relay Message option (see Section 21.10) in the new\n   message.  The relay agent adds to the Relay-forward message any other\n   options it is configured to include.\n\n   [RFC6221] defines a Lightweight DHCPv6 Relay Agent (LDRA) that allows\n   relay agent information to be inserted by an access node that\n   performs a link-layer bridging (i.e., non-routing) function.\n\n19.1.1. Relaying a Message from a Client\n\n   If the relay agent received the message to be relayed from a client,\n   the relay agent places a globally scoped unicast address (i.e., GUA\n   or ULA) from a prefix assigned to the link on which the client should\n   be assigned leases into the link-address field.  If such an address\n   is not available, the relay agent may set the link-address field to a\n   link-local address from the interface on which the original message\n   was received.  This is not recommended, as it may require that\n   additional information be provided in the server configuration.  See Section 3.2 of [RFC7969] for a detailed discussion.\n\n   This address will be used by the server to determine the link from\n   which the client should be assigned leases and other configuration\n   information.\n\n   The hop-count value in the Relay-forward message is set to 0.\n\n   The relay SHOULD insert a Client Link-Layer Address option as\n   described in [RFC6939].\n\n   If the relay agent cannot use the address in the link-address field\n   to identify the interface through which the response to the client\n   will be relayed, the relay agent MUST include an Interface-Id option\n   (see Section 21.18) in the Relay-forward message.  The server will\n   include the Interface-Id option in its Relay-reply message.  The\n   relay agent sets the link-address field as described earlier in this\n   subsection, regardless of whether the relay agent includes an\n   Interface-Id option in the Relay-forward message. \n\n\n\n\n\n\n19.1.2. Relaying a Message from a Relay Agent\n\n   If the message received by the relay agent is a Relay-forward message\n   and the hop-count value in the message is greater than or equal to\n   HOP_COUNT_LIMIT, the relay agent discards the received message.\n\n   The relay agent copies the source address from the IP datagram in\n   which the message was received into the peer-address field in the\n   Relay-forward message and sets the hop-count field to the value of\n   the hop-count field in the received message incremented by 1.\n\n   If the source address from the IP datagram header of the received\n   message is a globally scoped unicast address (i.e., GUA or ULA), the\n   relay agent sets the link-address field to 0; otherwise, the relay\n   agent sets the link-address field to a globally scoped unicast\n   address (i.e., GUA or ULA) assigned to the interface on which the\n   message was received or includes an Interface-Id option (see Section 21.18) to identify the interface on which the message was\n   received.\n\n\n19.1.3. Relay Agent Behavior with Prefix Delegation\n\n   A relay agent forwards messages containing prefix delegation options\n   in the same way as it would relay addresses (i.e., per\n   Sections 19.1.1 and 19.1.2).\n\n   If a server communicates with a client through a relay agent about\n   delegated prefixes, the server may need a protocol or other\n   out-of-band communication to configure routing information for\n   delegated prefixes on any router through which the client may forward\n   traffic.\n\n\n\n19.2. Relaying a Relay-reply Message\n\n   The relay agent processes any options included in the Relay-reply\n   message in addition to the Relay Message option (see Section 21.10).\n\n   The relay agent extracts the message from the Relay Message option\n   and relays it to the address contained in the peer-address field of\n   the Relay-reply message.  Relay agents MUST NOT modify the message.\n\n   If the Relay-reply message includes an Interface-Id option (see Section 21.18), the relay agent relays the message from the server to\n   the client on the link identified by the Interface-Id option.\n   Otherwise, if the link-address field is not set to 0, the relay agent\n   relays the message on the link identified by the link-address field. \n   If the relay agent receives a Relay-reply message, it MUST process\n   the message as defined above, regardless of the type of message\n   encapsulated in the Relay Message option.\n\n\n19.3. Construction of Relay-reply Messages\n\n   A server uses a Relay-reply message to (1) return a response to a\n   client if the original message from the client was relayed to the\n   server in a Relay-forward message or (2) send a Reconfigure message\n   to a client if the server does not have an address it can use to send\n   the message directly to the client.\n\n   A response to the client MUST be relayed through the same relay\n   agents as the original client message.  The server causes this to\n   happen by creating a Relay-reply message that includes a Relay\n   Message option (see Section 21.10) containing the message for the\n   next relay agent in the return path to the client.  The contained\n   Relay-reply message contains another Relay Message option to be sent\n   to the next relay agent, and so on.  The server must record the\n   contents of the peer-address fields in the received message so it can\n   construct the appropriate Relay-reply message carrying the response\n   from the server.\n\n   For example, if client C sent a message that was relayed by relay\n   agent A to relay agent B and then to the server, the server would\n   send the following Relay-reply message to relay agent B:\n\n      msg-type:       RELAY-REPL\n      hop-count:      1\n      link-address:   0\n      peer-address:   A\n      Relay Message option containing the following:\n         msg-type:     RELAY-REPL\n         hop-count:    0\n         link-address: address from link to which C is attached\n         peer-address: C\n         Relay Message option: <response from server>\n\n                       Figure 10: Relay-reply Example \n   When sending a Reconfigure message to a client through a relay agent,\n   the server creates a Relay-reply message that includes a Relay\n   Message option containing the Reconfigure message for the next relay\n   agent in the return path to the client.  The server sets the\n   peer-address field in the Relay-reply message header to the address\n   of the client and sets the link-address field as required by the\n   relay agent to relay the Reconfigure message to the client.  The\n   server obtains the addresses of the client and the relay agent\n   through prior interaction with the client or through some external\n   mechanism.\n\n\n19.4. Interaction between Relay Agents and Servers\n\n   Each time a message is relayed by a relay agent towards a server, a\n   new encapsulation level is added around the message.  Each relay is\n   allowed to insert additional options on the encapsulation level it\n   added but MUST NOT change anything in the message being encapsulated.\n   If there are multiple relays between a client and a server, multiple\n   encapsulations are used.  Although it makes message processing\n   slightly more complex, it provides the major advantage of having a\n   clear indication as to which relay inserted which option.  The\n   response message is expected to travel through the same relays, but\n   in reverse order.  Each time a response message is relayed back\n   towards a client, one encapsulation level is removed.\n\n   In certain cases, relays can add one or more options.  These options\n   can be added for several reasons:\n\n   *  First, relays can provide additional information about the client.\n      That source of information is usually more trusted by a server\n      administrator, as it comes from the network infrastructure rather\n      than the client and cannot be easily spoofed.  These options can\n      be used by the server to determine its allocation policy.\n\n   *  Second, a relay may need some information to send a response back\n      to the client.  Relay agents are expected to be stateless (not\n      retain any state after a message has been processed).  A relay\n      agent may include the Interface-Id option (see Section 21.18),\n      which will be echoed back in the response.  It can include other\n      options and ask the server to echo one or more of the options back\n      in the response.  These options can then be used by the relay\n      agent to send the response back to the client, or for other needs.\n      The client will never see these options.  See [RFC4994] for\n      details.\n\n   *  Third, sometimes a relay is the best device to provide values for\n      certain options.  A relay can insert an option into the message\n      being forwarded to the server and ask the server to pass that \n      option back to the client.  The client will receive that option.\n      It should be noted that the server is the ultimate authority here,\n      and -- depending on its configuration -- it may or may not send\n      the option back to the client.  See [RFC6422] for details.\n\n   For various reasons, servers may need to retain the relay information\n   after the message processing is completed.  One is a bulk leasequery\n   mechanism that may ask for all addresses and/or prefixes that were\n   assigned via a specific relay.  A second is for the reconfigure\n   mechanism.  The server may choose to not send the Reconfigure message\n   directly to the client but rather to send it via relays.  This\n   particular behavior is considered an implementation detail and is out\n   of scope for this document.\n\n\n20. Authentication of DHCP Messages\n\n   This document introduces two security mechanisms for the\n   authentication of DHCP messages: (1) authentication (and encryption)\n   of messages sent between servers and relay agents using IPsec and\n   (2) protection against misconfiguration of a client caused by a\n   Reconfigure message sent by a malicious DHCP server.\n\n20.1. Security of Messages Sent between Servers and Relay Agents\n\n   Relay agents and servers that exchange messages can use IPsec as\n   detailed in [RFC8213].\n\n\n20.2. Summary of DHCP Authentication\n\n   Authentication of DHCP messages is accomplished through the use of\n   the Authentication option (see Section 21.11).  The authentication\n   information carried in the Authentication option can be used to\n   reliably identify the source of a DHCP message and to confirm that\n   the contents of the DHCP message have not been tampered with.\n\n   The Authentication option provides a framework for multiple\n   authentication protocols.  One such protocol, RKAP, is defined in Section 20.4.  Other protocols defined in the future will be\n   specified in separate documents.\n\n   Any DHCP message MUST NOT include more than one Authentication\n   option.\n\n   The protocol field in the Authentication option identifies the\n   specific protocol used to generate the authentication information\n   carried in the option.  The algorithm field identifies a specific\n   algorithm within the authentication protocol; for example, the\n   algorithm field specifies the hash algorithm used to generate the \n   Message Authentication Code (MAC) in the Authentication option.  The\n   RDM field specifies the type of replay detection used in the replay\n   detection field.\n\n\n20.3. Replay Detection\n\n   The RDM field of the Authentication option (see Section 21.11)\n   determines the type of replay detection used in the replay detection\n   field.\n\n   If the RDM field contains 0x00, the replay detection field MUST be\n   set to the value of a strictly monotonically increasing 64-bit\n   unsigned integer (modulo 2^64).  Using this technique can reduce the\n   danger of replay attacks.  This method MUST be supported by all\n   Authentication option protocols.  One choice might be to use the\n   64-bit NTP timestamp format [RFC5905]).\n\n   A client that receives a message with the RDM field set to 0x00 MUST\n   compare its replay detection field with the previous value sent by\n   that same server (based on the Server Identifier option; see Section 21.3) and only accept the message if the received value is\n   greater and record this as the new value.  If this is the first time\n   a client processes an Authentication option sent by a server, the\n   client MUST record the replay detection value and skip the replay\n   detection check.\n\n   Servers that support the reconfigure mechanism MUST ensure that the\n   replay detection value is retained between restarts.  Failing to do\n   so may cause clients to refuse Reconfigure messages sent by the\n   server, effectively rendering the reconfigure mechanism useless.\n\n\n20.4. Reconfiguration Key Authentication Protocol (RKAP)\n\n   RKAP provides protection against misconfiguration of a client caused\n   by a Reconfigure message sent by a malicious DHCP server.  In this\n   protocol, a DHCP server sends a reconfigure key to the client in the\n   initial exchange of DHCP messages.  The client records the\n   reconfigure key for use in authenticating subsequent Reconfigure\n   messages from that server.  The server then includes a Hashed Message\n   Authentication Code (HMAC) computed from the reconfigure key in\n   subsequent Reconfigure messages.\n\n   Both the reconfigure key sent from the server to the client and the\n   HMAC in subsequent Reconfigure messages are carried as the\n   authentication information in an Authentication option (see Section 21.11).  The format of the authentication information is\n   defined in the following section. \n   RKAP is used (initiated by the server) only if the client and server\n   have negotiated to use Reconfigure messages.\n\n20.4.1. Use of the Authentication Option in RKAP\n\n   The following fields are set in an Authentication option (see Section 21.11) for RKAP:\n\n   protocol      3\n\n   algorithm     1\n\n   RDM           0\n\n   The format of the authentication information for RKAP is:\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |     Type      |                 Value (128 bits)              |\n      +-+-+-+-+-+-+-+-+                                               |\n      .                                                               .\n      .                                                               .\n      .                                               +-+-+-+-+-+-+-+-+\n      |                                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                 Figure 11: RKAP Authentication Information\n\n   Type                Type of data in the Value field carried in this\n                       option:\n\n                       1       Reconfigure key value (used in the Reply\n                               message).\n\n                       2       HMAC-MD5 digest of the message (used in\n                               the Reconfigure message).\n\n                       A 1-octet field.\n\n   Value               Data as defined by the Type field.  A 16-octet\n                       field. \n\n\n\n\n\n\n20.4.2. Server Considerations for RKAP\n\n   The server selects a reconfigure key for a client during the\n   Request/Reply, Solicit/Reply, or Information-request/Reply message\n   exchange.  The server records the reconfigure key and transmits that\n   key to the client in an Authentication option (see Section 21.11) in\n   the Reply message.\n\n   The reconfigure key is 128 bits long and MUST be a cryptographically\n   strong random or pseudorandom number that cannot easily be predicted.\n\n   To provide authentication for a Reconfigure message, the server\n   selects a replay detection value according to the RDM selected by the\n   server and computes an HMAC-MD5 of the Reconfigure message using the\n   reconfigure key for the client.  The server computes the HMAC-MD5\n   over the entire DHCP Reconfigure message, including the\n   Authentication option; the HMAC-MD5 field in the Authentication\n   option is set to 0 for the HMAC-MD5 computation.  The server includes\n   the HMAC-MD5 in the authentication information field in an\n   Authentication option included in the Reconfigure message sent to the\n   client.\n\n\n20.4.3. Client Considerations for RKAP\n\n   The client will receive a reconfigure key from the server in an\n   Authentication option (see Section 21.11) in the initial Reply\n   message from the server.  The client records the reconfigure key for\n   use in authenticating subsequent Reconfigure messages.\n\n   To authenticate a Reconfigure message, the client computes an\n   HMAC-MD5 over the Reconfigure message, with zeroes substituted for\n   the HMAC-MD5 field, using the reconfigure key received from the\n   server.  If this computed HMAC-MD5 matches the value in the\n   Authentication option, the client accepts the Reconfigure message.\n\n\n\n21. DHCP Options\n\n   Options are used to carry additional information and parameters in\n   DHCP messages.  Every option shares a common base format, as\n   described in Section 21.1.  All values in options are represented in\n   network byte order.\n\n   This document specifies the DHCP options defined as part of this base\n   DHCP specification.  Other options have been or may be defined in the\n   future in separate documents.  See [RFC7227] for guidelines regarding\n   the definition of new options.  See Section 25 for additional\n   information about the DHCPv6 \"Option Codes\" registry maintained by\n   IANA. \n   Unless otherwise noted, each option may appear only in the options\n   area of a DHCP message and may appear only once.  If an option does\n   appear multiple times, each instance is considered separate and the\n   data areas of the options MUST NOT be concatenated or otherwise\n   combined.\n\n   Options that are allowed to appear only once are called \"singleton\n   options\".  The only non-singleton options defined in this document\n   are the IA_NA (see Section 21.4), Vendor Class (see Section 21.16),\n   Vendor-specific Information (see Section 21.17), and IA_PD (see Section 21.21) options.  Also, IA Address (see Section 21.6) and IA\n   Prefix (see Section 21.22) may appear in their respective IA options\n   more than once.\n\n21.1. Format of DHCP Options\n\n   The format of DHCP options is:\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |          option-code          |           option-len          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                          option-data                          |\n      |                      (option-len octets)                      |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                          Figure 12: Option Format\n\n   option-code             An unsigned integer identifying the specific\n                           option type carried in this option.\n                           A 2-octet field.\n\n   option-len              An unsigned integer giving the length of the\n                           option-data field in this option in octets.\n                           A 2-octet field.\n\n   option-data             The data for the option; the format of this\n                           data depends on the definition of the option.\n                           A variable-length field (the length, in\n                           octets, is specified by option-len).\n\n   DHCP options are scoped by using encapsulation.  Some options apply\n   generally to the client, some are specific to an IA, and some are\n   specific to the addresses within an IA.  These latter two cases are\n   discussed in Sections 21.4, 21.5, and 21.6. \n\n\n\n\n\n\n21.2. Client Identifier Option\n\n   The Client Identifier option is used to carry a DUID (see Section 11)\n   that identifies the client.  The format of the Client Identifier\n   option is:\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |        OPTION_CLIENTID        |          option-len           |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      .                                                               .\n      .                              DUID                             .\n      .                        (variable length)                      .\n      .                                                               .\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                 Figure 13: Client Identifier Option Format\n\n   option-code             OPTION_CLIENTID (1).\n\n   option-len              Length of DUID in octets.\n\n   DUID                    The DUID for the client.\n\n\n21.3. Server Identifier Option\n\n   The Server Identifier option is used to carry a DUID (see Section 11)\n   that identifies the server.  The format of the Server Identifier\n   option is:\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |        OPTION_SERVERID        |          option-len           |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      .                                                               .\n      .                              DUID                             .\n      .                        (variable length)                      .\n      .                                                               .\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                 Figure 14: Server Identifier Option Format\n\n   option-code             OPTION_SERVERID (2).\n\n   option-len              Length of DUID in octets. \n   DUID                    The DUID for the server.\n\n\n21.4. Identity Association for Non-temporary Addresses Option\n\n   The Identity Association for Non-temporary Addresses (IA_NA) option\n   is used to carry an IA_NA, the parameters associated with the IA_NA,\n   and the non-temporary addresses associated with the IA_NA.\n\n   A client that needs a short-term / special purpose address can use a\n   new IA_NA binding to request an address and release it when finished\n   with it.\n\n   Note: Addresses appearing in an IA_NA option are not temporary\n   addresses (see Section 21.5).\n\n   The format of the IA_NA option is:\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |          OPTION_IA_NA         |          option-len           |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                        IAID (4 octets)                        |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                              T1                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                              T2                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                                                               |\n      .                         IA_NA-options                         .\n      .                                                               .\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n        Figure 15: Identity Association for Non-temporary Addresses\n                               Option Format\n\n   option-code             OPTION_IA_NA (3).\n\n   option-len              12 + length of IA_NA-options field.\n\n   IAID                    The unique identifier for this IA_NA; the\n                           IAID must be unique among the identifiers for\n                           all of this client's IA_NAs.  The number\n                           space for IA_NA IAIDs is separate from the\n                           number space for other IA option types (i.e.,\n                           IA_PD).  A 4-octet field containing an\n                           unsigned integer. \n   T1                      The time interval after which the client\n                           should contact the server from which the\n                           addresses in the IA_NA were obtained to\n                           extend the lifetimes of the addresses\n                           assigned to the IA_NA; T1 is a time duration\n                           relative to the current time expressed in\n                           units of seconds.  A 4-octet field containing\n                           an unsigned integer.\n\n   T2                      The time interval after which the client\n                           should contact any available server to extend\n                           the lifetimes of the addresses assigned to\n                           the IA_NA; T2 is a time duration relative to\n                           the current time expressed in units of\n                           seconds.  A 4-octet field containing an\n                           unsigned integer.\n\n   IA_NA-options           Options associated with this IA_NA.  A\n                           variable-length field (12 octets less than\n                           the value in the option-len field).\n\n   The IA_NA-options field encapsulates those options that are specific\n   to this IA_NA.  For example, all of the IA Address options (see Section 21.6) carrying the addresses associated with this IA_NA are\n   in the IA_NA-options field.\n\n   Each IA_NA carries one \"set\" of non-temporary addresses; it is up to\n   the server policy to determine how many addresses are assigned, but\n   typically at most one address is assigned from each prefix assigned\n   to the link to which the client is attached.\n\n   An IA_NA option may only appear in the options area of a DHCP\n   message.  A DHCP message may contain multiple IA_NA options (though\n   each must have a unique IAID).\n\n   The status of any operations involving this IA_NA is indicated in a\n   Status Code option (see Section 21.13) in the IA_NA-options field.\n\n   Note that an IA_NA has no explicit \"lifetime\" or \"lease length\" of\n   its own.  When the valid lifetimes of all of the addresses in an\n   IA_NA have expired, the IA_NA can be considered as having expired.\n   T1 and T2 are included to give servers explicit control over when a\n   client recontacts the server about a specific IA_NA.\n\n   In a message sent by a client to a server, the T1 and T2 fields\n   SHOULD be set to 0.  The server MUST ignore any values in these\n   fields in messages received from a client. \n   In a message sent by a server to a client, the client MUST use the\n   values in the T1 and T2 fields for the T1 and T2 times, unless values\n   in those fields are 0.  The values in the T1 and T2 fields are the\n   number of seconds until T1 and T2 and are calculated since reception\n   of the message.\n\n   As per Section 7.7, the value 0xffffffff is taken to mean \"infinity\"\n   and should be used carefully.\n\n   The server selects the T1 and T2 values to allow the client to extend\n   the lifetimes of any addresses in the IA_NA before the lifetimes\n   expire, even if the server is unavailable for some short period of\n   time.  Recommended values for T1 and T2 are 0.5 and 0.8 times the\n   shortest preferred lifetime of the addresses in the IA that the\n   server is willing to extend, respectively.  If the \"shortest\"\n   preferred lifetime is 0xffffffff (\"infinity\"), the recommended T1 and\n   T2 values are also 0xffffffff.  If the time at which the addresses in\n   an IA_NA are to be renewed is to be left to the discretion of the\n   client, the server sets the T1 and T2 values to 0.  The client MUST\n   follow the rules defined in Section 14.2.\n\n   If a client receives an IA_NA with T1 greater than T2 and both T1 and\n   T2 are greater than 0, the client discards the IA_NA option and\n   processes the remainder of the message as though the server had not\n   included the invalid IA_NA option.\n\n\n21.5. Identity Association for Temporary Addresses Option\n\n   The Identity Association for Temporary Addresses (IA_TA) option is\n   obsoleted.  Please refer to [RFC8415] for historical information on\n   this option.\n\n   The client SHOULD NOT send this option.  The server SHOULD NOT send\n   this option.  When the server receives IA_TA option, the option\n   SHOULD be ignored and the message processing should continue as\n   usual.\n\n   As this option was never popular among server or client\n   implementations before being deprecated, any implementations that\n   still attempt to send it are unlikely to have the option processed.\n\n\n21.6. IA Address Option\n\n   The IA Address option is used to specify an address.  In this\n   document it is only specified to be encapsulated within an IA_NA.\n   DHCPv6 Leasequery [RFC5007] makes use of the IA Address Option\n   without encapsulating it in IA_NA.  The IAaddr-options field\n   encapsulates those options that are specific to this address. \n   The format of the IA Address option is:\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |          OPTION_IAADDR        |          option-len           |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                                                               |\n      |                         IPv6-address                          |\n      |                                                               |\n      |                                                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                      preferred-lifetime                       |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                        valid-lifetime                         |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      .                                                               .\n      .                        IAaddr-options                         .\n      .                                                               .\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                    Figure 16: IA Address Option Format\n\n   option-code             OPTION_IAADDR (5).\n\n   option-len              24 + length of IAaddr-options field.\n\n   IPv6-address            An IPv6 address.  A client MUST NOT form an\n                           implicit prefix with a length other than 128\n                           for this address.  A 16-octet field.\n\n   preferred-lifetime      The preferred lifetime for the address in the\n                           option, expressed in units of seconds.  A\n                           4-octet field containing an unsigned integer.\n\n   valid-lifetime          The valid lifetime for the address in the\n                           option, expressed in units of seconds.  A\n                           4-octet field containing an unsigned integer.\n\n   IAaddr-options          Options associated with this address.  A\n                           variable-length field (24 octets less than\n                           the value in the option-len field).\n\n   In a message sent by a client to a server, the preferred-lifetime and\n   valid-lifetime fields SHOULD be set to 0.  The server MUST ignore any\n   received values. \n   The client SHOULD NOT send the IA Address option with an unspecified\n   address (::).\n\n   In a message sent by a server to a client, the client MUST use the\n   values in the preferred-lifetime and valid-lifetime fields for the\n   preferred and valid lifetimes.  The values in these fields are the\n   number of seconds remaining in each lifetime.\n\n   The client MUST discard any addresses for which the preferred\n   lifetime is greater than the valid lifetime.\n\n   As per Section 7.7, if the valid lifetime of an address is\n   0xffffffff, it is taken to mean \"infinity\" and should be used\n   carefully.\n\n   More than one IA Address option can appear in an IA_NA option.\n\n   The status of any operations involving this IA Address is indicated\n   in a Status Code option in the IAaddr-options field, as specified in Section 21.13.\n\n\n21.7. Option Request Option\n\n   The Option Request option is used to identify a list of options in a\n   message between a client and a server.  The format of the Option\n   Request option is:\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |           OPTION_ORO          |           option-len          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |    requested-option-code-1    |    requested-option-code-2    |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                              ...                              |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                  Figure 17: Option Request Option Format\n\n   option-code                  OPTION_ORO (6).\n\n   option-len                   2 * number of requested options.\n\n   requested-option-code-n      The option code for an option requested\n                                by the client.  Each option code is a\n                                2-octet field containing an unsigned\n                                integer. \n   A client MUST include an Option Request option in a Solicit, Request,\n   Renew, Rebind, or Information-request message to inform the server\n   about options the client wants the server to send to the client.\n\n   The Option Request option MUST NOT include the following option\n   codes:\n\n   *  Client Identifier (see Section 21.2)\n\n   *  Server Identifier (see Section 21.3)\n\n   *  IA_NA (see Section 21.4)\n\n   *  IA_TA (option obsoleted, see Section 21.5)\n\n   *  IA_PD (see Section 21.21)\n\n   *  IA Address (see Section 21.6)\n\n   *  IA Prefix (see Section 21.22)\n\n   *  Option Request (this section)\n\n   *  Elapsed Time (see Section 21.9)\n\n   *  Preference (see Section 21.8)\n\n   *  Relay Message (see Section 21.10)\n\n   *  Authentication (see Section 21.11)\n\n   *  Server Unicast (option obsoleted, see Section 21.12)\n\n   *  Status Code (see Section 21.13)\n\n   *  Rapid Commit (see Section 21.14)\n\n   *  User Class (see Section 21.15)\n\n   *  Vendor Class (see Section 21.16)\n\n   *  Interface-Id (see Section 21.18)\n\n   *  Reconfigure Message (see Section 21.19)\n\n   *  Reconfigure Accept (see Section 21.20)\n   Other top-level option codes MUST appear in the Option Request option\n   or they will not be sent by the server.  Only top-level option codes\n   MAY appear in the Option Request option.  Option codes encapsulated\n   in a container option SHOULD NOT appear in an Option Request option;\n   see [RFC7598] for an example of container options.  However, options\n   MAY be defined that specify exceptions to this restriction on\n   including encapsulated option codes in an Option Request option.  For\n   example, the Option Request option MAY be used to signal support for\n   a feature even when that option is encapsulated, as in the case of\n   the Prefix Exclude option [RFC6603].  See [IANA-OPTION-DETAILS ].\n\n   See [IANA-OPTION-DETAILS ] for the authoritative list of which option\n   codes are required, permitted or forbidden.\n\n\n21.8. Preference Option\n\n   The Preference option is sent by a server to a client to control the\n   selection of a server by the client.\n\n   The format of the Preference option is:\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |       OPTION_PREFERENCE       |          option-len           |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |  pref-value   |\n      +-+-+-+-+-+-+-+-+\n\n                    Figure 18: Preference Option Format\n\n   option-code             OPTION_PREFERENCE (7).\n\n   option-len              1.\n\n   pref-value              The preference value for the server in this\n                           message.  A 1-octet unsigned integer.\n\n   A server MAY include a Preference option in an Advertise message to\n   control the selection of a server by the client.  See Section 18.2.9   for information regarding the use of the Preference option by the\n   client and the interpretation of the Preference option data value.\n\n\n21.9. Elapsed Time Option\n\n\n\n\n\n\n\n\n\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |      OPTION_ELAPSED_TIME      |           option-len          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |          elapsed-time         |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                   Figure 19: Elapsed Time Option Format\n\n   option-code             OPTION_ELAPSED_TIME (8).\n\n   option-len              2.\n\n   elapsed-time            The amount of time since the client began its\n                           current DHCP transaction.  This time is\n                           expressed in hundredths of a second\n                           (10^-2 seconds).  A 2-octet field containing\n                           an unsigned integer.\n\n   A client MUST include an Elapsed Time option in messages to indicate\n   how long the client has been trying to complete a DHCP message\n   exchange.  The elapsed time is measured from the time at which the\n   client sent the first message in the message exchange, and the\n   elapsed-time field is set to 0 in the first message in the message\n   exchange.  Servers and relay agents use the data value in this option\n   as input to policy that controls how a server responds to a client\n   message.  For example, the Elapsed Time option allows a secondary\n   DHCP server to respond to a request when a primary server has not\n   answered in a reasonable time.  The elapsed-time value is a 16-bit\n   (2-octet) unsigned integer.  The client uses the value 0xffff to\n   represent any elapsed-time values greater than the largest time value\n   that can be represented in the Elapsed Time option.\n\n\n21.10. Relay Message Option\n\n   The Relay Message option carries a DHCP message in a Relay-forward or\n   Relay-reply message.\n\n   The format of the Relay Message option is:\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |        OPTION_RELAY_MSG       |           option-len          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                                                               |\n      .                       DHCP-relay-message                      .\n      .                                                               .\n      .                                                               .\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                   Figure 20: Relay Message Option Format\n\n   option-code             OPTION_RELAY_MSG (9).\n\n   option-len              Length of DHCP-relay-message field.\n\n   DHCP-relay-message      In a Relay-forward message, the received\n                           message, relayed verbatim to the next relay\n                           agent or server; in a Relay-reply message,\n                           the message to be copied and relayed to the\n                           relay agent or client whose address is in the\n                           peer-address field of the Relay-reply\n                           message.  The length, in octets, is specified\n                           by option-len.\n\n\n21.11. Authentication Option\n\n   The Authentication option carries authentication information to\n   authenticate the identity and contents of DHCP messages.  The use of\n   the Authentication option is described in Section 20.  The format of\n   the Authentication option is:\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |          OPTION_AUTH          |          option-len           |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |   protocol    |   algorithm   |      RDM      |               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |\n      |                                                               |\n      |          replay detection (64 bits)           +-+-+-+-+-+-+-+-+\n      |                                               |               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |\n      .                   authentication information                  .\n      .                       (variable length)                       .\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n                  Figure 21: Authentication Option Format\n\n   option-code                     OPTION_AUTH (11).\n\n   option-len                      11 + length of authentication\n                                   information field.\n\n   protocol                        The authentication protocol used in\n                                   this Authentication option.  A\n                                   1-octet unsigned integer.\n\n   algorithm                       The algorithm used in the\n                                   authentication protocol.  A 1-octet\n                                   unsigned integer.\n\n   RDM                             The replay detection method used in\n                                   this Authentication option.  A\n                                   1-octet unsigned integer.\n\n   replay detection                The replay detection information for\n                                   the RDM.  A 64-bit (8-octet) field.\n\n   authentication information      The authentication information, as\n                                   specified by the protocol and\n                                   algorithm used in this Authentication\n                                   option.  A variable-length field\n                                   (11 octets less than the value in the\n                                   option-len field).\n\n   IANA maintains a registry for the protocol, algorithm, and RDM values\n   at <https://www.iana.org/assignments/auth-namespaces >.\n\n\n21.12. Server Unicast Option\n\n   The Server Unicast option is obsolete.  Please refer to [RFC8415] for\n   historical information on this option.\n\n   The client SHOULD NOT request this option in the Option Request\n   option.  The server SHOULD NOT send this option, even when requested\n   by clients.  When any entity receives the Server Unicast option, the\n   option SHOULD be ignored and the message processing should continue\n   as usual.\n\n   As this option was not very popular and it typically required special\n   configuration by those server implementations that did support it,\n   clients still requesting this option in the Option Request option are\n   increasingly unlikely to receive it. \n\n\n\n\n\n\n21.13. Status Code Option\n\n   This option returns a status indication related to the DHCP message\n   or option in which it appears.  The format of the Status Code\n   option is:\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |       OPTION_STATUS_CODE      |         option-len            |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |          status-code          |                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |\n      .                                                               .\n      .                        status-message                         .\n      .                                                               .\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                    Figure 22: Status Code Option Format\n\n   option-code             OPTION_STATUS_CODE (13).\n\n   option-len              2 + length of status-message field.\n\n   status-code             The numeric code for the status encoded in\n                           this option.  A 2-octet field containing an\n                           unsigned integer.\n\n   status-message          A UTF-8 encoded [RFC3629] text string\n                           suitable for display to an end user.\n                           MUST NOT be null-terminated.  A variable-\n                           length field (2 octets less than the value in\n                           the option-len field).\n\n   A Status Code option may appear in the \"options\" field of a DHCP\n   message and/or in the \"options\" field of another option.  If the\n   Status Code option does not appear in a message in which the option\n   could appear, the status of the message is assumed to be Success.\n\n   The status-code values are:\n       +===============+======+===================================+\n       | Name          | Code | Description                       |\n       +===============+======+===================================+\n       | Success       |    0 | Success.                          |\n       +---------------+------+-----------------------------------+\n       | UnspecFail    |    1 | Failure, reason unspecified; this |\n       |               |      | status code is sent by either a   |\n       |               |      | client or a server to indicate a  |\n       |               |      | failure not explicitly specified  |\n       |               |      | in this document.                 |\n       +---------------+------+-----------------------------------+\n       | NoAddrsAvail  |    2 | The server has no addresses       |\n       |               |      | available to assign to the IA(s). |\n       +---------------+------+-----------------------------------+\n       | NoBinding     |    3 | Client record (binding)           |\n       |               |      | unavailable.                      |\n       +---------------+------+-----------------------------------+\n       | NotOnLink     |    4 | The prefix for the address is not |\n       |               |      | appropriate for the link to which |\n       |               |      | the client is attached.           |\n       +---------------+------+-----------------------------------+\n       | UseMulticast  |    5 | Sent by a server to a client to   |\n       |               |      | force the client to send messages |\n       |               |      | to the server using the           |\n       |               |      | All_DHCP_Relay_Agents_and_Servers |\n       |               |      | multicast address.  Obsoleted; no |\n       |               |      | longer used.                      |\n       +---------------+------+-----------------------------------+\n       | NoPrefixAvail |    6 | The server has no prefixes        |\n       |               |      | available to assign to the        |\n       |               |      | IA_PD(s).                         |\n       +---------------+------+-----------------------------------+\n\n                     Table 3: Status Code Definitions\n\n   See the \"Status Codes\" registry at <https://www.iana.org/assignments/\n   dhcpv6-parameters > for the current list of status codes.\n\n\n21.14. Rapid Commit Option\n\n   The Rapid Commit option is used to signal the use of the two-message\n   exchange for address assignment.  The format of the Rapid Commit\n   option is:\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |      OPTION_RAPID_COMMIT      |         option-len            |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                   Figure 23: Rapid Commit Option Format\n\n   option-code             OPTION_RAPID_COMMIT (14).\n\n   option-len              0.\n\n   A client MAY include this option in a Solicit message if the client\n   is prepared to perform the Solicit/Reply message exchange described\n   in Section 18.2.1.\n\n   A server MUST include this option in a Reply message sent in response\n   to a Solicit message when completing the Solicit/Reply message\n   exchange.\n\n   DISCUSSION:\n\n      Each server that responds with a Reply to a Solicit that includes\n      a Rapid Commit option will commit the leases in the Reply message\n      to the client but will not receive any confirmation that the\n      client has received the Reply message.  Therefore, if more than\n      one server responds to a Solicit that includes a Rapid Commit\n      option, all but one server will commit leases that are not\n      actually used by the client; this could result in incorrect\n      address information in DNS if the DHCP servers update DNS\n      [RFC4704], and responses to leasequery requests [RFC5007] may\n      include information on leases not in use by the client.\n\n      The problem of unused leases can be minimized by designing the\n      DHCP service so that only one server responds to the Solicit or by\n      using relatively short lifetimes for newly assigned leases.\n\n\n21.15. User Class Option\n\n   The User Class option is used by a client to identify the type or\n   category of users or applications it represents.\n\n   The format of the User Class option is:\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |       OPTION_USER_CLASS       |          option-len           |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      .                                                               .\n      .                          user-class-data                      .\n      .                                                               .\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                    Figure 24: User Class Option Format\n\n   option-code             OPTION_USER_CLASS (15).\n\n   option-len              Length of user-class-data field.\n\n   user-class-data         The user classes carried by the client.  The\n                           length, in octets, is specified by\n                           option-len.\n\n   The information contained in the data area of this option is\n   contained in one or more opaque fields that represent the user class\n   or classes of which the client is a member.  A server selects\n   configuration information for the client based on the classes\n   identified in this option.  For example, the User Class option can be\n   used to configure all clients of people in the accounting department\n   with a different printer than clients of people in the marketing\n   department.  The user class information carried in this option MUST\n   be configurable on the client.\n\n   The data area of the User Class option MUST contain one or more\n   instances of user-class-data information.  Each instance of\n   user-class-data is formatted as follows:\n\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-...-+-+-+-+-+-+-+\n      |        user-class-len         |          opaque-data          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-...-+-+-+-+-+-+-+\n\n                 Figure 25: Format of user-class-data Field\n\n   The user-class-len field is 2 octets long and specifies the length of\n   the opaque user-class-data in network byte order.\n\n   A server interprets the classes identified in this option according\n   to its configuration to select the appropriate configuration\n   information for the client.  A server may use only those user classes\n   that it is configured to interpret in selecting configuration\n   information for a client and ignore any other user classes.  In \n   response to a message containing a User Class option, a server may\n   include a User Class option containing those classes that were\n   successfully interpreted by the server so that the client can be\n   informed of the classes interpreted by the server.\n\n\n21.16. Vendor Class Option\n\n   This option is used by a client to identify the vendor that\n   manufactured the hardware on which the client is running.  The\n   information contained in the data area of this option is contained in\n   one or more opaque fields that identify details of the hardware\n   configuration.  The format of the Vendor Class option is:\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |      OPTION_VENDOR_CLASS      |           option-len          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                       enterprise-number                       |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      .                                                               .\n      .                       vendor-class-data                       .\n      .                             . . .                             .\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                   Figure 26: Vendor Class Option Format\n\n   option-code             OPTION_VENDOR_CLASS (16).\n\n   option-len              4 + length of vendor-class-data field.\n\n   enterprise-number       The vendor's registered Enterprise Number as\n                           maintained by IANA [IANA-PEN ].  A 4-octet\n                           field containing an unsigned integer.\n\n   vendor-class-data       The hardware configuration of the node on\n                           which the client is running.  A\n                           variable-length field (4 octets less than the\n                           value in the option-len field).\n\n   The vendor-class-data field is composed of a series of separate\n   items, each of which describes some characteristic of the client's\n   hardware configuration.  Examples of vendor-class-data instances\n   might include the version of the operating system the client is\n   running or the amount of memory installed on the client.\n\n   Each instance of vendor-class-data is formatted as follows:\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-...-+-+-+-+-+-+-+\n      |       vendor-class-len        |          opaque-data          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-...-+-+-+-+-+-+-+\n\n                Figure 27: Format of vendor-class-data Field\n\n   The vendor-class-len field is 2 octets long and specifies the length\n   of the opaque vendor-class-data in network byte order.\n\n   Servers and clients MUST NOT include more than one instance of\n   OPTION_VENDOR_CLASS with the same Enterprise Number.  Each instance\n   of OPTION_VENDOR_CLASS can carry multiple vendor-class-data\n   instances.\n\n\n21.17. Vendor-specific Information Option\n\n   This option is used by clients and servers to exchange vendor-\n   specific information.\n\n   The format of the Vendor-specific Information option is:\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |      OPTION_VENDOR_OPTS       |           option-len          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                       enterprise-number                       |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      .                                                               .\n      .                       vendor-option-data                      .\n      .                                                               .\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n            Figure 28: Vendor-specific Information Option Format\n\n   option-code             OPTION_VENDOR_OPTS (17).\n\n   option-len              4 + length of vendor-option-data field.\n\n   enterprise-number       The vendor's registered Enterprise Number as\n                           maintained by IANA [IANA-PEN ].  A 4-octet\n                           field containing an unsigned integer.\n\n   vendor-option-data      Vendor options, interpreted by vendor-\n                           specific code on the clients and servers.  A\n                           variable-length field (4 octets less than the\n                           value in the option-len field). \n   The definition of the information carried in this option is vendor\n   specific.  The vendor is indicated in the enterprise-number field.\n   Use of vendor-specific information allows enhanced operation,\n   utilizing additional features in a vendor's DHCP implementation.  A\n   DHCP client that does not receive requested vendor-specific\n   information will still configure the node's IPv6 stack to be\n   functional.\n\n   The vendor-option-data field MUST be encoded as a sequence of\n   code/length/value fields of format identical to the DHCP options (see Section 21.1).  The suboption codes are defined by the vendor\n   identified in the enterprise-number field and are not managed by\n   IANA.  Each of the suboptions is formatted as follows:\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |          sub-opt-code         |         suboption-len         |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      .                                                               .\n      .                        suboption-data                        .\n      .                                                               .\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                 Figure 29: Vendor-specific Options Format\n\n   sub-opt-code            The code for the suboption.  A 2-octet field.\n\n   suboption-len           An unsigned integer giving the length of the\n                           suboption-data field in this suboption in\n                           octets.  A 2-octet field.\n\n   suboption-data          The data area for the suboption.  The length,\n                           in octets, is specified by sub-option-len.\n\n   Multiple instances of the Vendor-specific Information option may\n   appear in a DHCP message.  Each instance of the option is interpreted\n   according to the option codes defined by the vendor identified by the\n   Enterprise Number in that option.  Servers and clients MUST NOT send\n   more than one instance of the Vendor-specific Information option with\n   the same Enterprise Number.  Each instance of the Vendor-specific\n   Information option MAY contain multiple suboptions.\n\n   A client that is interested in receiving a Vendor-specific\n   Information option:\n\n   *  MUST specify the Vendor-specific Information option in an Option\n      Request option. \n   *  MAY specify an associated Vendor Class option (see Section 21.16).\n\n   *  MAY specify the Vendor-specific Information option with\n      appropriate data.\n\n   Servers only return the Vendor-specific Information options if\n   specified in Option Request options from clients and:\n\n   *  MAY use the Enterprise Numbers in the associated Vendor Class\n      options to restrict the set of Enterprise Numbers in the\n      Vendor-specific Information options returned.\n\n   *  MAY return all configured Vendor-specific Information options.\n\n   *  MAY use other information in the message or in its configuration\n      to determine which set of Enterprise Numbers in the Vendor-\n      specific Information options to return.\n\n\n21.18. Interface-Id Option\n\n   The relay agent MAY send the Interface-Id option to identify the\n   interface on which the client message was received.  If a relay agent\n   receives a Relay-reply message with an Interface-Id option, the relay\n   agent relays the message to the client through the interface\n   identified by the option.\n\n   The format of the Interface-Id option is:\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |      OPTION_INTERFACE_ID      |         option-len            |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      .                                                               .\n      .                         interface-id                          .\n      .                                                               .\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                   Figure 30: Interface-Id Option Format\n\n   option-code             OPTION_INTERFACE_ID (18).\n\n   option-len              Length of interface-id field.\n\n   interface-id            An opaque value of arbitrary length generated\n                           by the relay agent to identify one of the\n                           relay agent's interfaces.  The length, in\n                           octets, is specified by option-len. \n   The server MUST copy the Interface-Id option from the Relay-forward\n   message into the Relay-reply message the server sends to the relay\n   agent in response to the Relay-forward message.  This option MUST NOT\n   appear in any message except a Relay-forward or Relay-reply message.\n\n   Servers MAY use the interface-id field for parameter assignment\n   policies.  The interface-id value SHOULD be considered an opaque\n   value, with policies based on exact match only; that is, the\n   interface-id field SHOULD NOT be internally parsed by the server.\n   The interface-id value for an interface SHOULD be stable and remain\n   unchanged -- for example, after the relay agent is restarted; if the\n   interface-id value changes, a server will not be able to use it\n   reliably in parameter assignment policies.\n\n\n21.19. Reconfigure Message Option\n\n   A server includes a Reconfigure Message option in a Reconfigure\n   message to indicate to the client whether the client responds with a\n   Renew message, a Rebind message, or an Information-request message.\n   The format of the Reconfigure Message option is:\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |      OPTION_RECONF_MSG        |         option-len            |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |    msg-type   |\n      +-+-+-+-+-+-+-+-+\n\n                Figure 31: Reconfigure Message Option Format\n\n   option-code             OPTION_RECONF_MSG (19).\n\n   option-len              1.\n\n   msg-type                5 for Renew message, 6 for Rebind message,\n                           11 for Information-request message.  A\n                           1-octet unsigned integer.\n\n   The Reconfigure Message option can only appear in a Reconfigure\n   message. \n\n\n\n\n\n\n21.20. Reconfigure Accept Option\n\n   A client uses the Reconfigure Accept option to announce to the server\n   whether the client is willing to accept Reconfigure messages, and a\n   server uses this option to tell the client whether or not to accept\n   Reconfigure messages.  In the absence of this option, the default\n   behavior is that the client is unwilling to accept Reconfigure\n   messages.  The format of the Reconfigure Accept option is:\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |     OPTION_RECONF_ACCEPT      |         option-len            |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                Figure 32: Reconfigure Accept Option Format\n\n   option-code             OPTION_RECONF_ACCEPT (20).\n\n   option-len              0.\n\n\n21.21. Identity Association for Prefix Delegation Option\n\n   The IA_PD option is used to carry a prefix delegation identity\n   association, the parameters associated with the IA_PD, and the\n   prefixes associated with it.  The format of the IA_PD option is:\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |         OPTION_IA_PD          |           option-len          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                         IAID (4 octets)                       |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                              T1                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                              T2                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      .                                                               .\n      .                          IA_PD-options                        .\n      .                                                               .\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n    Figure 33: Identity Association for Prefix Delegation Option Format\n\n   option-code             OPTION_IA_PD (25).\n\n   option-len              12 + length of IA_PD-options field. \n   IAID                    The unique identifier for this IA_PD; the\n                           IAID must be unique among the identifiers for\n                           all of this client's IA_PDs.  The number\n                           space for IA_PD IAIDs is separate from the\n                           number space for other IA option types (i.e.,\n                           IA_NA).  A 4-octet field containing an\n                           unsigned integer.\n\n   T1                      The time interval after which the client\n                           should contact the server from which the\n                           prefixes in the IA_PD were obtained to extend\n                           the lifetimes of the prefixes delegated to\n                           the IA_PD; T1 is a time duration relative to\n                           the message reception time expressed in units\n                           of seconds.  A 4-octet field containing an\n                           unsigned integer.\n\n   T2                      The time interval after which the client\n                           should contact any available server to extend\n                           the lifetimes of the prefixes assigned to the\n                           IA_PD; T2 is a time duration relative to the\n                           message reception time expressed in units of\n                           seconds.  A 4-octet field containing an\n                           unsigned integer.\n\n   IA_PD-options           Options associated with this IA_PD.  A\n                           variable-length field (12 octets less than\n                           the value in the option-len field).\n\n   The IA_PD-options field encapsulates those options that are specific\n   to this IA_PD.  For example, all of the IA Prefix options (see Section 21.22) carrying the prefixes associated with this IA_PD are\n   in the IA_PD-options field.\n\n   An IA_PD option may only appear in the options area of a DHCP\n   message.  A DHCP message may contain multiple IA_PD options (though\n   each must have a unique IAID).\n\n   The status of any operations involving this IA_PD is indicated in a\n   Status Code option (see Section 21.13) in the IA_PD-options field.\n\n   Note that an IA_PD has no explicit \"lifetime\" or \"lease length\" of\n   its own.  When the valid lifetimes of all of the prefixes in an IA_PD\n   have expired, the IA_PD can be considered as having expired.  T1 and\n   T2 fields are included to give the server explicit control over when\n   a client should contact the server about a specific IA_PD. \n   In a message sent by a client to a server, the T1 and T2 fields\n   SHOULD be set to 0.  The server MUST ignore any values in these\n   fields in messages received from a client.\n\n   In a message sent by a server to a client, the client MUST use the\n   values in the T1 and T2 fields for the T1 and T2 timers, unless\n   values in those fields are 0.  The values in the T1 and T2 fields are\n   the number of seconds until T1 and T2.\n\n   The server selects the T1 and T2 times to allow the client to extend\n   the lifetimes of any prefixes in the IA_PD before the lifetimes\n   expire, even if the server is unavailable for some short period of\n   time.  Recommended values for T1 and T2 are 0.5 and 0.8 times the\n   shortest preferred lifetime of the prefixes in the IA_PD that the\n   server is willing to extend, respectively.  If the time at which the\n   prefixes in an IA_PD are to be renewed is to be left to the\n   discretion of the client, the server sets T1 and T2 to 0.  The client\n   MUST follow the rules defined in Section 14.2.\n\n   If a client receives an IA_PD with T1 greater than T2 and both T1 and\n   T2 are greater than 0, the client discards the IA_PD option and\n   processes the remainder of the message as though the server had not\n   included the IA_PD option.\n\n\n21.22. IA Prefix Option\n\n   The IA Prefix option is used to specify a prefix associated with an\n   IA_PD.  The IA Prefix option must be encapsulated in the\n   IA_PD-options field of an IA_PD option (see Section 21.21). \n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |        OPTION_IAPREFIX        |           option-len          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                      preferred-lifetime                       |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                        valid-lifetime                         |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      | prefix-length |                                               |\n      +-+-+-+-+-+-+-+-+          IPv6-prefix                          |\n      |                           (16 octets)                         |\n      |                                                               |\n      |                                                               |\n      |                                                               |\n      |               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |               |                                               .\n      +-+-+-+-+-+-+-+-+                                               .\n      .                       IAprefix-options                        .\n      .                                                               .\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                     Figure 34: IA Prefix Option Format\n\n   option-code             OPTION_IAPREFIX (26).\n\n   option-len              25 + length of IAprefix-options field.\n\n   preferred-lifetime      The preferred lifetime for the prefix in the\n                           option, expressed in units of seconds.  A\n                           value of 0xffffffff represents \"infinity\"\n                           (see Section 7.7).  A 4-octet field\n                           containing an unsigned integer.\n\n   valid-lifetime          The valid lifetime for the prefix in the\n                           option, expressed in units of seconds.  A\n                           value of 0xffffffff represents \"infinity\".  A\n                           4-octet field containing an unsigned integer.\n\n   prefix-length           Length for this prefix in bits.  A 1-octet\n                           unsigned integer.\n\n   IPv6-prefix             An IPv6 prefix.  A 16-octet field.\n\n   IAprefix-options        Options associated with this prefix.  A\n                           variable-length field (25 octets less than\n                           the value in the option-len field). \n   In a message sent by a client to a server, the preferred-lifetime and\n   valid-lifetime fields SHOULD be set to 0.  The server MUST ignore any\n   received values in these lifetime fields.\n\n   The client SHOULD NOT send an IA Prefix option with 0 in the\n   \"prefix-length\" field (and an unspecified value (::) in the\n   \"IPv6-prefix\" field).  A client MAY send a non-zero value in the\n   \"prefix-length\" field and the unspecified value (::) in the\n   \"IPv6-prefix\" field to indicate a preference for the size of the\n   prefix to be delegated.  See [RFC8168] for further details on prefix-\n   length hints.\n\n   The client MUST discard any prefixes for which the preferred lifetime\n   is greater than the valid lifetime.\n\n   The values in the preferred-lifetime and valid-lifetime fields are\n   the number of seconds remaining in each lifetime.  See Section 18.2.10.1 for more details on how these values are used for\n   delegated prefixes.\n\n   As per Section 7.7, the value of 0xffffffff for the preferred\n   lifetime or the valid lifetime is taken to mean \"infinity\" and should\n   be used carefully.\n\n   An IA Prefix option may appear only in an IA_PD option.  More than\n   one IA Prefix option can appear in a single IA_PD option.\n\n   The status of any operations involving this IA Prefix option is\n   indicated in a Status Code option (see Section 21.13) in the\n   IAprefix-options field.\n\n\n21.23. Information Refresh Time Option\n\n   This option is requested by clients and returned by servers to\n   specify an upper bound for how long a client should wait before\n   refreshing information retrieved from a DHCP server.  It is only used\n   in Reply messages in response to Information-request messages.  In\n   other messages, there will usually be other information that\n   indicates when the client should contact the server, e.g., T1/T2\n   times and lifetimes.  This option is useful when the configuration\n   parameters change or during a renumbering event, as clients running\n   in the stateless mode will be able to update their configuration.\n\n   The format of the Information Refresh Time option is:\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |OPTION_INFORMATION_REFRESH_TIME|         option-len            |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                   information-refresh-time                    |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n             Figure 35: Information Refresh Time Option Format\n\n   option-code                   OPTION_INFORMATION_REFRESH_TIME (32).\n\n   option-len                    4.\n\n   information-refresh-time      Time duration relative to the current\n                                 time, expressed in units of seconds.  A\n                                 4-octet field containing an unsigned\n                                 integer.\n\n   A DHCP client MUST request this option in the Option Request option\n   (see Section 21.7) when sending Information-request messages.  A\n   client MUST NOT request this option in the Option Request option in\n   any other messages.\n\n   A server sending a Reply to an Information-request message SHOULD\n   include this option if it is requested in the Option Request option\n   of the Information-request.  The option value MUST NOT be smaller\n   than IRT_MINIMUM.  This option MUST only appear in the top-level\n   options area of Reply messages.\n\n   If the Reply to an Information-request message does not contain this\n   option, the client MUST behave as if the option with the value\n   IRT_DEFAULT was provided.\n\n   A client MUST use the refresh time IRT_MINIMUM if it receives the\n   option with a value less than IRT_MINIMUM.\n\n   As per Section 7.7, the value 0xffffffff is taken to mean \"infinity\"\n   and implies that the client should not refresh its configuration data\n   without some other trigger (such as detecting movement to a new\n   link).\n\n   If a client contacts the server to obtain new data or refresh some\n   existing data before the refresh time expires, then it SHOULD also\n   refresh all data covered by this option. \n   When the client detects that the refresh time has expired, it SHOULD\n   try to update its configuration data by sending an\n   Information-request as specified in Section 18.2.6, except that the\n   client MUST delay sending the first Information-request by a random\n   amount of time between 0 and INF_MAX_DELAY.\n\n   A client MAY have a maximum value for the refresh time, where that\n   value is used whenever the client receives this option with a value\n   higher than the maximum.  This also means that the maximum value is\n   used when the received value is \"infinity\".  A maximum value might\n   make the client less vulnerable to attacks based on forged DHCP\n   messages.  Without a maximum value, a client may be made to use wrong\n   information for a possibly infinite period of time.  There may,\n   however, be reasons for having a very long refresh time, so it may be\n   useful for this maximum value to be configurable.\n\n\n21.24. SOL_MAX_RT Option\n\n   A DHCP server sends the SOL_MAX_RT option to a client to override the\n   default value of SOL_MAX_RT.  The value of SOL_MAX_RT in the option\n   replaces the default value defined in Section 7.6.  One use for the\n   SOL_MAX_RT option is to set a higher value for SOL_MAX_RT; this\n   reduces the Solicit traffic from a client that has not received a\n   response to its Solicit messages.\n\n   The format of the SOL_MAX_RT option is:\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |      OPTION_SOL_MAX_RT        |         option-len            |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                       SOL_MAX_RT value                        |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                    Figure 36: SOL_MAX_RT Option Format\n\n   option-code             OPTION_SOL_MAX_RT (82).\n\n   option-len              4.\n\n   SOL_MAX_RT value        Overriding value for SOL_MAX_RT in seconds;\n                           MUST be in this range: 60 <= \"value\" <= 86400\n                           (1 day).  A 4-octet field containing an\n                           unsigned integer.\n\n   A DHCP client MUST include the SOL_MAX_RT option code in any Option\n   Request option (see Section 21.7) it sends in a Solicit message. \n   The DHCP server MAY include the SOL_MAX_RT option in any response it\n   sends to a client that has included the SOL_MAX_RT option code in an\n   Option Request option.  The SOL_MAX_RT option is sent as a top-level\n   option in the message to the client.\n\n   A DHCP client MUST ignore any SOL_MAX_RT option values that are less\n   than 60 or more than 86400.\n\n   If a DHCP client receives a message containing a SOL_MAX_RT option\n   that has a valid value for SOL_MAX_RT, the client MUST set its\n   internal SOL_MAX_RT parameter to the value contained in the\n   SOL_MAX_RT option.  This value of SOL_MAX_RT is then used by the\n   retransmission mechanism defined in Sections 15 and 18.2.1.\n\n   The purpose of this mechanism is to give network administrators a way\n   to avoid excessive DHCP traffic if all DHCP servers become\n   unavailable.  Therefore, this value is expected to be retained for as\n   long as practically possible.\n\n   An updated SOL_MAX_RT value applies only to the network interface on\n   which the client received the SOL_MAX_RT option.\n\n\n21.25. INF_MAX_RT Option\n\n   A DHCP server sends the INF_MAX_RT option to a client to override the\n   default value of INF_MAX_RT.  The value of INF_MAX_RT in the option\n   replaces the default value defined in Section 7.6.  One use for the\n   INF_MAX_RT option is to set a higher value for INF_MAX_RT; this\n   reduces the Information-request traffic from a client that has not\n   received a response to its Information-request messages.\n\n   The format of the INF_MAX_RT option is:\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |      OPTION_INF_MAX_RT        |         option-len            |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                       INF_MAX_RT value                        |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                    Figure 37: INF_MAX_RT Option Format\n\n   option-code             OPTION_INF_MAX_RT (83).\n\n   option-len              4.\n\n   INF_MAX_RT value        Overriding value for INF_MAX_RT in seconds;\n                           MUST be in this range: 60 <= \"value\" <= 86400\n                           (1 day).  A 4-octet field containing an\n                           unsigned integer.\n\n   A DHCP client MUST include the INF_MAX_RT option code in any Option\n   Request option (see Section 21.7) it sends in an Information-request\n   message.\n\n   The DHCP server MAY include the INF_MAX_RT option in any response it\n   sends to a client that has included the INF_MAX_RT option code in an\n   Option Request option.  The INF_MAX_RT option is a top-level option\n   in the message to the client.\n\n   A DHCP client MUST ignore any INF_MAX_RT option values that are less\n   than 60 or more than 86400.\n\n   If a DHCP client receives a message containing an INF_MAX_RT option\n   that has a valid value for INF_MAX_RT, the client MUST set its\n   internal INF_MAX_RT parameter to the value contained in the\n   INF_MAX_RT option.  This value of INF_MAX_RT is then used by the\n   retransmission mechanism defined in Sections 15 and 18.2.6.\n\n   An updated INF_MAX_RT value applies only to the network interface on\n   which the client received the INF_MAX_RT option.\n\n\n22. Implementation status\n\n   NOTE TO RFC EDITOR: Please remove this section before publication.\n   It is intended for the IESG evaluation.\n\n   This section records the status of known implementations of the\n   protocol defined by this specification at the time of posting of this\n   Internet-Draft, and is based on a proposal described in RFC 7942.\n   The description of implementations in this section is intended to\n   assist the IETF in its decision processes in progressing drafts to\n   RFCs.  Please note that the listing of any individual implementation\n   here does not imply endorsement by the IETF.  Furthermore, no effort\n   has been spent to verify the information presented here that was\n   supplied by IETF contributors.  This is not intended as, and must not\n   be construed to be, a catalog of available implementations or their\n   features.  Readers are advised to note that other implementations may\n   exist. \n   According to RFC 7942, \"this will allow reviewers and working groups\n   to assign due consideration to documents that have the benefit of\n   running code, which may serve as evidence of valuable experimentation\n   and feedback that have made the implemented protocols more mature.\n   It is up to the individual working groups to use this information as\n   they see fit\".\n\n   The DHCPv6 protocol was originally published as RFC 3315 in July\n   2003.  Many extensions were defined and RFC 8415 was published in\n   November 2018.  The protocol was implemented by many vendors that\n   claim DHCPv6 compliance.  It is sometimes difficult to determine\n   whether full compliance with 8415 is claimed.\n\n   The DHCPv6 protocol enjoys multiple interoperable implementations\n   from all sectors of industry.  There are many open source and\n   proprietary implementations, both general software and hardware-\n   specific.  The following implementations (listed alphabetically) are\n   known to support DHCPv6:\n\n   *  Android (Google): In March 2023 (IETF'115) Google revealed it is\n      working on the PD client implementation for Android.  Open source.\n      Maturity: prototype.  Details are scarce, but it seems the\n      implementation will focus on PD functionality.  Source:https://datatracker.ietf.org/meeting/116/materials/slides-116-\n      v6ops-using-dhcp-pd-to-allocate-64-per-host-in-broadcast-networks-      00, slide 17.\n\n   *  Cisco Prime Network Registrar: Cisco's software suite that\n      supports many protocols, including RFC8415 compliant server\n      functionality.  Proprietary.  Maturity: widely used.  One of the\n      authors of this I-D was heavily involved in CPNR development.\n      Source: https://www.cisco.com/c/en/us/products/collateral/cloud-\n      systems-management/prime-network-registrar/datasheet-      c78-729989.html.\n\n   *  dhcpcd: Client implementation.  Works on many Linux and BSD\n      distributions, but seems to be the default client for various BSD\n      flavors.  Open source (BSD).  Maturity: widely used, in particular\n      on BSD systems.  Source: https://github.com/NetworkConfiguration/\n      dhcpcd  .\n\n   *  dhcpd (ISC): Client, relay and server implementation, present in\n      most Linux and BSD distributions.  Open source (Mozilla Public\n      License v2).  The project is no longer developed, but the software\n      is still in wide use.  Source: https://www.isc.org/dhcp/ . \n   *  dibbler: Client, relay and server implementation.  Limited\n      compatibility with RFC8415.  Open source (GNU GPLv2).  The project\n      is no longer developed, but the software is still in wide use.\n      The biggest known deployment is 16 million devices.  One of the\n      authors of this I-D was the leading developer.  Source:https://klub.com.pl/dhcpv6/ .\n\n   *  dnsmasq: Probably the most popular implementation in terms of\n      number of devices.  Very popular among CPE and various home\n      appliances.  Client and server implementation with some relay\n      capabilities.  Open source (GPL v2 or v3).  Source:https://dnsmasq.org/ .\n\n   *  EdgeMax (Ubiquiti): Proprietary implementation running on EdgeMax\n      hardware, home and small enterprise gateways and switches.\n      Focused on DHCPv6-PD.  Source: https://help.ui.com/hc/en-us/\n      articles/115002531728-EdgeRouter-Beginners-Guide-to-EdgeRouter .\n\n   *  EOS (Arista): Proprietary implementation for network switches,\n      routers and other networking hardware.  RFC8415 support explicitly\n      stated.  Server, client, relay implementation.  Source:https://www.arista.com/en/um-eos/eos-ipv6 .\n\n   *  FreeRADIUS: RADIUS implementation that also provides DHCPv6 server\n      functionality.  Open source.\n\n   *  Huawei: Server, client and relay functionalities are available on\n      most routers and switches.  Proprietary.  Source:https://support.huawei.com/hedex/\n      hdx .do?docid=EDOC1100247463&id=EN-US_TASK_0176372622, see\n      \"Configuring Server/Relay/client/PD client\" on the left panel.\n\n   *  iOS (Apple): Client implementation running on Apple portable\n      devices (iPhones, iPads, etc.).  Proprietary.  The implementation\n      is widely used.\n\n   *  IOS (Cisco): Server, relay, and client implementation that runs on\n      Cisco routers, switches and other networking hardware.\n      Proprietary.  Widely used.  Source:https://community.cisco.com/t5/networking-knowledge-base/part-1-\n      implementing-dhcpv6-stateful-dhcpv6/ta-p/3145631 .\n\n   *  Kea (ISC): Server implementation.  Open source (Mozilla Public\n      License v2).  It is a modern replacement for now retired isc-dhcp.\n      More than 500 users subscribed to the mailing list.  One of the\n      authors of this I-D is the lead developer.  Source:https://kea.readthedocs.io/en/kea-2.4.0/arm/dhcp6-\n      srv.html#supported-dhcpv6-standards  . \n   *  JunOS (Juniper): Server, relay, and client implementation that\n      runs on Juniper routers, switches, and other networking hardware.\n      Proprietary.  Widely used.  Source:https://www.juniper.net/documentation/us/en/software/junos/dhcp/\n      topics/topic-map/dhcpv6-server.html  .\n\n   *  macOS (Apple): Client implementation for Macs (laptops and\n      desktops).  Proprietary.  Widely used.\n\n   *  odhcp6c (OpenWRT): Minimalistic client implementation intended for\n      embedded environment.  Open source (GPL-2).  Source:https://github.com/openwrt/odhcp6c  .\n\n   *  RouterOS (Mikrotik): Server, relay, and client implementation\n      running on Mikrotik networking hardware (routers, switches, many\n      other appliances).  Proprietary.  Sources:https://wiki.mikrotik.com/wiki/Manual:IPv6/DHCP_Client ,https://wiki.mikrotik.com/wiki/Manual:IPv6/DHCP_Server ,https://wiki.mikrotik.com/wiki/Manual:RouterOS6_news  .\n\n   *  ServPoET (Finepoint): Server implementation.  Proprietary.  One of\n      the authors of this I-D was the lead developer.  Source:https://finepoint.com/servpoet/ .\n\n   *  udhcpc6 (busybox): Minimum footprint implementation, intended for\n      embedded devices.  It used to be a separate project (udhcpc6), but\n      it is now part of the BusyBox project.  Open source (GPL-v2).\n      Client implementation.  Source: https://udhcp.busybox.net/\n      README.udhcpc  .\n\n   *  Unifi (Ubiquiti): Server, relay, and client implementation running\n      on UniFi hardware (routers, switches, firewalls).  Proprietary.\n      Source: https://help.ui.com/hc/en-us/articles/115005868927-UniFi-\n      Gateway-Static-IPv6-and-DHCPv6-Prefix-Delegation .\n\n   *  Windows (Microsoft): Microsoft Windows provides client\n      implementation, which is probably still the most popular OS on\n      desktops and laptops.  The server version of Windows provides\n      DHCPv6 server implementation.  Proprietary.\n\n   The DHCPv6 support is also mandated by some third party specs.  For\n   example, all cable modems conformant to DOCSIS3.0 or later must\n   support DHCPv6 client functionality.\n\n   There are many large scale deployments that use DHCPv6.  One of them\n   is Comcast's Xfinity.  Authors are aware of many other large scale\n   country wide deployments, but due to signed Non-Disclosure Agreements\n   cannot list them. \n   University of New Hampshire's InterOperability Laboratory runs USGv6\n   Testing Program.  Testing DHCPv6 compliance is one aspect of the\n   program.\n\n   While the original IPv6 Ready Logo testing involved the original\n   DHCPv6 specifications (primarily RFC3315, RFC3633), the large number\n   of tested and certified implementations supports the breadth and\n   depth of DHCPv6 implementations available and deployed in the\n   marketplace over the years that confirm the protocol specifications\n   are up to Internet Standard.  See https://www.ipv6ready.org/db/index.php/public/   search/?l=&c=&ds=&de=&pc=&ap=2&oem=&etc=D&fw=&vn=&do=1&o=6.-\n\n23. Security Considerations\n\n   This section discusses security considerations that are not related\n   to privacy.  See Section 24 for a discussion dedicated to privacy.\n\n   The threat to DHCP is inherently an insider threat (assuming a\n   properly configured network where DHCP ports are blocked on the\n   perimeter gateways of the enterprise).  Regardless of the gateway\n   configuration, however, the potential attacks by insiders and\n   outsiders are the same.\n\n   DHCP lacks end-to-end encryption between clients and servers; thus,\n   hijacking, tampering, and eavesdropping attacks are all possible as a\n   result.  Some network environments (discussed below) can be secured\n   through various means to minimize these attacks.\n\n   The threat common to both the client and the server is the \"resource-\n   exhaustion\" DoS attack.  These attacks typically involve the\n   exhaustion of available assigned addresses or delegatable prefixes,\n   or the exhaustion of CPU or network bandwidth, and are present any\n   time there is a shared resource.  Some forms of these exhaustion\n   attacks can be partially mitigated by appropriate server policy,\n   e.g., limiting the maximum number of leases any one client can get,\n   limiting the number of leases one client can decline, and limiting\n   number of messages a single client can transmit of a period of time.\n\n23.1. Client Security Considerations\n\n   One attack specific to a DHCP client is the establishment of a\n   malicious server with the intent of providing incorrect configuration\n   information to the client.  The motivation for doing so may be to\n   mount a \"man in the middle\" attack that causes the client to\n   communicate with a malicious server instead of a valid server for\n   some service (such as DNS or NTP).  The malicious server may also\n   mount a DoS attack through misconfiguration of the client; this \n   attack would cause all network communication from the client to fail.\n\n   A malicious DHCP server might cause a client to set its SOL_MAX_RT\n   and INF_MAX_RT parameters to an unreasonably high value with the\n   SOL_MAX_RT (see Section 21.24) and INF_MAX_RT (see Section 21.25)\n   options; this may cause an undue delay in a client completing its\n   DHCP protocol transaction in the case where no other valid response\n   is received.  Assuming that the client also receives a response from\n   a valid DHCP server, large values for SOL_MAX_RT and INF_MAX_RT will\n   not have any effect.\n\n   Another threat to DHCP clients originates from mistakenly or\n   accidentally configured DHCP servers that answer DHCP client requests\n   with unintentionally incorrect configuration parameters.\n\n   If a client implementation supports the reconfigure mechanism, also\n   see Section 23.3 below.\n\n\n23.2. Server Security Considerations\n\n   The threat specific to a DHCP server is an invalid client\n   masquerading as a valid client.  The motivation for this may be for\n   theft of service, or to circumvent auditing for any number of\n   nefarious purposes.\n\n   The messages exchanged between relay agents and servers may be used\n   to mount a man-in-the-middle or DoS attack.  Communication between a\n   server and a relay agent, and communication between relay agents, can\n   be authenticated and encrypted through the use of IPsec, as described\n   in [RFC8213].\n\n   However, the use of manually configured pre-shared keys for IPsec\n   between relay agents and servers does not defend against replayed\n   DHCP messages.  Replayed messages can represent a DoS attack through\n   exhaustion of processing resources but not through misconfiguration\n   or exhaustion of other resources such as assignable addresses and\n   delegatable prefixes.\n\n   If a server implementation supports the reconfigure mechanism, also\n   see Section 23.3 below.\n\n\n23.3. Reconfigure Security Considerations\n\n   RKAP, described in Section 20.4, provides protection against the use\n   of a Reconfigure message by a malicious DHCP server to mount a DoS or\n   man-in-the-middle attack on a client.  This protocol can be\n   compromised by an attacker that can intercept the initial message in\n   which the DHCP server sends the key as plain text to the client. \n   Because of the opportunity for attack through the Reconfigure\n   message, a DHCP client MUST discard any Reconfigure message that does\n   not include authentication or that does not pass the validation\n   process for the authentication protocol.\n\n   A DHCP client may also be subject to attack through the receipt of a\n   Reconfigure message from a malicious server that causes the client to\n   obtain incorrect configuration information from that server.  Note\n   that although a client sends its response (Renew, Rebind, or\n   Information-request message) through a relay agent and, therefore,\n   that response will only be received by servers to which DHCP messages\n   are relayed, a malicious server could send a Reconfigure message to a\n   client, followed (after an appropriate delay) by a Reply message that\n   would be accepted by the client.  Thus, a malicious server that is\n   not on the network path between the client and the server may still\n   be able to mount a Reconfigure attack on a client.  The use of\n   transaction IDs that are cryptographically sound and cannot easily be\n   predicted will also reduce the probability that such an attack will\n   be successful.\n\n\n23.4. Mitigation Considerations\n\n   Various network environments also offer levels of security if\n   deployed as described below.\n\n   *  In enterprise and factory networks, use of authentication per\n      [IEEE-802.1x ] can prevent unknown or untrusted clients from\n      connecting to the network.  However, this does not necessarily\n      assure that the connected client will be a good DHCP or network\n      actor.\n\n   *  For wired networks where clients typically are connected to a\n      switch port, snooping DHCP multicast (or unicast) traffic becomes\n      difficult, as the switches limit the traffic delivered to a port.\n      The client's DHCP multicast messages (with destination address\n      fe02::1:2) are only forwarded to the DHCP server's (or relay's)\n      switch port -- not all ports.  Also, the server's (or relay's)\n      unicast replies are only delivered to the target client's port --\n      not all ports.\n\n   *  In public networks (such as a Wi-Fi network in a coffee shop or\n      airport), it is possible for others within radio range to snoop\n      DHCP and other traffic.  But in these environments, there is very\n      little if anything that can be learned from the DHCP traffic\n      itself (either from client to server or from server to client) if\n      the privacy considerations provided in Section 24 are followed.\n      Even for devices that do not follow the privacy considerations,\n      there is little that can be learned that would not be available \n      from subsequent communications anyway (such as the device's Media\n      Access Control (MAC) address).  Also, because all clients will\n      typically receive similar configuration details, a bad actor that\n      initiates a DHCP request itself can learn much of such\n      information.  As mentioned above, one threat is that the RKAP key\n      for a client can be learned (if the initial\n      Solicit/Advertise/Request/Reply exchange is monitored) and trigger\n      a premature reconfiguration, but this is relatively easily\n      prevented by disallowing direct client-to-client communication on\n      these networks or using [RFC7610] and [RFC7513].\n\n   Many of the attacks by rogue servers can be mitigated by making use\n   of the mechanisms described in [RFC7610] and [RFC7513].\n\n\n24. Privacy Considerations\n\n   For an extended discussion about privacy considerations for the\n   client, see [RFC7824]:\n\n   *  In particular, its Section 3 discusses various identifiers that\n      could be misused to track the client.\n\n   *  Its Section 4 discusses existing mechanisms that may have an\n      impact on a client's privacy.\n\n   *  Finally, its Section 5 discusses potential attack vectors.\n\n   For recommendations regarding how to address or mitigate those\n   issues, see [RFC7844].\n\n   This specification does not define any allocation strategies for\n   servers.  Implementers are expected to develop their own algorithm\n   for the server to choose a resource out of the available pool.\n   Several possible allocation strategies are mentioned in Section 4.3\n   of [RFC7824].  Please keep in mind that the list in [RFC7824] is not\n   exhaustive; there are certainly other possible strategies.  Readers\n   are also encouraged to read [RFC7707] -- in particular, its Section 4.1.2, which discusses the problems with certain allocation\n   strategies.\n\n25. IANA Considerations\n\n   This document does not define any new DHCP name spaces or\n   definitions.\n\n   The publication of this document does not change the assignment rules\n   for new values for message types, option codes, DUID types, or status\n   codes. \n   The list of assigned values used in DHCPv6 is available at\n   <https://www.iana.org/assignments/dhcpv6-parameters >.\n\n   IANA is requested to update all references to [RFC8415] to this\n   document at <https://www.iana.org/assignments/dhcpv6-parameters >.\n\n   IANA is requested to add a new column \"Status\" to all registries on\n   the DHCPv6 parameters page at <https://www.iana.org/assignments/\n   dhcpv6-parameters > and leave each entry blank except as indicated\n   below:\n\n   *  In the Option Code registry, set the \"Status\" column value to\n      \"Obsolete\" for the IA_TA (option code 4) and UNICAST (option code\n      12) rows.\n\n   *  In the Status Codes registry, set the \"Status\" column value to\n      \"Obsolete\" for the UseMulticast (status code 5) row.\n\n   IANA is requested to update other references to [RFC8415] with\n   references to this document at:\n\n   *  https://www.iana.org/assignments/auth-namespaces  (four entries)\n\n   *  https://www.iana.org/assignments/bootp-dhcp-parameters  (two\n      entries)\n\n   *  https://www.iana.org/assignments/ipv6-multicast-addresses  (two\n      entries)\n\n   *  https://www.iana.org/assignments/service-names-port-numbers  (two\n      entries; UDP ports 546 and 547)\n\nA. Summary of Changes\n\n   This appendix provides a summary of the changes made from RFC8415:\n\n   1.  The following mechanisms were obsoleted.  These were not widely\n       deployed while adding complexity to client and server\n       implementations.  Legacy implementations MAY support them, but\n       implementations conformant to this document MUST NOT rely on\n       them.  Obsoleting these features does not cause any\n       interoperatability issues when mixing updated and non-updated\n       clients, relay agents, and servers as these mechanisms were\n       \"optional\".\n\n       IA_TA option.  The Identity Association for Temporary Addresses\n          option has been obsoleted.  A client that needs a short-term /\n          special purpose address can use a new IA_NA binding to request\n          an address and release it when finished with it.\n\n       UNICAST option.  The Server Unicast option has been obsoleted.\n          Use of this was rarely practical as typically relay agents\n          between the client and server need to glean information from\n          the communication and cannot be bypassed.\n\n       UseMulticast status code.  The UseMulticast status code has been\n          obsoleted.  Clients will always multicast messages (as Server\n          Unicast option has been obsoleted) and servers will no longer\n          check for unicast traffic.\n\n   2.  The following errata for RFC 8415 were incorporated: erratum IDs\n       6159, 6269 and 6183.  Note that erratum ID 6269 was no longer\n       applicable after the Server Unicast Option was obsoleted.  Note\n       that erratum 6159 is also no longer applicable now that temporary\n       addresses have been obsoleted.  Indeed, the section (6.5) that\n       erratum 6159 corrects has been deleted. \n   3.  A reference to RFC 7943 was added to Section 13.1 as it documents\n       a method that might be used to generate addresses and was\n       inadvertently missed when compiling RFC 8415.\n\n   4.  Clarified the UDP ports used by clients, servers, and relay\n       agents (Section 7.2).\n\n   5.  Several additional RFCs have been referenced and editorial and\n       reviews comments incorporated.\n\nB. Appearance of Options in Message Types\n\n   The following tables indicate with a \"*\" the options that are allowed\n   in each DHCP message type.\n\n   These tables are informational.  If they conflict with text earlier\n   in this document, that text should be considered authoritative.\n\n           Client Server                         Elap. Relay\n             ID     ID   IA_NA IA_PD  ORO   Pref Time   Msg. Auth.\n   Solicit   *             *     *     *           *\n   Advert.   *      *      *     *           *\n   Request   *      *      *     *     *           *\n   Confirm   *             *                       *\n   Renew     *      *      *     *     *           *\n   Rebind    *             *     *     *           *\n   Decline   *      *      *     *                 *\n   Release   *      *      *     *                 *\n   Reply     *      *      *     *                             *\n   Reconf.   *      *                                          *\n   Inform.   * (see note)              *           *\n   R-forw.                                               *\n   R-repl.                                               *\n\n   NOTE: The Server Identifier option (see Section 21.3) is only\n   included in Information-request messages that are sent in response to\n   a Reconfigure (see Section 18.2.6). \n                                                                  Info\n           Status  Rap. User  Vendor Vendor Inter. Recon. Recon. Refresh\n            Code  Comm. Class Class  Spec.    ID    Msg.  Accept  Time\n   Solicit          *     *     *      *                    *\n   Advert.   *            *     *      *                    *\n   Request                *     *      *                    *\n   Confirm                *     *      *\n   Renew                  *     *      *                    *\n   Rebind                 *     *      *                    *\n   Decline                *     *      *\n   Release                *     *      *\n   Reply     *      *     *     *      *                    *        *\n   Reconf.                                           *\n   Inform.                *     *      *                    *\n   R-forw.                             *      *\n   R-repl.                             *      *\n\n           SOL_MAX_RT  INF_MAX_RT\n   Solicit\n   Advert.    *\n   Request\n   Confirm\n   Renew\n   Rebind\n   Decline\n   Release\n   Reply      *           *\n   Reconf.\n   Inform.\n   R-forw.\n   R-repl.\n\nC. Appearance of Options in the \"options\" Field of DHCP\n\n             Options\n\n\n",
    "structured_content": {
      "1": {
        "title": "Introduction",
        "content": "   This document specifies DHCP for IPv6 (DHCPv6), a client/server\n   protocol that provides managed configuration of devices.  The basic\n   operation of DHCPv6 provides configuration for clients connected to\n   the same link as the server.  Relay agent functionality is also\n   defined for enabling communication between clients and servers that\n   are not on the same link.\n\n   DHCPv6 can provide a device with addresses assigned by a DHCPv6\n   server and other configuration information; this data is carried in\n   options.  DHCPv6 can be extended through the definition of new\n   options to carry configuration information not specified in this\n   document.\n\n   DHCPv6 also supports a mechanism for automated delegation of IPv6\n   prefixes.  Through this mechanism, a server can delegate prefixes to\n   clients.  Use of this mechanism is specified as part of [RFC7084] and\n   by [TR-187].  Note that these documents use \"requesting router\" for\n   what this document uses client and \"delegating router\" for server.\n\n   DHCP can also be used just to provide other configuration options\n   (i.e., no addresses or prefixes).  That implies that the server does\n   not have to track any state; thus, this mode is called \"stateless\n   DHCPv6\".  Mechanisms necessary to support stateless DHCPv6 are much\n   simpler than mechanisms needed to support stateful DHCPv6.",
        "children": {
          "1.1": {
            "title": "Relationship to Previous DHCPv6 Standards",
            "content": "   [RFC8415] provided a unified, corrected, and cleaned-up definition of\n   DHCPv6 that also covered all applicable errata filed against older\n   RFCs.  It also obsoleted a small number of mechanisms: delayed\n   authentication, lifetime and timer hints sent by a client.\n\n   This document obsoletes [RFC8415] by applying all applicable errata\n   and obsoleting two features that have not been widely implemented -\n   the assignment of temporary addresses using the IA_TA option and\n   allowing clients to unicast some messages directly to the server if\n   the server sent the Server Unicast option to a client in an early\n   exchange.  It also clarifies the UDP ports used by clients, servers,\n   and relay agents (Section 7.2).  See Appendix A  for a list of\n   differences from [RFC8415]. \n\n\n\n",
            "children": {}
          },
          "1.2": {
            "title": "Topics Out of Scope",
            "content": "   This document specifies the DHCPv6 protocol behavior.  The server\n   policy, such as what options to assign to which clients, which\n   subnets or pools of resources to use, which clients' requests should\n   be denied etc. are out of scope for this document.\n\n   Server configuration, operation and management are also out of scope.\n   An approach to manage DHCPv6 relays and servers is specified in\n   [RFC9243].\n\n   Merging DHCPv4 [RFC2131] and DHCPv6 configuration is out of scope for\n   this document.  [RFC4477] discusses some issues and possible\n   strategies for running DHCPv4 and DHCPv6 services together.  While\n   [RFC4477] is a bit dated, it provides a good overview of the issues\n   at hand.  The current consensus of the IETF is that DHCPv4 should be\n   used rather than DHCPv6 when conveying IPv4 configuration information\n   to nodes.  For IPv6-only networks, [RFC7341] describes a transport\n   mechanism to carry DHCPv4 messages using the DHCPv6 protocol for the\n   dynamic provisioning of IPv4 address and configuration information.",
            "children": {}
          }
        }
      },
      "2": {
        "title": "Requirements",
        "content": "   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"NOT RECOMMENDED\", \"MAY\", and\n   \"OPTIONAL\" in this document are to be interpreted as described in BCP 14 [RFC2119] [RFC8174] when, and only when, they appear in all\n   capitals, as shown here.\n\n   This document also makes use of internal conceptual variables to\n   describe protocol behavior and external variables that an\n   implementation must allow system administrators to change.  The\n   specific variable names, how their values change, and how their\n   settings influence protocol behavior are provided to demonstrate\n   protocol behavior.  An implementation is not required to have them in\n   the exact form described here, as long as its external behavior is\n   consistent with that described in this document.",
        "children": {},
        "decomposed_content": [
          {
            "text": "   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"NOT RECOMMENDED\", \"MAY\", and\n   \"OPTIONAL\" in this document are to be interpreted as described in BCP 14 [RFC2119] [RFC8174] when, and only when, they appear in all\n   capitals, as shown here.",
            "references": [
              {
                "rfc_number": "RFC2119",
                "section_id": "8"
              },
              {
                "rfc_number": "RFC8174",
                "section_id": "2"
              }
            ],
            "external_references": []
          },
          {
            "text": "   This document also makes use of internal conceptual variables to\n   describe protocol behavior and external variables that an\n   implementation must allow system administrators to change.  The\n   specific variable names, how their values change, and how their\n   settings influence protocol behavior are provided to demonstrate\n   protocol behavior.  An implementation is not required to have them in\n   the exact form described here, as long as its external behavior is\n   consistent with that described in this document.",
            "references": [],
            "external_references": []
          }
        ]
      },
      "3": {
        "title": "Background",
        "content": "   This section, which contained background on IPv6 specifications of\n   relevance to DHCPv6, has been removed; those interested should refer\n   to [RFC8415].  However, this section is retained to keep the major\n   section numbering consistent with [RFC8415]. \n\n\n\n",
        "children": {}
      },
      "4": {
        "title": "Terminology",
        "content": "   This section defines terminology specific to IPv6 and DHCP used in\n   this document.",
        "children": {
          "4.1": {
            "title": "IPv6 Terminology",
            "content": "   IPv6 terminology from [RFC8200], [RFC4291], and [RFC4862] relevant to\n   this specification is included below.\n\n   address                   An IP-layer identifier for an interface or\n                             a set of interfaces.\n\n   GUA                       Global unicast address (see [RFC4291]).\n\n   host                      Any node that is not a router.\n\n   IP                        Internet Protocol Version 6 (IPv6).  The\n                             terms \"IPv4\" and \"IPv6\" are used only in\n                             contexts where it is necessary to avoid\n                             ambiguity.\n\n   interface                 A node's attachment to a link.\n\n   link                      A communication facility or medium over\n                             which nodes can communicate at the link\n                             layer, i.e., the layer immediately below\n                             IP.  Examples are Ethernet (simple or\n                             bridged); Point-to-Point Protocol (PPP) and\n                             PPP over Ethernet (PPPoE) links; and\n                             Internet-layer (or higher) \"tunnels\", such\n                             as tunnels over IPv4 or IPv6 itself.\n\n   link-layer identifier     A link-layer identifier for an interface --\n                             for example, IEEE 802 addresses for\n                             Ethernet or Token Ring network interfaces.\n\n   link-local address        An IPv6 address having a link-only scope,\n                             indicated by having the prefix (fe80::/10),\n                             that can be used to reach neighboring nodes\n                             attached to the same link.  Every IPv6\n                             interface on which DHCPv6 can reasonably be\n                             useful has a link-local address.\n\n   multicast address         An identifier for a set of interfaces \n                             (typically belonging to different nodes).\n                             A packet sent to a multicast address is\n                             delivered to all interfaces identified by\n                             that address.\n\n   neighbor                  A node attached to the same link.\n\n   node                      A device that implements IP.\n\n   packet                    An IP header plus payload.\n\n   prefix                    The initial bits of an address, or a set\n                             of IP addresses that share the same\n                             initial bits.\n\n   prefix length             The number of bits in a prefix.\n\n   router                    A node that forwards IP packets not\n                             explicitly addressed to itself.\n\n   ULA                       Unique local address (see [RFC4193]).\n\n   unicast address           An identifier for a single interface.  A\n                             packet sent to a unicast address is\n                             delivered to the interface identified by\n                             that address.",
            "children": {}
          },
          "4.2": {
            "title": "DHCP Terminology",
            "content": "   Terminology specific to DHCP can be found below.\n\n   appropriate to the link   An address is \"appropriate to the link\"\n                             when the address is consistent with the\n                             DHCP server's knowledge of the network\n                             topology, prefix assignment, and address\n                             assignment policies.\n\n   binding                   A binding (or client binding) is a group of\n                             server data records containing the\n                             information the server has about the\n                             addresses or delegated prefixes in an\n                             Identity Association (IA) or configuration\n                             information explicitly assigned to the\n                             client.  Configuration information that has\n                             been returned to a client through a policy,\n                             such as the information returned to all\n                             clients on the same link, does not require\n                             a binding.  A binding containing \n                             information about an IA is indexed by the\n                             tuple <DUID, IA-type, IAID> (where IA-type\n                             is the type of lease in the IA -- for\n                             example, address or delegated prefix).  A\n                             binding containing configuration\n                             information for a client is indexed by\n                             <DUID>.  See below for definitions of DUID,\n                             IA, and IAID.\n\n   configuration parameter   An element of the configuration information\n                             set on the server and delivered to the\n                             client using DHCP.  Such parameters may be\n                             used to carry information to be used by a\n                             node to configure its network subsystem and\n                             enable communication on a link or\n                             internetwork, for example.\n\n   container option          An option that encapsulates other options\n                             (for example, the IA_NA option (see Section 21.4) may contain IA Address\n                             options (see Section 21.6)).\n\n   DHCP                      Dynamic Host Configuration Protocol for\n                             IPv6.  The terms \"DHCPv4\" and \"DHCPv6\" are\n                             used only in contexts where it is necessary\n                             to avoid ambiguity.\n\n   DHCP client               Also referred to as \"client\".  A node that\n                             initiates requests on a link to obtain\n                             configuration parameters from one or more\n                             DHCP servers.\n\n   DHCP domain               A set of links managed by DHCP and operated\n                             by a single administrative entity.\n\n   DHCP relay agent          Also referred to as \"relay agent\".  A node\n                             that acts as an intermediary to deliver\n                             DHCP messages between clients and servers.\n                             In certain configurations, there may be\n                             more than one relay agent between clients\n                             and servers, so a relay agent may send DHCP\n                             messages to another relay agent.\n\n   DHCP server               This document condenses this term to\n                             \"server\".  A node that responds to requests\n                             from clients.  It may or may not be on the\n                             same link as the client(s). \n   DUID                      A DHCP Unique Identifier for a DHCP\n                             participant.  Each DHCP client and server\n                             has exactly one DUID.  See Section 11 for\n                             details of the ways in which a DUID may be\n                             constructed.\n\n   encapsulated option       A DHCP option that is usually only\n                             contained in another option.  For example,\n                             the IA Address option is contained in IA_NA\n                             options (see Section 21.5).  See Section 9\n                             of [RFC7227] for a more complete\n                             definition.\n\n   IA                        Identity Association: a collection of\n                             leases assigned to a client.  Each IA has\n                             an associated IAID (see below).  A client\n                             may have more than one IA assigned to it --\n                             for example, one for each of its\n                             interfaces.  Each IA holds one type of\n                             lease; for example, an identity association\n                             for non-temporary addresses (IA_NA) holds\n                             addresses, and an identity association for\n                             prefix delegation (IA_PD) holds delegated\n                             prefixes.  Throughout this document, \"IA\"\n                             is used to refer to an identity association\n                             without identifying the type of a lease in\n                             the IA.  This document defines three IA\n                             types: IA_NA, IA_TA (obsoleted), and IA_PD.\n                             Another IA type (IA_LL) was defined in\n                             [RFC8947] and more may be defined.\n\n   IA option(s)              In this document, one or more IA_NA, IA_TA\n                             (obsoleted), and/or IA_PD.  Another IA type\n                             (IA_LL) was defined in [RFC8947] and more\n                             may be defined.\n\n   IAID                      Identity Association Identifier: an\n                             identifier for an IA, chosen by the client.\n                             Each IA has an IAID, which is chosen to be\n                             unique among IAIDs for IAs of a specific\n                             type that belong to that client.\n\n   IA_NA                     Identity Association for Non-temporary\n                             Addresses: an IA that carries assigned\n                             addresses.  See Section 21.4 for details on\n                             the IA_NA option.\n\n   IA_PD                     Identity Association for Prefix Delegation:\n                             an IA that carries delegated prefixes.  See Section 21.21 for details on the IA_PD\n                             option.\n\n   IA_TA                     Identity Association for Temporary\n                             Addresses: an IA that carries temporary\n                             addresses (see [RFC8981]).  This option is\n                             obsoleted by this document.  See [RFC8415]\n                             for details.\n\n   lease                     A contract by which the server grants the\n                             use of an address or delegated prefix to\n                             the client for a specified period of time.\n\n   message                   A unit of data carried as the payload of a\n                             UDP datagram, exchanged among DHCP servers,\n                             relay agents, and clients.\n\n   Reconfigure key           A key supplied to a client by a server.\n                             Used to provide security for Reconfigure\n                             messages (see Section 7.3 for the list of\n                             available message types).\n\n   relaying                  A DHCP relay agent relays DHCP messages\n                             between DHCP participants.\n\n   retransmission            Another attempt to send the same DHCP\n                             message by a client or server, as a result\n                             of not receiving a valid response to the\n                             previously sent messages.  The\n                             retransmitted message is typically modified\n                             prior to sending, as required by the DHCP\n                             specifications.  In particular, the client\n                             updates the value of the Elapsed Time\n                             option in the retransmitted message.\n\n   RKAP                      The Reconfiguration Key Authentication\n                             Protocol (see Section 20.4).\n\n   singleton option          An option that is allowed to appear only\n                             once as a top-level option or at any\n                             encapsulation level.  Most options are\n                             singletons.\n\n   T1                        The time interval after which the client is\n                             expected to contact the server that did the\n                             assignment to extend (renew) the lifetimes\n                             of the addresses assigned (via IA_NA \n                             option(s)) and/or prefixes delegated (via\n                             IA_PD option(s)) to the client.  T1 is\n                             expressed as an absolute value in messages\n                             (in seconds), is conveyed within IA\n                             containers (currently the IA_NA and IA_PD\n                             options), and is interpreted as a time\n                             interval since the message's reception.\n                             The value stored in the T1 field in IA\n                             options is referred to as the T1 value.\n                             The actual time when the timer expires is\n                             referred to as the T1 time.\n\n   T2                        The time interval after which the client is\n                             expected to contact any available server to\n                             extend (rebind) the lifetimes of the\n                             addresses assigned (via IA_NA option(s))\n                             and/or prefixes delegated (via IA_PD\n                             option(s)) to the client.  T2 is expressed\n                             as an absolute value in messages (in\n                             seconds), is conveyed within IA containers\n                             (currently the IA_NA and IA_PD options),\n                             and is interpreted as a time interval since\n                             the message's reception.  The value stored\n                             in the T2 field in IA options is referred\n                             to as the T2 value.  The actual time when\n                             the timer expires is referred to as the\n                             T2 time.\n\n   top-level option          An option conveyed in a DHCP message\n                             directly, i.e., not encapsulated in any\n                             other option, as described in Section 9 of\n                             [RFC7227].\n\n   transaction ID            An opaque value used to match responses\n                             with replies initiated by either a client\n                             or a server.",
            "children": {}
          }
        }
      },
      "5": {
        "title": "Client/Server Exchanges",
        "content": "   Clients and servers exchange DHCP messages using UDP (see [RFC0768]\n   and [BCP145]).  The client uses a link-local source address or\n   addresses determined through other mechanisms for transmitting and\n   receiving DHCP messages.\n\n   A DHCP client sends all messages using a reserved, link-scoped\n   multicast destination address (All_DHCP_Relay_Agents_and_Servers -\n   ff02::1:2) so that the client need not be configured with the address\n   or addresses of DHCP servers. \n   To allow a DHCP client to send a message to a DHCP server that is not\n   attached to the same link, a DHCP relay agent on the client's link\n   will relay messages between the client and server.  The operation of\n   the relay agent is transparent to the client.  The discussion of\n   message exchanges in the remainder of this section will omit the\n   description of the relaying of messages by relay agents.",
        "children": {
          "5.1": {
            "title": "Client/Server Exchanges Involving Two Messages",
            "content": "   When a DHCP client does not need to have a DHCP server assign IP\n   addresses or delegated prefixes to it, the client can obtain other\n   configuration information such as a list of available DNS servers\n   [RFC3646] or NTP servers [RFC5908] through a single message and reply\n   exchange with a DHCP server.  To obtain other configuration\n   information, the client first sends an Information-request message to\n   the All_DHCP_Relay_Agents_and_Servers multicast address.  Servers\n   respond with a Reply message containing the other configuration\n   information for the client.\n\n   A client may also request the server to expedite address assignment\n   and/or prefix delegation by using a two-message exchange instead of\n   the normal four-message exchange as discussed in the next section.\n   Expedited assignment can be requested by the client, and servers may\n   or may not honor the request (see Sections 18.3.1 and 21.14 for more\n   details and why servers may not honor this request).  Clients may\n   request this expedited service in environments where it is likely\n   that there is only one server available on a link and no expectation\n   that a second server would become available, or when completing the\n   configuration process as quickly as possible is a priority.\n\n   To request the expedited two-message exchange, the client sends a\n   Solicit message to the All_DHCP_Relay_Agents_and_Servers multicast\n   address requesting the assignment of addresses and/or delegated\n   prefixes and other configuration information.  This message includes\n   an indication (the Rapid Commit option; see Section 21.14) that the\n   client is willing to accept an immediate Reply message from the\n   server.  The server that is willing to commit the assignment of\n   addresses and/or delegated prefixes to the client immediately\n   responds with a Reply message.  The configuration information and the\n   addresses and/or delegated prefixes in the Reply message are then\n   immediately available for use by the client.\n\n   Each address or delegated prefix assigned to the client has\n   associated preferred and valid lifetimes specified by the server.  To\n   request an extension of the lifetimes assigned to an address or\n   delegated prefix, the client sends a Renew message to the server.\n   The server sends a Reply message to the client with the new\n   lifetimes, allowing the client to continue to use the address or \n   delegated prefix without interruption.  If the server is unable to\n   extend the lifetime of an address or delegated prefix, it indicates\n   this by returning the address or delegated prefix with lifetimes of\n   0.  At the same time, the server may assign other addresses or\n   delegated prefixes.\n\n   See Section 18 for descriptions of additional two-message exchanges\n   between the client and server.",
            "children": {}
          },
          "5.2": {
            "title": "Client/Server Exchanges Involving Four Messages",
            "content": "   To request the assignment of one or more addresses and/or delegated\n   prefixes, a client first locates a DHCP server and then requests the\n   assignment of addresses and/or delegated prefixes and other\n   configuration information from the server.  The client sends a\n   Solicit message to the All_DHCP_Relay_Agents_and_Servers multicast\n   address to find available DHCP servers.  Any server that can meet the\n   client's requirements responds with an Advertise message.  The client\n   then chooses one of the servers and sends a Request message to the\n   server asking for confirmed assignment of addresses and/or delegated\n   prefixes and other configuration information.  The server responds\n   with a Reply message that contains the confirmed addresses, delegated\n   prefixes, and configuration.\n\n   As described in the previous section, the client can request an\n   extension of the lifetimes assigned to addresses or delegated\n   prefixes (this is a two-message exchange).",
            "children": {}
          },
          "5.3": {
            "title": "Server/Client Exchanges",
            "content": "   A server that has previously communicated with a client and\n   negotiated for the client to listen for Reconfigure messages may send\n   the client a Reconfigure message to initiate the client to update its\n   configuration by sending an Information-request, Renew, or Rebind\n   message.  Reconfigure messages are authenticated as per Section 20.4.\n   The client then performs the two-message exchange as described\n   earlier.  This can be used to expedite configuration changes to a\n   client, such as the need to renumber a network (see [RFC6879] and\n   [RFC9096]).",
            "children": {}
          }
        }
      },
      "6": {
        "title": "Operational Models",
        "content": "   This section describes some of the current most common DHCP\n   operational models.  The described models are not mutually exclusive\n   and are sometimes used together.  For example, a device may start in\n   stateful mode to obtain an address and, at a later time when an\n   application is started, request additional parameters using stateless\n   mode. \n   This document assumes that the DHCP servers and the client,\n   communicating with the servers via a specific interface, belong to a\n   single provisioning domain.\n\n   DHCP may be extended to support additional stateful services that may\n   interact with one or more of the models described below.  Such\n   interaction should be considered and documented as part of any future\n   protocol extension.",
        "children": {
          "6.1": {
            "title": "Stateless DHCP",
            "content": "   Stateless DHCP can be used at any time, typically when a node\n   requires some missing or expired configuration information that is\n   available via DHCP.\n\n   This is the simplest and most basic operation for DHCP and requires a\n   client (and a server) to support only two messages --\n   Information-request and Reply.  Note that DHCP servers and relay\n   agents typically also need to support the Relay-forward and\n   Relay-reply messages to accommodate operation when clients and\n   servers are not on the same link.",
            "children": {}
          },
          "6.2": {
            "title": "DHCP for Non-temporary Address Assignment",
            "content": "   This model of operation was the original motivation for DHCP.  It is\n   appropriate for situations where stateless address autoconfiguration\n   alone is insufficient or impractical, e.g., because of network\n   policy, additional requirements such as dynamic updates to the DNS,\n   or client-specific requirements.\n\n   The model of operation for non-temporary address assignment is as\n   follows:\n\n   *  The server is provided with prefixes from which it may assign\n      addresses to clients, as well as any related network topology\n      information as to which prefixes are present on which links.\n\n   *  A client requests a non-temporary address to be assigned by the\n      server.  The server allocates an address or addresses appropriate\n      for the link on which the client is connected.\n\n   *  The server returns the allocated address or addresses to the\n      client. \n   Each address has associated preferred and valid lifetimes (see Section 12.1), which constitute an agreement about the length of time\n   over which the client is allowed to use the address.  A client can\n   request an extension of the lifetimes on an address and is required\n   to terminate the use of an address if the valid lifetime of the\n   address expires.\n\n   Typically, clients request other configuration parameters, such as\n   the DNS name server addresses and domain search lists, when\n   requesting addresses.\n\n   Clients can also request more than one address or set of addresses\n   (see Sections 6.5 and 12).",
            "children": {}
          },
          "6.3": {
            "title": "DHCP for Prefix Delegation",
            "content": "   The prefix delegation mechanism is another stateful mode of operation\n   and was originally intended for simple delegation of prefixes from a\n   DHCP server to DHCP clients (typically routers).  It is appropriate\n   for situations in which the client (1) does not have knowledge about\n   the topology of the networks to which it is attached and (2) does not\n   require other information to choose a prefix for delegation.  This\n   mechanism is appropriate for use by an ISP to delegate a prefix to a\n   subscriber, where the delegated prefix would possibly be subnetted\n   and assigned to the links within the subscriber's network.  [RFC7084]\n   and [RFC7368] describe such use in detail.\n\n   The design of this prefix delegation mechanism meets the requirements\n   for prefix delegation in [RFC3769].\n\n   DHCP prefix delegation itself does not require that the client\n   forward IP packets not addressed to itself and thus does not require\n   that the client (or server) be a router as defined in [RFC8200].\n   Also, in many cases (such as tethering or hosting virtual machines),\n   hosts are already forwarding IP packets and thus are operating as\n   routers as defined in [RFC8200].\n\n   The model of operation for prefix delegation is as follows:\n\n   *  The server is provisioned with prefixes to be delegated to\n      clients.\n\n   *  A client requests prefix(es) from the server, as described in Section 18.\n\n   *  The server chooses prefix(es) for delegation and responds with\n      prefix(es) to the client. \n   *  The client is then responsible for the delegated prefix(es).  For\n      example, the client might assign a subnet from a delegated prefix\n      to one of its interfaces and begin sending Router Advertisements\n      for the prefix on that link.\n\n   Each prefix has an associated preferred lifetime and valid lifetime\n   (see Section 12.2), which constitute an agreement about the length of\n   time over which the client is allowed to use the prefix.  A client\n   can request an extension of the lifetimes on a delegated prefix and\n   is required to terminate the use of a delegated prefix if the valid\n   lifetime of the prefix expires.\n\n   Figure 1 illustrates a network architecture in which prefix\n   delegation could be used.\n\n                      ______________________         \\\n                     /                      \\         \\\n                    |    ISP core network    |         \\\n                     \\__________ ___________/           |\n                                |                       |\n                        +-------+-------+               |\n                        |  Aggregation  |               | ISP\n                        |    device     |               | network\n                        +-------+-------+               |\n                                |                      /\n                                |Network link to      /\n                                |subscriber premises /\n                                |\n                         +-------+-------+           \\\n                         |      CPE      |            \\\n                         | (DHCP client) |             \\\n                         +----+---+------+              |\n                              |   |                     | Subscriber\n       ---+-------------+-----+   +-----+------         | network\n          |             |               |               |\n     +----+-----+ +-----+----+     +----+-----+         |\n     |Subscriber| |Subscriber|     |Subscriber|        /\n     |    PC    | |    PC    |     |    PC    |       /\n     +----------+ +----------+     +----------+      /\n\n                    Figure 1: Prefix Delegation Network\n\n   In this example, the server (in the ISP core network or integrated in\n   the aggregation device) is configured with a set of prefixes to be\n   used for assignment to customers at the time of each customer's first\n   connection to the ISP service.  The prefix delegation process begins\n   when the client (CPE) requests configuration information through\n   DHCP.  The DHCP messages from the client are received by the server \n   via the aggregation device.  When the server receives the request, it\n   selects an available prefix or prefixes for delegation to the client.\n   The server then returns the prefix or prefixes to the client.\n\n   The client subnets the delegated prefix and assigns the longer\n   prefixes to links in the subscriber's network.  In a typical scenario\n   based on the network shown in Figure 1, the client subnets a single\n   delegated /48 prefix into /64 prefixes and assigns one /64 prefix to\n   each of the links in the subscriber network.\n\n   The prefix delegation options can be used in conjunction with other\n   DHCP options carrying other configuration information to the client.\n   The client may, in turn, provide DHCP service to nodes attached to\n   the internal network.  For example, the client may obtain the\n   addresses of DNS and NTP servers from the ISP server and then pass\n   that configuration information on to the subscriber hosts through a\n   DHCP server in the client.\n\n   If the client uses a delegated prefix to configure addresses on\n   interfaces on itself or other nodes behind it, the preferred and\n   valid lifetimes of those addresses MUST be no longer than the\n   remaining preferred and valid lifetimes, respectively, for the\n   delegated prefix at any time.  In particular, if the delegated prefix\n   or a prefix derived from it is advertised for stateless address\n   autoconfiguration [RFC4862], the advertised preferred and valid\n   lifetimes MUST NOT exceed the corresponding remaining lifetimes of\n   the delegated prefix.\n\n   A client that has delegated any of the address space received through\n   DHCP Prefix Delegation MUST NOT issue a DHCP Release on the relevant\n   delegated prefix while any of the address space is outstanding.  That\n   includes addresses leased out by DHCPv6 (IA_NA), prefixes delegated\n   via DHCPv6-PD (IA_PD), and addresses autoconfigured by IPv6 Router\n   Advertisements.  Requirement WPD-9 in [RFC9096] makes this the Best\n   Current Practice.\n\n   [RFC9096] section 3.3 further provides more guidance on coordination\n   of lifetimes between WAN (DHCPv6-PD client) and LAN (DHCPv6-PD\n   server) sides.\n\n   Several problems related to Prefix Delegation and Relay Agents and a\n   set of requirements to address them are defined in [RFC8987]. \n\n\n\n",
            "children": {}
          },
          "6.4": {
            "title": "DHCP for Customer Edge Routers",
            "content": "   The DHCP requirements and network architecture for Customer Edge\n   Routers are described in [RFC7084], with improvements for renumbering\n   described in [RFC9096].  This model of operation combines address\n   assignment (see Section 6.2) and prefix delegation (see Section 6.3).\n   In general, this model assumes that a single set of transactions\n   between the client and server will assign or extend the client's non-\n   temporary addresses and delegated prefixes.",
            "children": {}
          },
          "6.5": {
            "title": "Multiple Addresses and Prefixes",
            "content": "   DHCP allows a client to receive multiple addresses.  During typical\n   operation, a client sends one instance of an IA_NA option and the\n   server assigns at most one address from each prefix assigned to the\n   link to which the client is attached.  In particular, the server can\n   be configured to serve addresses out of multiple prefixes for a given\n   link.  This is useful in cases such as when a network renumbering\n   event is in progress.  In a typical deployment, the server will grant\n   one address for each IA_NA option (see Section 21.4).\n\n   To meet the recommendations of [RFC7934], a client can explicitly\n   request multiple addresses by sending multiple IA_NA options.  A\n   client can send multiple IA_NA options in its initial transmissions.\n   Alternatively, it can send an extra Request message with additional\n   new IA_NA options (or include them in a Renew message).\n\n   The same principle also applies to prefix delegation.  In principle,\n   DHCP allows a client to request new prefixes to be delegated by\n   sending additional IA_PD options (see Section 21.21).  However, a\n   typical operator usually prefers to delegate a single, larger prefix.\n   In most deployments, it is recommended that the client request a\n   larger prefix in its initial transmissions rather than request\n   additional prefixes later on.\n\n   The exact behavior of the server (whether to grant additional\n   addresses and prefixes or not) is up to the server policy and is out\n   of scope for this document.\n\n   For more information on how the server distinguishes between IA\n   option instances, see Section 12. \n\n\n\n",
            "children": {}
          },
          "6.6": {
            "title": "Registering Self-generated Addresses",
            "content": "   [RFC9686] introduces a method for devices to register their self-\n   generated or statically configured addresses in the DHCPv6 servers.\n   The general idea is that devices would notify the server about\n   addresses that they are using, so that the server can log or record\n   these addresses as required by local policy.\n\n   The major specificity of this mechanism is that the address selection\n   is not done by the DHCP server, but by the device itself.  The most\n   of the lifecycle remains the same in principle: a lease is created by\n   the server, and the device performs periodic actions to get the lease\n   renewed, and eventually the lease can expire.  However, this\n   mechanism uses different message types (ADDR-REG-INFORM and ADDR-REG-\n   REPLY) and has different source address requirements, as defined in\n   [RFC9686].",
            "children": {}
          }
        }
      },
      "7": {
        "title": "DHCP Constants",
        "content": "   This section describes various program and networking constants used\n   by DHCP.",
        "children": {
          "7.1": {
            "title": "Multicast Addresses",
            "content": "   The following multicast addresses are used by DHCPv6:\n\n   All_DHCP_Relay_Agents_and_Servers (ff02::1:2)\n      A link-scoped multicast address used by a client to communicate\n      with neighboring (i.e., on-link) relay agents and servers.  All\n      servers and relay agents are members of this multicast group.\n\n   All_DHCP_Servers (ff05::1:3)\n      A site-scoped multicast address used by a relay agent to\n      communicate with servers, either because the relay agent wants to\n      send messages to all servers or because it does not know the\n      unicast addresses of the servers.  Note that in order for a relay\n      agent to use this address, it must have an address of sufficient\n      scope to be reachable by the servers.  All servers within the site\n      are members of this multicast group on the interfaces that are\n      within the site.",
            "children": {}
          },
          "7.2": {
            "title": "UDP Ports",
            "content": "   Clients MUST listen for DHCP messages on UDP port 546.  Servers and\n   relay agents MUST listen for DHCP messages on UDP port 547. \n   Therefore, clients MUST send DHCP messages to UDP destination port\n   547.  Servers MUST send Relay-reply messages to UDP destination port\n   547 and client messages to UDP destination port 546.  Relay agents\n   MUST send Relay-forward and Relay-reply messages to UDP destination\n   port 547 and client messages to UDP destination port 546.\n\n   It is RECOMMENDED for clients to send messages from UDP source port\n   546, and servers and relay agents from UDP source port 547.  However,\n   clients, servers, and relay agents MAY send DHCP messages from any\n   UDP source port they are allowed to use.\n\n   Please note that the Relay Source Port Option [RFC8357] changes some\n   of these rules for servers and relays agents.",
            "children": {}
          },
          "7.3": {
            "title": "DHCP Message Types",
            "content": "   DHCP defines the following message types.  The formats of these\n   messages are provided in Sections 8 and 9.  Additional message types\n   have been defined and may be defined in the future; see\n   <https://www.iana.org/assignments/dhcpv6-parameters >.  The numeric\n   encoding for each message type is shown in parentheses.\n\n   SOLICIT (1)               A client sends a Solicit message to locate\n                             servers.\n\n   ADVERTISE (2)             A server sends an Advertise message to\n                             indicate that it is available for DHCP\n                             service, in response to a Solicit message\n                             received from a client.\n\n   REQUEST (3)               A client sends a Request message to request\n                             configuration parameters, including\n                             addresses and/or delegated prefixes, from a\n                             specific server.\n\n   CONFIRM (4)               A client sends a Confirm message to any\n                             available server to determine whether the\n                             addresses it was assigned are still\n                             appropriate to the link to which the client\n                             is connected.\n\n   RENEW (5)                 A client sends a Renew message to the\n                             server that originally provided the\n                             client's leases and configuration\n                             parameters to extend the lifetimes on the\n                             leases assigned to the client and to update\n                             other configuration parameters. \n   REBIND (6)                A client sends a Rebind message to any\n                             available server to extend the lifetimes on\n                             the leases assigned to the client and to\n                             update other configuration parameters; this\n                             message is sent after a client receives no\n                             response to a Renew message.\n\n   REPLY (7)                 A server sends a Reply message containing\n                             assigned leases and configuration\n                             parameters in response to a Solicit,\n                             Request, Renew, or Rebind message received\n                             from a client.  A server sends a Reply\n                             message containing configuration parameters\n                             in response to an Information-request\n                             message.  A server sends a Reply message in\n                             response to a Confirm message confirming or\n                             denying that the addresses assigned to the\n                             client are appropriate to the link to which\n                             the client is connected.  A server sends a\n                             Reply message to acknowledge receipt of a\n                             Release or Decline message.\n\n   RELEASE (8)               A client sends a Release message to the\n                             server that assigned leases to the client\n                             to indicate that the client will no longer\n                             use one or more of the assigned leases.\n\n   DECLINE (9)               A client sends a Decline message to a\n                             server to indicate that the client has\n                             determined that one or more addresses\n                             assigned by the server are already in use\n                             on the link to which the client is\n                             connected.\n\n   RECONFIGURE (10)          A server sends a Reconfigure message to a\n                             client to inform the client that the server\n                             has new or updated configuration parameters\n                             and that the client is to initiate a\n                             Renew/Reply, Rebind/Reply, or\n                             Information-request/Reply transaction with\n                             the server in order to receive the updated\n                             information.\n\n   INFORMATION-REQUEST (11)  A client sends an Information-request\n                             message to a server to request\n                             configuration parameters without the\n                             assignment of any leases to the client. \n   RELAY-FORW (12)           A relay agent sends a Relay-forward message\n                             to relay messages to servers, either\n                             directly or through another relay agent.\n                             The received message -- either a client\n                             message or a Relay-forward message from\n                             another relay agent -- is encapsulated in\n                             an option in the Relay-forward message.\n\n   RELAY-REPL (13)           A server sends a Relay-reply message to a\n                             relay agent containing a message that the\n                             relay agent delivers to a client.  The\n                             Relay-reply message may be relayed by other\n                             relay agents for delivery to the\n                             destination relay agent.\n\n                             The server encapsulates the client message\n                             as an option in the Relay-reply message,\n                             which the relay agent extracts and relays\n                             to the client.",
            "children": {}
          },
          "7.4": {
            "title": "DHCP Option Codes",
            "content": "   DHCP makes extensive use of options in messages; some of these are\n   defined later, in Section 21.  Additional options are defined in\n   other documents or may be defined in the future (see [RFC7227] for\n   guidance on new option definitions).",
            "children": {}
          },
          "7.5": {
            "title": "Status Codes",
            "content": "   DHCP uses status codes to communicate the success or failure of\n   operations requested in messages from clients and servers and to\n   provide additional information about the specific cause of the\n   failure of a message.  The specific status codes are defined in Section 21.13.\n\n   If the Status Code option (see Section 21.13) does not appear in a\n   message in which the option could appear, the status of the message\n   is assumed to be Success.",
            "children": {}
          },
          "7.6": {
            "title": "Transmission and Retransmission Parameters",
            "content": "   The table of values (Table 1) is used to describe the message\n   transmission behavior of clients and servers.  Some of the values are\n   adjusted by a randomization factor and backoffs (see Section 15).\n   Transmissions may also be influenced by rate limiting (see Section 14.1). \n       +=================+============+============================+\n       | Parameter       | Default    | Description                |\n       +=================+============+============================+\n       | SOL_MAX_DELAY   | 1 sec      | Max delay of first Solicit |\n       +-----------------+------------+----------------------------+\n       | SOL_TIMEOUT     | 1 sec      | Initial Solicit timeout    |\n       +-----------------+------------+----------------------------+\n       | SOL_MAX_RT      | 3600 secs  | Max Solicit timeout value  |\n       +-----------------+------------+----------------------------+\n       | REQ_TIMEOUT     | 1 sec      | Initial Request timeout    |\n       +-----------------+------------+----------------------------+\n       | REQ_MAX_RT      | 30 secs    | Max Request timeout value  |\n       +-----------------+------------+----------------------------+\n       | REQ_MAX_RC      | 10         | Max Request retry attempts |\n       +-----------------+------------+----------------------------+\n       | CNF_MAX_DELAY   | 1 sec      | Max delay of first Confirm |\n       +-----------------+------------+----------------------------+\n       | CNF_TIMEOUT     | 1 sec      | Initial Confirm timeout    |\n       +-----------------+------------+----------------------------+\n       | CNF_MAX_RT      | 4 secs     | Max Confirm timeout        |\n       +-----------------+------------+----------------------------+\n       | CNF_MAX_RD      | 10 secs    | Max Confirm duration       |\n       +-----------------+------------+----------------------------+\n       | REN_TIMEOUT     | 10 secs    | Initial Renew timeout      |\n       +-----------------+------------+----------------------------+\n       | REN_MAX_RT      | 600 secs   | Max Renew timeout value    |\n       +-----------------+------------+----------------------------+\n       | REB_TIMEOUT     | 10 secs    | Initial Rebind timeout     |\n       +-----------------+------------+----------------------------+\n       | REB_MAX_RT      | 600 secs   | Max Rebind timeout value   |\n       +-----------------+------------+----------------------------+\n       | INF_MAX_DELAY   | 1 sec      | Max delay of first         |\n       |                 |            | Information-request        |\n       +-----------------+------------+----------------------------+\n       | INF_TIMEOUT     | 1 sec      | Initial Information-       |\n       |                 |            | request timeout            |\n       +-----------------+------------+----------------------------+\n       | INF_MAX_RT      | 3600 secs  | Max Information-request    |\n       |                 |            | timeout value              |\n       +-----------------+------------+----------------------------+\n       | REL_TIMEOUT     | 1 sec      | Initial Release timeout    |\n       +-----------------+------------+----------------------------+\n       | REL_MAX_RC      | 4          | Max Release retry attempts |\n       +-----------------+------------+----------------------------+\n       | DEC_TIMEOUT     | 1 sec      | Initial Decline timeout    |\n       +-----------------+------------+----------------------------+\n       | DEC_MAX_RC      | 4          | Max Decline retry attempts |\n       +-----------------+------------+----------------------------+\n       | REC_TIMEOUT     | 2 secs     | Initial Reconfigure        |\n       |                 |            | timeout                    |\n       +-----------------+------------+----------------------------+\n       | REC_MAX_RC      | 8          | Max Reconfigure attempts   |\n       +-----------------+------------+----------------------------+\n       | HOP_COUNT_LIMIT | 8          | Max hop count in a Relay-  |\n       |                 |            | forward message            |\n       +-----------------+------------+----------------------------+\n       | IRT_DEFAULT     | 86400 secs | Default information        |\n       |                 | (24 hours) | refresh time               |\n       +-----------------+------------+----------------------------+\n       | IRT_MINIMUM     | 600 secs   | Min information refresh    |\n       |                 |            | time                       |\n       +-----------------+------------+----------------------------+\n       | MAX_WAIT_TIME   | 60 secs    | Max required time to wait  |\n       |                 |            | for a response             |\n       +-----------------+------------+----------------------------+\n\n            Table 1: Transmission and Retransmission Parameters",
            "children": {}
          },
          "7.7": {
            "title": "Representation of Time Values and \"Infinity\" as a Time Value",
            "content": "   All time values for lifetimes, T1, and T2 are unsigned 32-bit\n   integers and are expressed in units of seconds.  The value 0xffffffff\n   is taken to mean \"infinity\" when used as a lifetime (as in [RFC4861])\n   or a value for T1 or T2.\n\n   Setting the valid lifetime of an address or a delegated prefix to\n   0xffffffff (\"infinity\") amounts to a permanent assignment of an\n   address or delegation to a client and should only be used in cases\n   where permanent assignments are desired.\n\n   Care should be taken in setting T1 or T2 to 0xffffffff (\"infinity\").\n   A client will never attempt to extend the lifetimes of any addresses\n   in an IA with T1 set to 0xffffffff.  A client will never attempt to\n   use a Rebind message to locate a different server to extend the\n   lifetimes of any addresses in an IA with T2 set to 0xffffffff.",
            "children": {}
          }
        }
      },
      "8": {
        "title": "Client/Server Message Formats",
        "content": "   All DHCP messages sent between clients and servers share an identical\n   fixed-format header and a variable-format area for options.\n\n   All values in the message header and in options are in network byte\n   order. \n   Options are stored serially in the \"options\" field, with no padding\n   between the options.  Options are byte-aligned but are not aligned in\n   any other way (such as on 2-byte or 4-byte boundaries).\n\n   The following diagram illustrates the format of DHCP messages sent\n   between clients and servers:\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |    msg-type   |               transaction-id                  |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                                                               |\n      .                            options                            .\n      .                 (variable number and length)                  .\n      |                                                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                   Figure 2: Client/Server Message Format\n\n   msg-type                Identifies the DHCP message type; the\n                           available message types are listed in Section 7.3.  A 1-octet field.\n\n   transaction-id          The transaction ID for this message exchange.\n                           A 3-octet field.\n\n   options                 Options carried in this message; options are\n                           described in Section 21.  A variable-length\n                           field (4 octets less than the size of the\n                           message).",
        "children": {}
      },
      "9": {
        "title": "Relay Agent/Server Message Formats",
        "content": "   Relay agents exchange messages with other relay agents and servers to\n   relay messages between clients and servers that are not connected to\n   the same link.\n\n   All values in the message header and in options are in network byte\n   order.\n\n   Options are stored serially in the \"options\" field, with no padding\n   between the options.  Options are byte-aligned but are not aligned in\n   any other way (such as on 2-byte or 4-byte boundaries).\n\n   There are two relay agent messages (Relay-forward and Relay-reply),\n   which share the following format:\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |    msg-type   |   hop-count   |                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |\n      |                                                               |\n      |                         link-address                          |\n      |                                                               |\n      |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-|\n      |                               |                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |\n      |                                                               |\n      |                         peer-address                          |\n      |                                                               |\n      |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-|\n      |                               |                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |\n      .                                                               .\n      .            options (variable number and length)   ....        .\n      |                                                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                Figure 3: Relay Agent/Server Message Format\n\n   The following sections describe the use of the relay agent message\n   header.",
        "children": {
          "9.1": {
            "title": "Relay-forward Message",
            "content": "   The following table defines the use of message fields in a\n   Relay-forward message.\n\n   msg-type                RELAY-FORW (12).  A 1-octet field.\n\n   hop-count               Number of relay agents that have already\n                           relayed this message.  A 1-octet field.\n\n   link-address            An address that may be used by the server to\n                           identify the link on which the client is\n                           located.  This is typically a globally scoped\n                           unicast address (i.e., GUA or ULA), but see\n                           the discussion in Section 19.1.1.  A 16-octet\n                           field.\n\n   peer-address            The address of the client or relay agent from\n                           which the message to be relayed was received.\n                           A 16-octet field. \n   options                 MUST include a Relay Message option (see Section 21.10); MAY include other options,\n                           such as the Interface-Id option (see Section 21.18), added by the relay agent.  A\n                           variable-length field (34 octets less than\n                           the size of the message).\n\n   See Section 13.1 for an explanation of how the link-address field\n   is used.",
            "children": {}
          },
          "9.2": {
            "title": "Relay-reply Message",
            "content": "   The following table defines the use of message fields in a\n   Relay-reply message.\n\n   msg-type                RELAY-REPL (13).  A 1-octet field.\n\n   hop-count               Copied from the Relay-forward message.\n                           A 1-octet field.\n\n   link-address            Copied from the Relay-forward message.\n                           A 16-octet field.\n\n   peer-address            Copied from the Relay-forward message.\n                           A 16-octet field.\n\n   options                 MUST include a Relay Message option (see Section 21.10); MAY include other options,\n                           such as the Interface-Id option (see Section 21.18).  A variable-length field\n                           (34 octets less than the size of the\n                           message).",
            "children": {}
          }
        }
      },
      "10": {
        "title": "Representation and Use of Domain Names",
        "content": "   So that domain names may be encoded uniformly, a domain name or a\n   list of domain names is encoded using the technique described in Section 3.1 of [RFC1035].  The message compression scheme in Section 4.1.4 of [RFC1035] MUST NOT be used.",
        "children": {}
      },
      "11": {
        "title": "DHCP Unique Identifier (DUID)",
        "content": "   Each DHCP client and server has a DUID.  DHCP servers use DUIDs to\n   identify clients for the selection of configuration parameters and in\n   the association of IAs with clients.  DHCP clients use DUIDs to\n   identify a server in messages where a server needs to be identified.\n   See Sections 21.2 and 21.3 for details regarding the representation\n   of a DUID in a DHCP message. \n   Clients and servers MUST treat DUIDs as opaque values and MUST only\n   compare DUIDs for equality.  Clients and servers SHOULD NOT in any\n   other way interpret DUIDs.  Clients and servers MUST NOT restrict\n   DUIDs to the types defined in this document, as additional DUID types\n   may be defined in the future.  It should be noted that an attempt to\n   parse a DUID to obtain a client's link-layer address is unreliable,\n   as there is no guarantee that the client is still using the same\n   link-layer address as when it generated its DUID.  Also, such an\n   attempt will be more and more unreliable as more clients adopt\n   privacy measures such as those defined in [RFC7844].  If this\n   capability is required, it is recommended to rely on the Client\n   Link-Layer Address option instead [RFC6939].\n\n   The DUID is carried in an option because it may be variable in length\n   and because it is not required in all DHCP messages.  The DUID is\n   designed to be unique across all DHCP clients and servers, and stable\n   for any specific client or server.  That is, the DUID used by a\n   client or server SHOULD NOT change over time if at all possible; for\n   example, a device's DUID should not change as a result of a change in\n   the device's network hardware or changes to virtual interfaces (e.g.,\n   logical PPP (over Ethernet) interfaces that may come and go in\n   Customer Premises Equipment routers).  The client may change its DUID\n   as specified in [RFC7844].\n\n   The motivation for having more than one type of DUID is that the DUID\n   must be globally unique and must also be easy to generate.  The sort\n   of globally unique identifier that is easy to generate for any given\n   device can differ quite widely.  Also, some devices may not contain\n   any persistent storage.  Retaining a generated DUID in such a device\n   is not possible, so the DUID scheme must accommodate such devices.",
        "children": {
          "11.1": {
            "title": "DUID Contents",
            "content": "   A DUID consists of a 2-octet type code represented in network byte\n   order, followed by a variable number of octets that make up the\n   actual identifier.  The length of the DUID (not including the type\n   code) is at least 1 octet and at most 128 octets.  The following\n   types are currently defined:\n      +======+======================================================+\n      | Type | Description                                          |\n      +======+======================================================+\n      | 1    | Link-layer address plus time                         |\n      +------+------------------------------------------------------+\n      | 2    | Vendor-assigned unique ID based on Enterprise Number |\n      +------+------------------------------------------------------+\n      | 3    | Link-layer address                                   |\n      +------+------------------------------------------------------+\n      | 4    | Universally Unique Identifier (UUID) [RFC6355]       |\n      +------+------------------------------------------------------+\n\n                            Table 2: DUID Types\n\n   Formats for the variable field of the DUID for the first three of the\n   above types are shown below.  The fourth type, DUID-UUID [RFC6355],\n   can be used in situations where there is a UUID stored in a device's\n   firmware settings.",
            "children": {}
          },
          "11.2": {
            "title": "DUID Based on Link-Layer Address Plus Time (DUID-LLT)",
            "content": "   This type of DUID consists of a 2-octet type field containing the\n   value 1, a 2-octet hardware type code, and 4 octets containing a time\n   value, followed by the link-layer address of any one network\n   interface that is connected to the DHCP device at the time that the\n   DUID is generated.  The time value is the time that the DUID is\n   generated, represented in seconds since midnight (UTC), January 1,\n   2000, modulo 2^32.  The hardware type MUST be a valid hardware type\n   assigned by IANA; see [IANA-HARDWARE-TYPES ].  Both the time and the\n   hardware type are stored in network byte order.  For Ethernet\n   hardware types, the link-layer address is stored in canonical form,\n   as described in [RFC2464].\n\n   The following diagram illustrates the format of a DUID-LLT:\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |         DUID-Type (1)         |    hardware type (16 bits)    |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                        time (32 bits)                         |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      .                                                               .\n      .             link-layer address (variable length)              .\n      .                                                               .\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                         Figure 4: DUID-LLT Format \n   The choice of network interface can be completely arbitrary, as long\n   as that interface provides a globally unique link-layer address for\n   the link type; the same DUID-LLT SHOULD be used in configuring all\n   network interfaces connected to the device, regardless of which\n   interface's link-layer address was used to generate the DUID-LLT.\n\n   Clients and servers using this type of DUID MUST store the DUID-LLT\n   in stable storage and MUST continue to use this DUID-LLT even if the\n   network interface used to generate the DUID-LLT is removed.  Clients\n   and servers that do not have any stable storage MUST NOT use this\n   type of DUID.\n\n   Clients and servers that use this DUID SHOULD attempt to configure\n   the time prior to generating the DUID, if that is possible, and MUST\n   use some sort of time source (for example, a real-time clock) in\n   generating the DUID, even if that time source could not be configured\n   prior to generating the DUID.  The use of a time source makes it\n   unlikely that two identical DUID-LLTs will be generated if the\n   network interface is removed from the client and another client then\n   uses the same network interface to generate a DUID-LLT.  A collision\n   between two DUID-LLTs is very unlikely even if the clocks have not\n   been configured prior to generating the DUID.\n\n   This method of DUID generation is recommended for all general-purpose\n   computing devices such as desktop computers and laptop computers, and\n   also for devices such as printers, routers, and so on, that contain\n   some form of writable non-volatile storage.\n\n   It is possible that this algorithm for generating a DUID could result\n   in a client identifier collision.  A DHCP client that generates a\n   DUID-LLT using this mechanism MUST provide an administrative\n   interface that replaces the existing DUID with a newly generated\n   DUID-LLT.",
            "children": {}
          },
          "11.3": {
            "title": "DUID Assigned by Vendor Based on Enterprise Number (DUID-EN)",
            "content": "   The vendor assigns this form of DUID to the device.  This DUID\n   consists of the 4-octet vendor's registered Private Enterprise Number\n   as maintained by IANA [IANA-PEN ] followed by a unique identifier\n   assigned by the vendor.  The following diagram summarizes the\n   structure of a DUID-EN:\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |         DUID-Type (2)         |       enterprise-number       |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |   enterprise-number (contd)   |                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |\n      .                           identifier                          .\n      .                       (variable length)                       .\n      .                                                               .\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                          Figure 5: DUID-EN Format\n\n   The source of the identifier is left up to the vendor defining it,\n   but each identifier part of each DUID-EN MUST be unique to the device\n   that is using it, and MUST be assigned to the device no later than at\n   the first usage and stored in some form of non-volatile storage.\n   This typically means being assigned during the manufacturing process\n   in the case of physical devices or, in the case of virtual machines,\n   when the image is created or booted for the first time.  The\n   generated DUID SHOULD be recorded in non-erasable storage.  The\n   enterprise-number is the vendor's registered Private Enterprise\n   Number as maintained by IANA [IANA-PEN ].  The enterprise-number is\n   stored as an unsigned 32-bit number.\n\n   An example DUID of this type might look like this:\n\n      +---+---+---+---+---+---+---+---+\n      | 0 | 2 | 0 | 0 |126|217| 12|192|\n      +---+---+---+---+---+---+---+---+\n      |132|211| 3 | 0 | 9 | 18|\n      +---+---+---+---+---+---+\n\n                         Figure 6: DUID-EN Example\n\n   This example includes the 2-octet type of 2 and the Enterprise Number\n   (32473) (from [RFC5612]), followed by 8 octets of identifier data\n   (0x0CC084D303000912).",
            "children": {}
          },
          "11.4": {
            "title": "DUID Based on Link-Layer Address (DUID-LL)",
            "content": "   This type of DUID consists of 2 octets containing a DUID type of 3\n   and a 2-octet network hardware type code, followed by the link-layer\n   address of any one network interface that is permanently connected to\n   the client or server device.  For example, a node that has a network\n   interface implemented in a chip that is unlikely to be removed and\n   used elsewhere could use a DUID-LL.  The hardware type MUST be a \n   valid hardware type assigned by IANA; see [IANA-HARDWARE-TYPES ].  The\n   hardware type is stored in network byte order.  The link-layer\n   address is stored in canonical form, as described in [RFC2464].  The\n   following diagram illustrates the format of a DUID-LL:\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |         DUID-Type (3)         |    hardware type (16 bits)    |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      .                                                               .\n      .             link-layer address (variable length)              .\n      .                                                               .\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                          Figure 7: DUID-LL Format\n\n   The choice of network interface can be completely arbitrary, as long\n   as that interface provides a unique link-layer address and is\n   permanently attached to the device on which the DUID-LL is being\n   generated.  The same DUID-LL SHOULD be used in configuring all\n   network interfaces connected to the device, regardless of which\n   interface's link-layer address was used to generate the DUID.\n\n   A DUID-LL is recommended for devices that have a permanently\n   connected network interface with a link-layer address and do not have\n   nonvolatile, writable stable storage.  A DUID-LL SHOULD NOT be used\n   by DHCP clients or servers that cannot tell whether or not a network\n   interface is permanently attached to the device on which the DHCP\n   client is running.",
            "children": {}
          },
          "11.5": {
            "title": "DUID Based on Universally Unique Identifier (DUID-UUID)",
            "content": "   This type of DUID consists of 16 octets containing a 128-bit UUID.\n   [RFC6355] details when to use this type and how to pick an\n   appropriate source of the UUID.\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |         DUID-Type (4)         |        UUID (128 bits)        |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |\n      |                                                               |\n      |                                                               |\n      |                                -+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                                |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-\n                         Figure 8: DUID-UUID Format",
            "children": {}
          }
        }
      },
      "12": {
        "title": "Identity Association",
        "content": "   An Identity Association (IA) is a construct through which a server\n   and a client can identify, group, and manage a set of related IPv6\n   addresses or delegated prefixes.  Each IA consists of an IAID and\n   associated configuration information.\n\n   The IAID uniquely identifies the IA and MUST be chosen to be unique\n   among the IAIDs for that IA type on the client (e.g., an IA_NA with\n   an IAID of 0 and an IA_PD with an IAID of 0 are each considered\n   unique).  The IAID is chosen by the client.  For any given use of an\n   IA by the client, the IAID for that IA MUST be consistent across\n   restarts of the DHCP client.  The client may maintain consistency by\n   either storing the IAID in non-volatile storage or using an algorithm\n   that will consistently produce the same IAID as long as the\n   configuration of the client has not changed.  There may be no way for\n   a client to maintain consistency of the IAIDs if it does not have\n   non-volatile storage and the client's hardware configuration changes.\n   If the client uses only one IAID, it can use a well-known value,\n   e.g., zero.\n\n   If the client wishes to obtain a distinctly new address or prefix and\n   deprecate the existing one, the client sends a Release message to the\n   server for the IAs using the original IAID.  The client then creates\n   a new IAID, to be used in future messages to obtain leases for the\n   new IA.",
        "children": {
          "12.1": {
            "title": "Identity Associations for Address Assignment",
            "content": "   A client must associate at least one distinct IA with each of its\n   network interfaces for which it is to request the assignment of IPv6\n   addresses from a DHCP server.  The client uses the IAs assigned to an\n   interface to obtain configuration information from a server for that\n   interface.  Each such IA must be associated with exactly one\n   interface.\n\n   The configuration information in an IA_NA option consists of one or\n   more IPv6 addresses along with the T1 and T2 values for the IA.  See Section 21.4 for details regarding the representation of an IA_NA in\n   a DHCP message.\n\n   Each address in an IA has a preferred lifetime and a valid lifetime,\n   as defined in [RFC4862].  The lifetimes are transmitted from the DHCP\n   server to the client in the IA Address option (see Section 21.6).\n   The lifetimes apply to the use of addresses; see Section 5.5.4 of\n   [RFC4862]. \n\n\n\n",
            "children": {}
          },
          "12.2": {
            "title": "Identity Associations for Prefix Delegation",
            "content": "   An IA_PD is different from an IA for address assignment in that it\n   does not need to be associated with exactly one interface.  One IA_PD\n   can be associated with the client, with a set of interfaces, or with\n   exactly one interface.  A client configured to request delegated\n   prefixes must create at least one distinct IA_PD.  It may associate a\n   distinct IA_PD with each of its downstream network interfaces and use\n   that IA_PD to obtain a prefix for that interface from the server.\n\n   The configuration information in an IA_PD option consists of one or\n   more prefixes along with the T1 and T2 values for the IA_PD.  See Section 21.21 for details regarding the representation of an IA_PD in\n   a DHCP message.\n\n   Each delegated prefix in an IA has a preferred lifetime and a valid\n   lifetime, as defined in [RFC4862].  The lifetimes are transmitted\n   from the DHCP server to the client in the IA Prefix option (see Section 21.22).  The lifetimes apply to the use of delegated\n   prefixes; see Section 5.5.4 of [RFC4862].",
            "children": {}
          }
        }
      },
      "13": {
        "title": "Assignment to an IA",
        "content": "\n\n",
        "children": {
          "13.1": {
            "title": "Selecting Addresses for Assignment to an IA_NA",
            "content": "   A server selects addresses to be assigned to an IA_NA according to\n   the address assignment policies determined by the server\n   administrator and the specific information the server determines\n   about the client from some combination of the following sources:\n\n   *  The link to which the client is attached.  The server determines\n      the link as follows:\n\n      -  If the server receives the message directly from the client and\n         the source address in the IP datagram in which the message was\n         received is a link-local address, then the client is on the\n         same link to which the interface over which the message was\n         received is attached.\n\n      -  If the server receives the message from a forwarding relay\n         agent, then the client is on the same link as the one to which\n         the interface, identified by the link-address field in the\n         message from the relay agent, is attached.  According to\n         [RFC6221], the server MUST ignore any link-address field whose\n         value is zero.  The link-address in this case may come from any\n         of the Relay-forward messages encapsulated in the received\n         Relay-forward, and in general the most encapsulated (closest\n         Relay-forward to the client) has the most useful value. \n   *  The DUID supplied by the client.\n\n   *  Other information in options supplied by the client, e.g., IA\n      Address options (see Section 21.6) that include the client's\n      requests for specific addresses.\n\n   *  Other information in options supplied by the relay agent.\n\n   By default, DHCP server implementations SHOULD NOT generate\n   predictable addresses (see Section 4.7 of [RFC7721]).  Server\n   implementers are encouraged to review [RFC8981], [RFC7824],\n   [RFC7707], and [RFC7943] as to possible considerations for how to\n   generate addresses.\n\n   A server MUST NOT assign an address that is otherwise reserved for\n   some other purpose.  For example, a server MUST NOT assign addresses\n   that use a reserved IPv6 Interface Identifier [RFC5453] [RFC7136]\n   [IANA-RESERVED-IID ].\n\n   See [RFC7969] for a more detailed discussion on how servers determine\n   a client's location on the network.",
            "children": {}
          },
          "13.2": {
            "title": "Assignment of Prefixes for IA_PD",
            "content": "   The mechanism through which the server selects prefix(es) for\n   delegation is not specified in this document.  Examples of ways in\n   which the server might select prefix(es) for a client include static\n   assignment based on subscription to an ISP, dynamic assignment from a\n   pool of available prefixes, and selection based on an external\n   authority such as a RADIUS server using the Framed-IPv6-Prefix option\n   as described in [RFC3162].",
            "children": {}
          }
        }
      },
      "14": {
        "title": "Transmission of Messages by a Client",
        "content": "   Unless otherwise specified in this document or in a document that\n   describes how IPv6 is carried over a specific type of link (for link\n   types that do not support multicast), a client sends DHCP messages to\n   the All_DHCP_Relay_Agents_and_Servers multicast address.\n\n   DHCP servers SHOULD NOT check to see whether the Layer 2 address used\n   was multicast or not, as long as the Layer 3 address was correct.\n\n   A client uses multicast to reach all servers or an individual server.\n   An individual server is indicated by specifying that server's DUID in\n   a Server Identifier option (see Section 21.3) in the client's\n   message.  (All servers will receive this message, but only the\n   indicated server will respond.)  All servers are indicated when this\n   option is not supplied. \n\n\n\n",
        "children": {
          "14.1": {
            "title": "Rate Limiting",
            "content": "   A DHCPv6 client MUST limit the rate of DHCP messages it transmits or\n   retransmits.  This will minimise the impact of prolonged message\n   bursts or loops, for example when a client rejects a server's\n   response, repeats the request and gets the same server response which\n   again gets rejected by the client.\n\n   This loop can repeat infinitely if there is not a quit/stop\n   mechanism.  Therefore, a client must not initiate transmissions too\n   frequently.\n\n   A recommended method for implementing the rate-limiting function is a\n   token bucket (see Appendix A of [RFC3290]), limiting the average rate\n   of transmission to a certain number in a certain time interval.  This\n   method of bounding burstiness also guarantees that the long-term\n   transmission rate will not be exceeded.\n\n   A transmission rate limit SHOULD be configurable.  A possible default\n   could be 20 messages in 20 seconds.\n\n   For a device that has multiple interfaces, the limit MUST be enforced\n   on a per-interface basis.\n\n   Rate limiting of forwarded DHCP messages and server-side messages is\n   out of scope for this specification.",
            "children": {}
          },
          "14.2": {
            "title": "Client Behavior when T1 and/or T2 Are 0",
            "content": "   In certain cases, T1 and/or T2 values may be set to 0.  Currently,\n   there are two such cases:\n\n   1.  a client received an IA_NA option (see Section 21.4) with a zero\n       value\n\n   2.  a client received an IA_PD option (see Section 21.21) with a zero\n       value\n\n   This is an indication that the renew and rebind times are left to the\n   discretion of the client.  However, they are not completely\n   discretionary. \n   When T1 and/or T2 values are set to 0, the client MUST choose a time\n   to avoid message storms.  In particular, it MUST NOT transmit\n   immediately.  If the client received multiple IA options, it SHOULD\n   pick renew and/or rebind transmission times so all IA options are\n   handled in one exchange, if possible.  The client MUST choose renew\n   and rebind times to not violate rate-limiting restrictions as defined\n   in Section 14.1.",
            "children": {}
          }
        }
      },
      "15": {
        "title": "Reliability of Client-Initiated Message Exchanges",
        "content": "   DHCP clients are responsible for reliable delivery of messages in the\n   client-initiated message exchanges described in Section 18.  If a\n   DHCP client fails to receive an expected response from a server, the\n   client must retransmit its message according to the retransmission\n   strategy described below.\n\n   Note that the procedure described in this section is slightly\n   modified when used with the Solicit message.  The modified procedure\n   is described in Section 18.2.1.\n\n   The client begins the message exchange by transmitting a message to\n   the server.  The message exchange terminates when either (1) the\n   client successfully receives the appropriate response or responses\n   from a server or servers or (2) the message exchange is considered to\n   have failed according to the retransmission mechanism described\n   below.\n\n   The client MUST update an \"elapsed-time\" value within an Elapsed Time\n   option (see Section 21.9) in the retransmitted message.  In some\n   cases, the client may also need to modify values in IA Address\n   options (see Section 21.6) or IA Prefix options (see Section 21.22)\n   if a valid lifetime for any of the client's leases expires before\n   retransmission.  Thus, whenever this document refers to a\n   \"retransmission\" of a client's message, it refers to both modifying\n   the original message and sending this new message instance to the\n   server.\n\n   The client retransmission behavior is controlled and described by the\n   following variables:\n\n   RT         Retransmission timeout\n\n   IRT        Initial retransmission time\n\n   MRC        Maximum retransmission count\n\n   MRT        Maximum retransmission time \n   MRD        Maximum retransmission duration\n\n   RAND       Randomization factor\n\n   Specific values for each of these parameters relevant to the various\n   messages are given in the subsections of Section 18.2, using values\n   defined in Table 1 in Section 7.6.  The algorithm for RAND is common\n   across all message transmissions.\n\n   With each message transmission or retransmission, the client sets RT\n   according to the rules given below.  If RT expires before the message\n   exchange terminates, the client recomputes RT and retransmits the\n   message.\n\n   Each of the computations of a new RT includes a randomization factor\n   (RAND), which is a random number chosen with a uniform distribution\n   between -0.1 and +0.1.  The randomization factor is included to\n   minimize synchronization of messages transmitted by DHCP clients.\n\n   The algorithm for choosing a random number does not need to be\n   cryptographically sound.  The algorithm SHOULD produce a different\n   sequence of random numbers from each invocation of the DHCP client.\n\n   RT for the first message transmission is based on IRT:\n\n      RT = IRT + RAND*IRT\n\n   RT for each subsequent message transmission is based on the previous\n   value of RT:\n\n      RT = 2*RTprev + RAND*RTprev\n\n   MRT specifies an upper bound on the value of RT (disregarding the\n   randomization added by the use of RAND).  If MRT has a value of 0,\n   there is no upper limit on the value of RT.  Otherwise:\n\n      if (RT > MRT)\n         RT = MRT + RAND*MRT\n\n   MRC specifies an upper bound on the number of times a client may\n   retransmit a message.  Unless MRC is zero, the message exchange fails\n   once the client has transmitted the message MRC times.\n\n   MRD specifies an upper bound on the length of time a client may\n   retransmit a message.  Unless MRD is zero, the message exchange fails\n   once MRD seconds have elapsed since the client first transmitted the\n   message. \n   If both MRC and MRD are non-zero, the message exchange fails whenever\n   either of the conditions specified in the previous two paragraphs\n   is met.\n\n   If both MRC and MRD are zero, the client continues to transmit the\n   message until it receives a response.\n\n   A client is not expected to listen for a response during the entire\n   RT period and may turn off listening capabilities after waiting at\n   least the shorter of RT and MAX_WAIT_TIME due to power consumption\n   saving or other reasons.  Of course, a client MUST listen for a\n   Reconfigure if it has negotiated for its use with the server.",
        "children": {}
      },
      "16": {
        "title": "Message Validation",
        "content": "   This section describes which options are valid in which kinds of\n   message types and explains what to do when a client or server\n   receives a message that contains known options that are invalid for\n   that message.  For example, an IA option is not allowed to appear in\n   an Information-request message.\n\n   Clients and servers MAY choose to either (1) extract information from\n   such a message if the information is of use to the recipient or\n   (2) ignore such a message completely and just discard it.\n\n   If a server receives a message that it considers invalid, it MAY send\n   a Reply message (or Advertise message, as appropriate) with a Server\n   Identifier option (see Section 21.3), a Client Identifier option (see Section 21.2) (if one was included in the message), and a Status Code\n   option (see Section 21.13) with status UnspecFail.\n\n   Clients, relay agents, and servers MUST NOT discard messages that\n   contain unknown options (or instances of vendor options with unknown\n   enterprise-number values).  These options should be ignored as if\n   they were not present.  This is critical to provide for future\n   extensions of DHCP.\n\n   A client or server MUST discard any received DHCP messages with an\n   unknown message type.\n\n   Clients SHOULD NOT accept multicast messages.\n\n   Servers SHOULD NOT accept unicast traffic from clients.  The Server\n   Unicast option (see Section 21.12) and UseMulticast status code (see Section 21.13) have been obsoleted and hence clients should no longer\n   send messages to a server's unicast address nor receive the\n   UseMulticast status code.  However, a server that previously\n   supported the Server Unicast option and is upgraded to not support \n   it, MAY continue to receive unicast messages if it previously sent\n   the client the Server Unicast option.  But this causes no harm and\n   the client will eventually switch back to sending multicast messages\n   (such as after the lease's rebinding time is reached or the client is\n   rebooted).\n\n   Relay agents SHOULD NOT accept unicast messages from clients.\n\n   Note: The multicast/unicast rules mentioned above apply to the DHCP\n   messages within this document.  Messages defined in other and future\n   documents may have different rules.",
        "children": {
          "16.1": {
            "title": "Use of Transaction IDs",
            "content": "   The \"transaction-id\" field holds a value used by clients and servers\n   to synchronize server responses to client messages.  A client SHOULD\n   generate a random number that cannot easily be guessed or predicted\n   to use as the transaction ID for each new message it sends.  Note\n   that if a client generates easily predictable transaction\n   identifiers, it may become more vulnerable to certain kinds of\n   attacks from off-path intruders.  A client MUST leave the transaction\n   ID unchanged in retransmissions of a message.",
            "children": {}
          },
          "16.2": {
            "title": "Solicit Message",
            "content": "   Clients MUST discard any received Solicit messages.\n\n   Servers MUST discard any Solicit messages that do not include a\n   Client Identifier option or that do include a Server Identifier\n   option.",
            "children": {}
          },
          "16.3": {
            "title": "Advertise Message",
            "content": "   Clients MUST discard any received Advertise message that meets any of\n   the following conditions:\n\n   *  the message does not include a Server Identifier option (see Section 21.3).\n\n   *  the message does not include a Client Identifier option (see Section 21.2).\n\n   *  the contents of the Client Identifier option do not match the\n      client's DUID.\n\n   *  the \"transaction-id\" field value does not match the value the\n      client used in its Solicit message. \n   Servers and relay agents MUST discard any received Advertise\n   messages.",
            "children": {}
          },
          "16.4": {
            "title": "Request Message",
            "content": "   Clients MUST discard any received Request messages.\n\n   Servers MUST discard any received Request message that meets any of\n   the following conditions:\n\n   *  the message does not include a Server Identifier option (see Section 21.3).\n\n   *  the contents of the Server Identifier option do not match the\n      server's DUID.\n\n   *  the message does not include a Client Identifier option (see Section 21.2).",
            "children": {}
          },
          "16.5": {
            "title": "Confirm Message",
            "content": "   Clients MUST discard any received Confirm messages.\n\n   Servers MUST discard any received Confirm messages that do not\n   include a Client Identifier option (see Section 21.2) or that do\n   include a Server Identifier option (see Section 21.3).",
            "children": {}
          },
          "16.6": {
            "title": "Renew Message",
            "content": "   Clients MUST discard any received Renew messages.\n\n   Servers MUST discard any received Renew message that meets any of the\n   following conditions:\n\n   *  the message does not include a Server Identifier option (see Section 21.3).\n\n   *  the contents of the Server Identifier option do not match the\n      server's identifier.\n\n   *  the message does not include a Client Identifier option (see Section 21.2).",
            "children": {}
          },
          "16.7": {
            "title": "Rebind Message",
            "content": "   Clients MUST discard any received Rebind messages. \n   Servers MUST discard any received Rebind messages that do not include\n   a Client Identifier option (see Section 21.2) or that do include a\n   Server Identifier option (see Section 21.3).",
            "children": {}
          },
          "16.8": {
            "title": "Decline Message",
            "content": "   Clients MUST discard any received Decline messages.\n\n   Servers MUST discard any received Decline message that meets any of\n   the following conditions:\n\n   *  the message does not include a Server Identifier option (see Section 21.3).\n\n   *  the contents of the Server Identifier option do not match the\n      server's identifier.\n\n   *  the message does not include a Client Identifier option (see Section 21.2).",
            "children": {}
          },
          "16.9": {
            "title": "Release Message",
            "content": "   Clients MUST discard any received Release messages.\n\n   Servers MUST discard any received Release message that meets any of\n   the following conditions:\n\n   *  the message does not include a Server Identifier option (see Section 21.3).\n\n   *  the contents of the Server Identifier option do not match the\n      server's identifier.\n\n   *  the message does not include a Client Identifier option (see Section 21.2).",
            "children": {}
          },
          "16.10": {
            "title": "Reply Message",
            "content": "   Clients MUST discard any received Reply message that meets any of the\n   following conditions:\n\n   *  the message does not include a Server Identifier option (see Section 21.3).\n\n   *  the \"transaction-id\" field in the message does not match the value\n      used in the original message. \n   If the client included a Client Identifier option (see Section 21.2)\n   in the original message, the Reply message MUST include a Client\n   Identifier option, and the contents of the Client Identifier option\n   MUST match the DUID of the client.  If the client did not include a\n   Client Identifier option in the original message, the Reply message\n   MUST NOT include a Client Identifier option.\n\n   Servers and relay agents MUST discard any received Reply messages.",
            "children": {}
          },
          "16.11": {
            "title": "Reconfigure Message",
            "content": "   Servers and relay agents MUST discard any received Reconfigure\n   messages.\n\n   Clients MUST discard any Reconfigure message that meets any of the\n   following conditions:\n\n   *  the message was not unicast to the client.\n\n   *  the message does not include a Server Identifier option (see Section 21.3).\n\n   *  the message does not include a Client Identifier option (see Section 21.2) that contains the client's DUID.\n\n   *  the message does not include a Reconfigure Message option (see Section 21.19).\n\n   *  the Reconfigure Message option msg-type is not a valid value.\n\n   *  the message does not include authentication (such as RKAP; see Section 20.4) or fails authentication validation.",
            "children": {}
          },
          "16.12": {
            "title": "Information-request Message",
            "content": "   Clients MUST discard any received Information-request messages.\n\n   Servers MUST discard any received Information-request message that\n   meets any of the following conditions:\n\n   *  the message includes a Server Identifier option (see Section 21.3), and the DUID in the option does not match the\n      server's DUID.\n\n   *  the message includes an IA option. \n\n\n\n",
            "children": {}
          },
          "16.13": {
            "title": "Relay-forward Message",
            "content": "   Clients MUST discard any received Relay-forward messages.",
            "children": {}
          },
          "16.14": {
            "title": "Relay-reply Message",
            "content": "   Clients and servers MUST discard any received Relay-reply messages.",
            "children": {}
          }
        }
      },
      "17": {
        "title": "Client Source Address and Interface Selection",
        "content": "   The client's behavior regarding interface selection is different,\n   depending on the purpose of the configuration.",
        "children": {
          "17.1": {
            "title": "Source Address and Interface Selection for Address Assignment",
            "content": "   When a client sends a DHCP message to the\n   All_DHCP_Relay_Agents_and_Servers multicast address, it SHOULD send\n   the message through the interface for which configuration information\n   (including the addresses) is being requested.  However, the client\n   MAY send the message through another interface if the interface for\n   which configuration is being requested is a logical interface without\n   direct link attachment or the client is certain that two interfaces\n   are attached to the same link.",
            "children": {}
          },
          "17.2": {
            "title": "Source Address and Interface Selection for Prefix Delegation",
            "content": "   Delegated prefixes are not associated with a particular interface in\n   the same way as addresses are for address assignment as mentioned in Section 17.1 above.\n\n   When a client sends a DHCP message for the purpose of prefix\n   delegation, it SHOULD be sent on the interface associated with the\n   upstream router (typically, connected to an ISP network); see\n   [RFC7084].  The upstream interface is typically determined by\n   configuration.  This rule applies even in the case where a separate\n   IA_PD is used for each downstream interface.",
            "children": {}
          }
        }
      },
      "18": {
        "title": "DHCP Configuration Exchanges",
        "content": "   A client initiates a message exchange with a server or servers to\n   acquire or update configuration information of interest.  A client\n   has many reasons to initiate the configuration exchange.  Some of the\n   more common ones are:\n\n   1.  as part of the operating system configuration/bootstrap process,\n\n   2.  when requested to do so by the application layer (through an\n       operating-system-specific API),\n   3.  when a Router Advertisement indicates that DHCPv6 is available\n       for address configuration (see Section 4.2 of [RFC4861]),\n\n   4.  as required to extend the lifetime of address(es) and/or\n       delegated prefix(es), using Renew and Rebind messages, or\n\n   5.  upon the receipt of a Reconfigure message, when requested to do\n       so by a server.\n\n   The client is responsible for creating IAs and requesting that a\n   server assign addresses and/or delegated prefixes to the IAs.  The\n   client first creates the IAs and assigns IAIDs to them.  The client\n   then transmits a Solicit message containing the IA options describing\n   the IAs.  The client MUST NOT be using any of the addresses or\n   delegated prefixes for which it tries to obtain the bindings by\n   sending the Solicit message.  In particular, if the client had some\n   valid bindings and has chosen to start the server discovery process\n   to obtain the same bindings from a different server, the client MUST\n   stop using the addresses and delegated prefixes for the bindings that\n   it had obtained from the previous server (see Section 18.2.7 for more\n   details on what \"stop using\" means in this context) and that it is\n   now trying to obtain from a new server.\n\n   A DHCP client that does not need to have a DHCP server assign IP\n   addresses or delegated prefixes to it can obtain configuration\n   information such as a list of available DNS servers [RFC3646] or NTP\n   servers [RFC5908] through a single message and reply exchange with a\n   DHCP server.  To obtain configuration information, the client first\n   sends an Information-request message (see Section 18.2.6) to the\n   All_DHCP_Relay_Agents_and_Servers multicast address.  Servers respond\n   with a Reply message containing the configuration information for the\n   client (see Section 18.3.6).\n\n   To request the assignment of one or more addresses or delegated\n   prefixes, a client first locates a DHCP server and then requests the\n   assignment of addresses/prefixes and other configuration information\n   from the server.  The client does this by sending the Solicit message\n   (see Section 18.2.1) to the All_DHCP_Relay_Agents_and_Servers\n   multicast address and collecting Advertise messages from the servers\n   that respond to the client's message; the client then selects a\n   server from which it wants to obtain configuration information.  This\n   process is referred to as server discovery.  When the client has\n   selected the server, it sends a Request message to that server as\n   described in Section 18.2.2.\n\n   A client willing to perform the Solicit/Reply message exchange\n   described in Section 18.2.1 includes a Rapid Commit option (see Section 21.14) in its Solicit message. \n   Servers that can assign addresses or delegated prefixes to the IAs\n   respond to the client with an Advertise message or Reply message if\n   the client included a Rapid Commit option and the server is\n   configured to accept it.\n\n   If the server responds with an Advertise message, the client\n   initiates a configuration exchange as described in Section 18.2.2.\n\n   A server may initiate a message exchange with a client by sending a\n   Reconfigure message to cause the client to send a Renew, Rebind, or\n   Information-request message to refresh its configuration information\n   as soon as the Reconfigure message is received by the client.\n\n   Figure 9 shows a timeline diagram of the messages exchanged between a\n   client and two servers for the typical lifecycle of one or more\n   leases.  This starts with the four-message Solicit/Advertise/\n   Request/Reply exchange to obtain the lease(s), followed by a\n   two-message Renew/Reply exchange to extend the lifetime on the\n   lease(s), and then ends with a two-message Release/Reply exchange to\n   end the client's use of the lease(s).\n\n                Server                          Server\n            (not selected)      Client        (selected)\n\n                  v               v               v\n                  |               |               |\n                  |     Begins initialization     |\n                  |               |               |\n     start of     | _____________/|\\_____________ |\n     4-message    |/ Solicit      | Solicit      \\|\n     exchange     |               |               |\n              Determines          |          Determines\n             configuration        |         configuration\n                  |               |               |\n                  |\\              |  ____________/|\n                  | \\________     | /Advertise    |\n                  | Advertise\\    |/              |\n                  |           \\   |               |\n                  |      Collects Advertises      |\n                  |             \\ |               |\n                  |     Selects configuration     |\n                  |               |               |\n                  | _____________/|\\_____________ |\n                  |/ Request      |  Request     \\|\n                  |               |               |\n                  |               |     Commits configuration\n                  |               |               |\n     end of       |               | _____________/|\n     4-message    |               |/ Reply        |\n     exchange     |               |               |\n                  |    Initialization complete    |\n                  |               |               |\n                  .               .               .\n                  .               .               .\n                  |   T1 (renewal) timer expires  |\n                  |               |               |\n     2-message    | _____________/|\\_____________ |\n     exchange     |/ Renew        |  Renew       \\|\n                  |               |               |\n                  |               | Commits extended lease(s)\n                  |               |               |\n                  |               | _____________/|\n                  |               |/ Reply        |\n                  .               .               .\n                  .               .               .\n                  |               |               |\n                  |      Graceful shutdown        |\n                  |               |               |\n     2-message    | _____________/|\\_____________ |\n     exchange     |/ Release      |  Release     \\|\n                  |               |               |\n                  |               |         Discards lease(s)\n                  |               |               |\n                  |               | _____________/|\n                  |               |/ Reply        |\n                  |               |               |\n                  v               v               v\n\n       Figure 9: Timeline Diagram of the Messages Exchanged between a\n      Client and Two Servers for the Typical Lifecycle of One or More\n                                   Leases",
        "children": {
          "18.1": {
            "title": "A Single Exchange for Multiple IA Options",
            "content": "   This document assumes that a client SHOULD use a single transaction\n   for all of the IA options required on an interface; this simplifies\n   the client implementation and reduces the potential number of\n   transactions required.  To facilitate a client's use of a single\n   transaction for all IA options, servers MUST return the same T1/T2\n   values for all IA options in a Reply (see Sections 18.3.2, 18.3.4,\n   and 18.3.5) so that the client will generate a single transaction\n   when renewing or rebinding its leases.  However, because some servers\n   may not yet conform to this requirement, a client MUST be prepared to\n   select appropriate T1/T2 times as described in Section 18.2.4. \n\n\n\n",
            "children": {}
          },
          "18.2": {
            "title": "Client Behavior",
            "content": "   A client uses the Solicit message to discover DHCP servers configured\n   to assign leases or return other configuration parameters on the link\n   to which the client is attached.\n\n   A client uses Request, Renew, Rebind, Release, and Decline messages\n   during the normal lifecycle of addresses and delegated prefixes.\n   When a client detects that it may have moved to a new link, it uses\n   Confirm if it only has addresses and Rebind if it has delegated\n   prefixes (and addresses).  It uses Information-request messages when\n   it needs configuration information but no addresses and no prefixes.\n\n   When a client requests multiple IA option types or multiple instances\n   of the same IA types in a Solicit, Request, Renew, or Rebind, it is\n   possible that the available server(s) may only be configured to offer\n   a subset of them.  When possible, the client SHOULD use the best\n   configuration available and continue to request the additional IAs in\n   subsequent messages.  This allows the client to maintain a single\n   session and state machine.  In practice, especially in the case of\n   handling IA_NA and IA_PD requests [RFC7084], this situation should be\n   rare or a result of a temporary operational error.  Thus, it is more\n   likely that the client will get all configuration if it continues, in\n   each subsequent configuration exchange, to request all the\n   configuration information it is programmed to try to obtain,\n   including any stateful configuration options for which no results\n   were returned in previous message exchanges.\n\n   Upon receipt of a Reconfigure message from the server, a client\n   responds with a Renew, Rebind, or Information-request message as\n   indicated by the Reconfigure Message option (see Section 21.19).  The\n   client SHOULD be suspicious of the Reconfigure message (they may be\n   faked), and it MUST NOT abandon any resources it might have already\n   obtained.  The client SHOULD treat the Reconfigure message as if the\n   T1 timer had expired.  The client will expect the server to send IAs\n   and/or other configuration information to the client in a Reply\n   message.",
            "children": {
              "18.2.1": {
                "title": "Creation and Transmission of Solicit Messages",
                "content": "   The client sets the \"msg-type\" field to SOLICIT.  The client\n   generates a transaction ID and inserts this value in the\n   \"transaction-id\" field.\n\n   The client MUST include a Client Identifier option (see Section 21.2)\n   to identify itself to the server.  The client includes IA options for\n   any IAs to which it wants the server to assign leases. \n   The client MUST include an Elapsed Time option (see Section 21.9) to\n   indicate how long the client has been trying to complete the current\n   DHCP message exchange.\n\n   The client uses IA_NA options (see Section 21.4) to request the\n   assignment of non-temporary addresses and IA_PD options (see Section 21.21) to request prefix delegation.  IA_NA or IA_PD options,\n   or a combination, can be included in DHCP messages.  In addition,\n   multiple instances of any IA option type can be included.\n\n   The client MAY include addresses in IA Address options (see Section 21.6) encapsulated within IA_NA option as hints to the server\n   about the addresses for which the client has a preference.\n\n   The client MAY include values in IA Prefix options (see Section 21.22) encapsulated within IA_PD options as hints for the\n   delegated prefix and/or prefix length for which the client has a\n   preference.  See Section 18.2.4 for more on prefix-length hints.\n\n   The client MUST include an Option Request option (ORO) (see Section 21.7) to request the SOL_MAX_RT option (see Section 21.24)\n   and any other options the client is interested in receiving.  The\n   client MAY additionally include instances of those options that are\n   identified in the Option Request option, with data values as hints to\n   the server about parameter values the client would like to have\n   returned.\n\n   The client includes a Reconfigure Accept option (see Section 21.20)\n   if the client is willing to accept Reconfigure messages from the\n   server.\n\n   The client MUST NOT include any other options in the Solicit message,\n   except as specifically allowed in the definition of individual\n   options.\n\n   The first Solicit message from the client on the interface SHOULD be\n   delayed by a random amount of time between 0 and SOL_MAX_DELAY.  This\n   random delay helps desynchronize clients that start a DHCP session at\n   the same time, such as after recovery from a power failure or after a\n   router outage after seeing that DHCP is available in Router\n   Advertisement messages (see Section 4.2 of [RFC4861]).\n\n   The client transmits the message according to Section 15, using the\n   following parameters:\n\n   IRT        SOL_TIMEOUT\n\n   MRT        SOL_MAX_RT \n   MRC        0\n\n   MRD        0\n\n   A client that wishes to use the Rapid Commit two-message exchange\n   includes a Rapid Commit option (see Section 21.14) in its Solicit\n   message.  The client may receive a number of different replies from\n   different servers.  The client will make note of any valid Advertise\n   messages that it receives.  The client will discard any Reply\n   messages that do not contain the Rapid Commit option.\n\n   Upon receipt of a valid Reply with the Rapid Commit option, the\n   client processes the message as described in Section 18.2.10.\n\n   At the end of the first RT period, if no suitable Reply messages are\n   received but the client has valid Advertise messages, then the client\n   processes the Advertise as described in Section 18.2.9.\n\n   If the client subsequently receives a valid Reply message that\n   includes a Rapid Commit option, it does one of the following:\n\n   *  processes the Reply message as described in Section 18.2.10 and\n      discards any Reply messages received in response to the Request\n      message\n\n   *  processes any Reply messages received in response to the Request\n      message and discards the Reply message that includes the Rapid\n      Commit option\n\n   If the client is waiting for an Advertise message, the mechanism\n   described in Section 15 is modified as follows for use in the\n   transmission of Solicit messages.  The message exchange is not\n   terminated by the receipt of an Advertise before the first RT has\n   elapsed.  Rather, the client collects valid Advertise messages until\n   the first RT has elapsed.  Also, the first RT MUST be selected to be\n   strictly greater than IRT by choosing RAND to be strictly greater\n   than 0.\n\n   A client MUST collect valid Advertise messages for the first\n   RT seconds, unless it receives a valid Advertise message with a\n   preference value of 255.  The preference value is carried in the\n   Preference option (see Section 21.8).  Any valid Advertise that does\n   not include a Preference option is considered to have a preference\n   value of 0.  If the client receives a valid Advertise message that\n   includes a Preference option with a preference value of 255, the\n   client immediately begins a client-initiated message exchange (as\n   described in Section 18.2.2) by sending a Request message to the\n   server from which the Advertise message was received.  If the client \n   receives a valid Advertise message that does not include a Preference\n   option with a preference value of 255, the client continues to wait\n   until the first RT elapses.  If the first RT elapses and the client\n   has received a valid Advertise message, the client SHOULD continue\n   with a client-initiated message exchange by sending a Request\n   message.\n\n   If the client does not receive any valid Advertise messages before\n   the first RT has elapsed, it then applies the retransmission\n   mechanism described in Section 15.  The client terminates the\n   retransmission process as soon as it receives any valid Advertise\n   message, and the client acts on the received Advertise message\n   without waiting for any additional Advertise messages.\n\n   A DHCP client SHOULD choose MRC and MRD values of 0.  If the DHCP\n   client is configured with either MRC or MRD set to a value other than\n   0, it MUST stop trying to configure the interface if the message\n   exchange fails.  After the DHCP client stops trying to configure the\n   interface, it SHOULD restart the reconfiguration process after some\n   external event, such as user input, system restart, or when the\n   client is attached to a new link.",
                "children": {}
              },
              "18.2.2": {
                "title": "Creation and Transmission of Request Messages",
                "content": "   The client uses a Request message to populate IAs with leases and\n   obtain other configuration information.  The client includes one or\n   more IA options in the Request message.  The server then returns\n   leases and other information about the IAs to the client in IA\n   options in a Reply message.\n\n   The client sets the \"msg-type\" field to REQUEST.  The client\n   generates a transaction ID and inserts this value in the\n   \"transaction-id\" field.\n\n   The client MUST include the identifier of the destination server in a\n   Server Identifier option (see Section 21.3).\n\n   The client MUST include a Client Identifier option (see Section 21.2)\n   to identify itself to the server.  The client adds any other\n   appropriate options, including one or more IA options.\n\n   The client MUST include an Elapsed Time option (see Section 21.9) to\n   indicate how long the client has been trying to complete the current\n   DHCP message exchange.\n\n   The client MUST include an Option Request option (see Section 21.7)\n   to request the SOL_MAX_RT option (see Section 21.24) and any other\n   options the client is interested in receiving.  The client MAY \n   additionally include instances of those options that are identified\n   in the Option Request option, with data values as hints to the server\n   about parameter values the client would like to have returned.\n\n   The client includes a Reconfigure Accept option (see Section 21.20)\n   if the client is willing to accept Reconfigure messages from the\n   server.\n\n   The client transmits the message according to Section 15, using the\n   following parameters:\n\n   IRT        REQ_TIMEOUT\n\n   MRT        REQ_MAX_RT\n\n   MRC        REQ_MAX_RC\n\n   MRD        0\n\n   If the message exchange fails, the client takes an action based on\n   the client's local policy.  Examples of actions the client might take\n   include the following:\n\n   *  Select another server from a list of servers known to the client\n      -- for example, servers that responded with an Advertise message.\n\n   *  Initiate the server discovery process described in Section 18.\n\n   *  Terminate the configuration process and report failure.",
                "children": {}
              },
              "18.2.3": {
                "title": "Creation and Transmission of Confirm Messages",
                "content": "   The client uses a Confirm message when it has only addresses (no\n   delegated prefixes) assigned by a DHCP server to determine if it is\n   still connected to the same link when the client detects a change in\n   network information as described in Section 18.2.12.\n\n   The client sets the \"msg-type\" field to CONFIRM.  The client\n   generates a transaction ID and inserts this value in the\n   \"transaction-id\" field.\n\n   The client MUST include a Client Identifier option (see Section 21.2)\n   to identify itself to the server.\n\n   The client MUST include an Elapsed Time option (see Section 21.9) to\n   indicate how long the client has been trying to complete the current\n   DHCP message exchange. \n   The client includes IA options for all of the IAs assigned to the\n   interface for which the Confirm message is being sent.  The IA\n   options include all of the addresses the client currently has\n   associated with those IAs.  The client SHOULD set the T1 and T2\n   fields in any IA_NA options (see Section 21.4) and the\n   preferred-lifetime and valid-lifetime fields in the IA Address\n   options (see Section 21.6) to 0, as the server will ignore these\n   fields.\n\n   The first Confirm message from the client on the interface MUST be\n   delayed by a random amount of time between 0 and CNF_MAX_DELAY.  The\n   client transmits the message according to Section 15, using the\n   following parameters:\n\n   IRT        CNF_TIMEOUT\n\n   MRT        CNF_MAX_RT\n\n   MRC        0\n\n   MRD        CNF_MAX_RD\n\n   If the client receives no responses before the message transmission\n   process terminates, as described in Section 15, the client SHOULD\n   continue to use any leases, using the last known lifetimes for those\n   leases, and SHOULD continue to use any other previously obtained\n   configuration parameters.",
                "children": {}
              },
              "18.2.4": {
                "title": "Creation and Transmission of Renew Messages",
                "content": "   To extend the preferred and valid lifetimes for the leases assigned\n   to the IAs and obtain new addresses or delegated prefixes for IAs,\n   the client sends a Renew message to the server from which the leases\n   were obtained; the Renew message includes IA options for the IAs\n   whose lease lifetimes are to be extended.  The client includes IA\n   Address options (see Section 21.6) within IA_NA (see Section 21.4)\n   options for the addresses assigned to the IAs.  The client includes\n   IA Prefix options (see Section 21.22) within IA_PD options (see Section 21.21) for the delegated prefixes assigned to the IAs.\n\n   The server controls the time at which the client should contact the\n   server to extend the lifetimes on assigned leases through the T1 and\n   T2 values assigned to an IA.  However, as the client SHOULD\n   renew/rebind all IAs from the server at the same time, the client\n   MUST select T1 and T2 times from all IA options that will guarantee\n   that the client initiates transmissions of Renew/Rebind messages not\n   later than at the T1/T2 times associated with any of the client's\n   bindings (earliest T1/T2). \n   At time T1, the client initiates a Renew/Reply message exchange to\n   extend the lifetimes on any leases in the IA.\n\n   A client MUST also initiate a Renew/Reply message exchange before\n   time T1 if the client's link-local address used in previous\n   interactions with the server is no longer valid and it is willing to\n   receive Reconfigure messages.  This updates the server's information\n   so it is able to continue to communicate with the client (either\n   directly or via Relay-reply's).\n\n   If T1 or T2 had been set to 0 by the server (for an IA_NA or IA_PD)\n   in a previous Reply, the client may, at its discretion, send a Renew\n   or Rebind message, respectively.  The client MUST follow the rules\n   defined in Section 14.2.\n\n   The client sets the \"msg-type\" field to RENEW.  The client generates\n   a transaction ID and inserts this value in the \"transaction-id\"\n   field.\n\n   The client MUST include a Server Identifier option (see Section 21.3)\n   in the Renew message, identifying the server with which the client\n   most recently communicated.\n\n   The client MUST include a Client Identifier option (see Section 21.2)\n   to identify itself to the server.  The client adds any appropriate\n   options, including one or more IA options.\n\n   The client MUST include an Elapsed Time option (see Section 21.9) to\n   indicate how long the client has been trying to complete the current\n   DHCP message exchange.\n\n   For IAs to which leases have been assigned, the client includes a\n   corresponding IA option containing an IA Address option for each\n   address assigned to the IA and an IA Prefix option for each prefix\n   assigned to the IA.  The client MUST NOT include addresses and\n   prefixes in any IA option that the client did not obtain from the\n   server or that are no longer valid (that have a valid lifetime of 0).\n\n   The client MAY include an IA option for each binding it desires but\n   has been unable to obtain.  In this case, if the client includes the\n   IA_PD option to request prefix delegation, the client MAY include the\n   IA Prefix option encapsulated within the IA_PD option, with the\n   \"IPv6-prefix\" field set to 0 and the \"prefix-length\" field set to the\n   desired length of the prefix to be delegated.  The server MAY use\n   this value as a hint for the prefix length.  The client SHOULD NOT\n   include an IA Prefix option with the \"IPv6-prefix\" field set to 0\n   unless it is supplying a hint for the prefix length. \n   The client includes an Option Request option (see Section 21.7) to\n   request the SOL_MAX_RT option (see Section 21.24) and any other\n   options the client is interested in receiving.  The client MAY\n   include options with data values as hints to the server about\n   parameter values the client would like to have returned.\n\n   The client transmits the message according to Section 15, using the\n   following parameters:\n\n   IRT        REN_TIMEOUT\n\n   MRT        REN_MAX_RT\n\n   MRC        0\n\n   MRD        Remaining time until earliest T2\n\n   The message exchange is terminated when the earliest time T2 is\n   reached.  While the client is responding to a Reconfigure, the client\n   ignores and discards any additional Reconfigure messages it may\n   receive.\n\n   The message exchange is terminated when the earliest time T2 is\n   reached, at which point the client begins the Rebind message exchange\n   (see Section 18.2.5).",
                "children": {}
              },
              "18.2.5": {
                "title": "Creation and Transmission of Rebind Messages",
                "content": "   At time T2 (which will only be reached if the server to which the\n   Renew message was sent starting at time T1 has not responded), the\n   client initiates a Rebind/Reply message exchange with any available\n   server.\n\n   A Rebind is also used to verify delegated prefix bindings but with\n   different retransmission parameters as described in Section 18.2.3.\n\n   The client constructs the Rebind message as described in Section 18.2.4, with the following differences:\n\n   *  The client sets the \"msg-type\" field to REBIND.\n\n   *  The client does not include the Server Identifier option (see Section 21.3) in the Rebind message.\n\n   The client transmits the message according to Section 15, using the\n   following parameters:\n\n   IRT        REB_TIMEOUT \n   MRT        REB_MAX_RT\n\n   MRC        0\n\n   MRD        Remaining time until valid lifetimes of all leases in all\n              IAs have expired\n\n   If all leases for an IA have expired, the client may choose to\n   include this IA in subsequent Rebind messages to indicate that the\n   client is interested in assignment of the leases to this IA.\n\n   The message exchange is terminated when the valid lifetimes of all\n   leases across all IAs have expired, at which time the client uses the\n   Solicit message to locate a new DHCP server and sends a Request for\n   the expired IAs to the new server.  If the terminated Rebind exchange\n   was initiated as a result of receiving a Reconfigure message, the\n   client terminates the reconfigure process and resumes as if the\n   Reconfigure message had not been received.",
                "children": {}
              },
              "18.2.6": {
                "title": "Creation and Transmission of Information-request Messages",
                "content": "   The client uses an Information-request message to obtain\n   configuration information without requesting addresses and/or\n   delegated prefixes to be assigned.\n\n   The client sets the \"msg-type\" field to INFORMATION-REQUEST.  The\n   client generates a transaction ID and inserts this value in the\n   \"transaction-id\" field.\n\n   The client SHOULD include a Client Identifier option (see Section 21.2) to identify itself to the server (however, see Section 4.3.1 of [RFC7844] for reasons why a client may not want to\n   include this option).  If the client does not include a Client\n   Identifier option, the server will not be able to return any\n   client-specific options to the client, or the server may choose not\n   to respond to the message at all.\n\n   The client MUST include an Elapsed Time option (see Section 21.9) to\n   indicate how long the client has been trying to complete the current\n   DHCP message exchange.\n\n   The client MUST include an Option Request option (see Section 21.7)\n   to request the INF_MAX_RT option (see Section 21.25), the Information\n   Refresh Time option (see Section 21.23), and any other options the\n   client is interested in receiving.  The client MAY include options\n   with data values as hints to the server about parameter values the\n   client would like to have returned. \n   When responding to a Reconfigure, the client MUST include a Server\n   Identifier option (see Section 21.3) with the identifier from the\n   Reconfigure message to which the client is responding.\n\n   The first Information-request message from the client on the\n   interface MUST be delayed by a random amount of time between 0 and\n   INF_MAX_DELAY.  The client transmits the message according to Section 15, using the following parameters:\n\n   IRT        INF_TIMEOUT\n\n   MRT        INF_MAX_RT\n\n   MRC        0\n\n   MRD        0",
                "children": {}
              },
              "18.2.7": {
                "title": "Creation and Transmission of Release Messages",
                "content": "   To release one or more leases, a client sends a Release message to\n   the server.\n\n   The client sets the \"msg-type\" field to RELEASE.  The client\n   generates a transaction ID and places this value in the\n   \"transaction-id\" field.\n\n   The client MUST include a Server Identifier option (see Section 21.3)\n   in the Renew message, identifying the server which allocated the\n   lease(s).\n\n   The client MUST include a Client Identifier option (see Section 21.2)\n   to identify itself to the server.\n\n   The client MUST include an Elapsed Time option (see Section 21.9) to\n   indicate how long the client has been trying to complete the current\n   DHCP message exchange.\n\n   The client includes options containing the IAs for the leases it is\n   releasing in the \"options\" field.  The leases to be released MUST be\n   included in the IAs.  Any leases for the IAs the client wishes to\n   continue to use MUST NOT be added to the IAs. \n   The client MUST stop using all of the leases being released before\n   the client begins the Release message exchange process.  For an\n   address, this means the address MUST have been removed from the\n   interface.  For a delegated prefix, this means the prefix MUST have\n   been advertised with a Preferred Lifetime and a Valid Lifetime of 0\n   in a Router Advertisement message as described in part (e) of Section 5.5.3 of [RFC4862]; also see requirement L-13 in Section 4.3\n   of [RFC7084].\n\n   The client MUST NOT use any of the addresses it is releasing as the\n   source address in the Release message or in any subsequently\n   transmitted message.\n\n   Because Release messages may be lost, the client should retransmit\n   the Release if no Reply is received.  However, there are scenarios\n   where the client may not wish to wait for the normal retransmission\n   timeout before giving up (e.g., on power down).  Implementations\n   SHOULD retransmit one or more times but MAY choose to terminate the\n   retransmission procedure early.\n\n   The client transmits the message according to Section 15, using the\n   following parameters:\n\n   IRT        REL_TIMEOUT\n\n   MRT        0\n\n   MRC        REL_MAX_RC\n\n   MRD        0\n\n   If leases are released but the Reply from a DHCP server is lost, the\n   client will retransmit the Release message, and the server may\n   respond with a Reply indicating a status of NoBinding.  Therefore,\n   the client does not treat a Reply message with a status of NoBinding\n   in a Release message exchange as if it indicates an error.\n\n   Note that if the client fails to release the lease, each lease\n   assigned to the IA will be reclaimed by the server when the valid\n   lifetime of that lease expires.",
                "children": {}
              },
              "18.2.8": {
                "title": "Creation and Transmission of Decline Messages",
                "content": "   If a client detects that one or more addresses assigned to it by a\n   server are already in use by another node, the client sends a Decline\n   message to the server to inform it that the address is suspect. \n   The Decline message is not used in prefix delegation; thus, the\n   client MUST NOT include IA_PD options (see Section 21.21) in the\n   Decline message.\n\n   The client sets the \"msg-type\" field to DECLINE.  The client\n   generates a transaction ID and places this value in the\n   \"transaction-id\" field.\n\n   The client MUST include a Server Identifier option (see Section 21.3)\n   in the Decline message, identifying the server which allocated the\n   lease(s).\n\n   The client MUST include a Client Identifier option (see Section 21.2)\n   to identify itself to the server.\n\n   The client MUST include an Elapsed Time option (see Section 21.9) to\n   indicate how long the client has been trying to complete the current\n   DHCP message exchange.\n\n   The client includes options containing the IAs for the addresses it\n   is declining in the \"options\" field.  The addresses to be declined\n   MUST be included in the IAs.  Any addresses for the IAs the client\n   wishes to continue to use should not be added to the IAs.\n\n   The client MUST NOT use any of the addresses it is declining as the\n   source address in the Decline message or in any subsequently\n   transmitted message.\n\n   The client transmits the message according to Section 15, using the\n   following parameters:\n\n   IRT        DEC_TIMEOUT\n\n   MRT        0\n\n   MRC        DEC_MAX_RC\n\n   MRD        0\n\n   If addresses are declined but the Reply from a DHCP server is lost,\n   the client will retransmit the Decline message, and the server may\n   respond with a Reply indicating a status of NoBinding.  Therefore,\n   the client does not treat a Reply message with a status of NoBinding\n   in a Decline message exchange as if it indicates an error.\n\n   The client SHOULD NOT send a Release message for other bindings it\n   may have received just because it sent a Decline message.  The client\n   SHOULD retain the non-conflicting bindings.  The client SHOULD treat \n   the failure to acquire a binding (due to the conflict) as equivalent\n   to not having received the binding, insofar as how it behaves when\n   sending Renew and Rebind messages.",
                "children": {}
              },
              "18.2.9": {
                "title": "Receipt of Advertise Messages",
                "content": "   Upon receipt of one or more valid Advertise messages, the client\n   selects one or more Advertise messages based upon the following\n   criteria.\n\n   *  Those Advertise messages with the highest server preference value\n      SHOULD be preferred over all other Advertise messages.  The client\n      MAY choose a less preferred server if that server has a better set\n      of advertised parameters, such as the available set of IAs, as\n      well as the set of other configuration options advertised.\n\n   *  Within a group of Advertise messages with the same server\n      preference value, a client MAY select those servers whose\n      Advertise messages advertise information of interest to the\n      client.\n\n   Once a client has selected Advertise message(s), the client will\n   typically store information about each server, such as the server\n   preference value, addresses advertised, when the advertisement was\n   received, and so on.\n\n   In practice, this means that the client will maintain independent\n   per-IA state machines for each selected server.\n\n   If the client needs to select an alternate server in the case that a\n   chosen server does not respond, the client chooses the next server\n   according to the criteria given above.\n\n   The client MUST process any SOL_MAX_RT option (see Section 21.24) and\n   INF_MAX_RT option (see Section 21.25) present in an Advertise\n   message, even if the message contains a Status Code option (see Section 21.13) indicating a failure, and the Advertise message will\n   be discarded by the client.  A client SHOULD only update its\n   SOL_MAX_RT and INF_MAX_RT values if all received Advertise messages\n   that contained the corresponding option specified the same value;\n   otherwise, it should use the default value (see Section 7.6).\n\n   The client MUST ignore any Advertise message that contains no\n   addresses (IA Address options (see Section 21.6) encapsulated in\n   IA_NA options (see Section 21.4)) and no delegated prefixes (IA\n   Prefix options (see Section 21.22) encapsulated in IA_PD options (see Section 21.21)), with the exception that the client:\n   *  MUST process an included SOL_MAX_RT option and\n\n   *  MUST process an included INF_MAX_RT option.\n\n   A client can record in an activity log or display to the user any\n   associated status message(s).\n\n   The client ignoring an Advertise message MUST NOT restart the Solicit\n   retransmission timer.",
                "children": {}
              },
              "18.2.10": {
                "title": "Receipt of Reply Messages",
                "content": "   Upon the receipt of a valid Reply message in response to a Solicit\n   with a Rapid Commit option (see Section 21.14), Request, Confirm,\n   Renew, Rebind, or Information-request message, the client extracts\n   the top-level Status Code option (see Section 21.13) if present.\n\n   The client MUST process any SOL_MAX_RT option (see Section 21.24) and\n   INF_MAX_RT option (see Section 21.25) present in a Reply message,\n   even if the message contains a Status Code option indicating a\n   failure.\n\n   If the client receives a Reply message with a status code of\n   UnspecFail, the server is indicating that it was unable to process\n   the client's message due to an unspecified failure condition.  If the\n   client retransmits the original message to the same server to retry\n   the desired operation, the client MUST limit the rate at which it\n   retransmits the message and limit the duration of the time during\n   which it retransmits the message (see Section 14.1).\n\n   Otherwise (no status code or another status code), the client\n   processes the Reply as described below based on the original message\n   for which the Reply was received.\n\n   The client MAY choose to report any status code or message from the\n   Status Code option in the Reply message.\n\n   The topic of revoking previously assigned options is discussed in Section 18.2.10.5.\n\n   When a client receives a requested option that has an updated value\n   from what was previously received, the client SHOULD make use of that\n   updated value as soon as possible for its configuration information. \n\n\n\n",
                "children": {
                  "18.2.10.1": {
                    "title": "Reply for Solicit (with Rapid Commit), Request, Renew, or",
                    "content": "\n            Rebind    If the client receives a NotOnLink status from the server in response\n   to a Solicit (with a Rapid Commit option; see Section 21.14) or a\n   Request, the client can either reissue the message without specifying\n   any addresses or restart the DHCP server discovery process (see Section 18 or Section 18.2.13).\n\n   If the Reply was received in response to a Solicit (with a Rapid\n   Commit option), Request, Renew, or Rebind message, the client updates\n   the information it has recorded about IAs from the IA options\n   contained in the Reply message:\n\n   *  Calculate T1 and T2 times (based on T1 and T2 values sent in the\n      message and the message reception time), if appropriate for the IA\n      type.\n\n   *  Add any new leases in the IA option to the IA as recorded by the\n      client.\n\n   *  Update lifetimes for any leases in the IA option that the client\n      already has recorded in the IA.\n\n   *  Discard any leases from the IA, as recorded by the client, that\n      have a valid lifetime of 0 in the IA Address or IA Prefix option.\n\n   *  Leave unchanged any information about leases the client has\n      recorded in the IA but that were not included in the IA from the\n      server.\n\n   If the client can operate with the addresses and/or prefixes obtained\n   from the server:\n\n   *  The client uses the addresses, delegated prefixes, and other\n      information from any IAs that do not contain a Status Code option\n      with the NoAddrsAvail or NoPrefixAvail status code.  The client\n      MAY include the IAs for which it received the NoAddrsAvail or\n      NoPrefixAvail status code, with no addresses or prefixes, in\n      subsequent Renew and Rebind messages sent to the server, to retry\n      obtaining the addresses or prefixes for these IAs.\n\n   *  The client MUST perform duplicate address detection as per Section 5.4 of [RFC4862], which does list some exceptions, on each\n      of the received addresses in any IAs on which it has not performed\n      duplicate address detection during processing of any of the\n      previous Reply messages from the server.  The client performs the\n      duplicate address detection before using the received addresses \n      for any traffic.  If any of the addresses are found to be in use\n      on the link, the client sends a Decline message to the server for\n      those addresses as described in Section 18.2.8.\n\n   *  For each assigned address that does not have any associated\n      reachability information (see the definition of \"on-link\" in Section 2.1 of [RFC4861]), in order to avoid the problems\n      described in [RFC4943], the client MUST NOT assume that any\n      addresses are reachable on-link as a result of receiving an IA\n      Address option (see Section 21.6).  Addresses obtained from an IA\n      Address option MUST NOT be used to form an implicit prefix with a\n      length other than 128.\n\n   *  For each delegated prefix, the client assigns a subnet to each of\n      the links to which the associated interfaces are attached.\n\n      When a client subnets a delegated prefix, it must assign\n      additional bits to the prefix to generate unique, longer prefixes.\n      For example, if the client in Figure 1 were delegated\n      2001:db8:0::/48, it might generate 2001:db8:0:1::/64 and\n      2001:db8:0:2::/64 for assignment to the two links in the\n      subscriber network.  If the client were delegated 2001:db8:0::/48\n      and 2001:db8:5::/48, it might assign 2001:db8:0:1::/64 and\n      2001:db8:5:1::/64 to one of the links, and 2001:db8:0:2::/64 and\n      2001:db8:5:2::/64 for assignment to the other link.\n\n      If the client uses a delegated prefix to configure addresses on\n      interfaces on itself or other nodes behind it, the preferred and\n      valid lifetimes of those addresses MUST be no longer than the\n      remaining preferred and valid lifetimes, respectively, for the\n      delegated prefix at any time.  In particular, if the delegated\n      prefix or a prefix derived from it is advertised for stateless\n      address autoconfiguration [RFC4862], the advertised preferred and\n      valid lifetimes MUST NOT exceed the corresponding remaining\n      lifetimes of the delegated prefix.\n\n   Management of the specific configuration information is detailed in\n   the definition of each option in Section 21.\n\n   If the Reply message contains any IAs but the client finds no usable\n   addresses and/or delegated prefixes in any of these IAs, the client\n   may either try another server (perhaps restarting the DHCP server\n   discovery process) or use the Information-request message to obtain\n   other configuration information only.\n\n   When the client receives a Reply message in response to a Renew or\n   Rebind message, the client:\n   *  Sends a Request message to the server that responded if any of the\n      IAs in the Reply message contain the NoBinding status code.  The\n      client places IA options in this message for all IAs.  The client\n      continues to use other bindings for which the server did not\n      return an error.\n\n   *  Sends a Renew/Rebind if any of the IAs are not in the Reply\n      message, but as this likely indicates that the server that\n      responded does not support that IA type, sending immediately is\n      unlikely to produce a different result.  Therefore, the client\n      MUST rate-limit its transmissions (see Section 14.1) and MAY just\n      wait for the normal retransmission time (as if the Reply message\n      had not been received).  The client continues to use other\n      bindings for which the server did return information.\n\n   *  Otherwise accepts the information in the IA.",
                    "children": {}
                  },
                  "18.2.10.2": {
                    "title": "Reply for Release and Decline",
                    "content": "   When the client receives a valid Reply message in response to a\n   Release message, the client considers the Release event completed,\n   regardless of the Status Code option (see Section 21.13) returned by\n   the server.\n\n   When the client receives a valid Reply message in response to a\n   Decline message, the client considers the Decline event completed,\n   regardless of the Status Code option(s) returned by the server.",
                    "children": {}
                  },
                  "18.2.10.3": {
                    "title": "Reply for Confirm",
                    "content": "   If the client receives any Reply messages that indicate a status of\n   Success (explicit or implicit), the client can use the addresses in\n   the IA and ignore any messages that indicate a NotOnLink status.\n   When the client only receives one or more Reply messages with the\n   NotOnLink status in response to a Confirm message, the client\n   performs DHCP server discovery as described in Section 18.",
                    "children": {}
                  },
                  "18.2.10.4": {
                    "title": "Reply for Information-request",
                    "content": "   Refer to Section 21.23 for details on how the Information Refresh\n   Time option (whether or not present in the Reply) should be handled\n   by the client. \n\n\n\n",
                    "children": {}
                  },
                  "18.2.10.5": {
                    "title": "Revoking Previously Provided Options",
                    "content": "   When a client received a configuration option in an earlier Reply and\n   then sends a Renew, Rebind, or Information-request and the requested\n   option is not present in the Reply, the client SHOULD stop using the\n   previously received configuration information.  In other words, the\n   client should behave as if it never received this configuration\n   option and return to the relevant default state.  If there is no\n   viable way to stop using the received configuration information, the\n   values received/configured from the option MAY persist if there are\n   no other sources for that data and they have no external impact.  For\n   example, a client that previously received a Client FQDN option (see\n   [RFC4704]) and used it to set up its hostname is allowed to continue\n   using it if there is no reasonable way for a node to unset its\n   hostname and it has no external impact.  As a counter-example, a\n   client that previously received an NTP server address from the DHCP\n   server and does not receive it anymore MUST stop using the configured\n   NTP server address.  The client SHOULD be open to other sources of\n   the same configuration information.  This behavior does not apply to\n   any IA options, as their processing is described in Section 18.2.10.1\n\n",
                    "children": {}
                  }
                }
              },
              "18.2.11": {
                "title": "Receipt of Reconfigure Messages",
                "content": "   A client receives Reconfigure messages sent to UDP port 546 on\n   interfaces for which it has acquired configuration information\n   through DHCP.  These messages may be sent at any time.  Since the\n   results of a reconfiguration event may affect application-layer\n   programs, the client SHOULD log these events and MAY notify these\n   programs of the change through an implementation-specific interface.\n\n   The message MUST be dropped if it doesn't pass the validation, as\n   explained in (see Section 16.11), in particular in case the\n   authentication is missing or fails.\n\n   Upon receipt of a valid Reconfigure message, the client responds with\n   a Renew message, a Rebind message, or an Information-request message\n   as indicated by the Reconfigure Message option (see Section 21.19).\n   The client ignores the \"transaction-id\" field in the received\n   Reconfigure message.  While the transaction is in progress, the\n   client discards any Reconfigure messages it receives.\n\n   The Reconfigure message acts as a trigger that signals the client to\n   complete a successful message exchange.  Once the client has received\n   a Reconfigure, the client proceeds with the message exchange\n   (retransmitting the Renew, Rebind, or Information-request message if\n   necessary); the client MUST ignore any additional Reconfigure\n   messages until the exchange is complete. \n   Duplicate messages will be ignored because the client will begin the\n   exchange after the receipt of the first Reconfigure.  Retransmitted\n   messages will either (1) trigger the exchange (if the first\n   Reconfigure was not received by the client) or (2) be ignored.  The\n   server MAY discontinue retransmission of Reconfigure messages to the\n   client once the server receives the Renew, Rebind, or\n   Information-request message from the client.\n\n   It might be possible for a duplicate or retransmitted Reconfigure to\n   be sufficiently delayed (and delivered out of order) that it arrives\n   at the client after the exchange (initiated by the original\n   Reconfigure) has been completed.  In this case, the client would\n   initiate a redundant exchange.  The likelihood of delayed and\n   out-of-order delivery is small enough to be ignored.  The consequence\n   of the redundant exchange is inefficiency rather than incorrect\n   operation.",
                "children": {}
              },
              "18.2.12": {
                "title": "Refreshing Configuration Information",
                "content": "   Whenever a client may have moved to a new link, the\n   prefixes/addresses assigned to the interfaces on that link may no\n   longer be appropriate for the link to which the client is attached.\n   Examples of times when a client may have moved to a new link include\n   the following:\n\n   *  The client reboots (and has stable storage and persistent DHCP\n      state).\n\n   *  The client is reconnected to a link on which it has obtained\n      leases.\n\n   *  The client returns from sleep mode.\n\n   *  The client changes access points (e.g., if using Wi-Fi\n      technology).\n\n   *  The client's network interface indicates a disconnection event,\n      followed by a connection event.\n\n   Specific algorithms for detecting network attachment changes are out\n   of scope for this document.  Two possible mechanisms for detecting\n   situations where refreshing configuration information may be needed\n   are defined in [RFC6059] and [RFC4957].\n\n   When the client detects that it may have moved to a new link and it\n   has obtained addresses and no delegated prefixes from a server, the\n   client SHOULD initiate a Confirm/Reply message exchange.  The client\n   MUST include any IAs assigned to the interface that may have moved to \n   a new link, along with the addresses associated with those IAs, in\n   its Confirm message.  Any responding servers will indicate whether\n   those addresses are appropriate for the link to which the client is\n   attached with the status in the Reply message it returns to the\n   client.\n\n   If the client has any valid delegated prefixes obtained from the DHCP\n   server, the client MUST initiate a Rebind/Reply message exchange as\n   described in Section 18.2.5, with the exception that the\n   retransmission parameters should be set as for the Confirm message\n   (see Section 18.2.3).  The client includes IA_NAs and IA_PDs, along\n   with the associated leases, in its Rebind message.\n\n   If the client has only obtained network information using\n   Information-request/Reply message exchanges, the client MUST initiate\n   an Information-request/Reply message exchange as described in Section 18.2.6.\n\n   If not associated with a detection of having moved to a new link, a\n   client SHOULD initiate one of the Renew/Reply, Confirm/Reply or\n   Information-request/Reply exchanges, if the client detects a\n   significant change regarding the prefixes available on the link.  A\n   change is considered significant when one or more on-link prefixes\n   are added, and/or one or more existing on-link prefixes are\n   deprecated.  The reason for this is that such a significant change\n   may indicate a configuration change at the server.  However, a client\n   MUST rate-limit such initiation attempts to avoid flooding a server\n   with requests when there are link issues (for example, only doing one\n   of these at most every 30 seconds).\n\n   The above selection of an exchange to initiate depends on the\n   client's current state:\n\n   *  If the client has any valid delegated prefixes obtained from the\n      server, it sends Renew (as if the T1 time expired) as described in Section 18.2.4.\n\n   *  Else, if the client obtained address(es) from the server, it sends\n      Confirm as described in Section 18.2.3.\n\n   *  Else, if only network information was obtained from the server, it\n      sends Information-request as described in Section 18.2.6\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
                "children": {}
              },
              "18.2.13": {
                "title": "Restarting Server Discovery Process",
                "content": "   Whenever a client restarts the DHCP server discovery process or\n   selects an alternate server as described in Section 18.2.9, the\n   client SHOULD stop using any addresses and delegated prefixes for\n   which it has bindings (see Section 18.2.7) and if possible, any\n   previously received other configuration information, and try to\n   obtain new bindings and other configuration information from a \"new\"\n   server for the same interface.  This facilitates the client using a\n   single state machine for all bindings.",
                "children": {}
              }
            }
          },
          "18.3": {
            "title": "Server Behavior",
            "content": "   For this discussion, the server is assumed to have been configured in\n   an implementation-specific manner with configurations of interest to\n   clients.\n\n   A server sends an Advertise message in response to each valid Solicit\n   message it receives to announce the availability of the server to the\n   client.\n\n   In most cases, the server will send a Reply in response to Request,\n   Confirm, Renew, Rebind, Decline, Release, and Information-request\n   messages sent by a client.  The server will also send a Reply in\n   response to a Solicit with a Rapid Commit option (see Section 21.14)\n   when the server is configured to respond with committed lease\n   assignments.\n\n   These Advertise and Reply messages MUST always contain the Server\n   Identifier option (see Section 21.3) containing the server's DUID and\n   the Client Identifier option (see Section 21.2) from the client\n   message if one was present.\n\n   In most response messages, the server includes options containing\n   configuration information for the client.  The server must be aware\n   of the recommendations on message sizes and the use of fragmentation\n   as discussed in Section 5 of [RFC8200].  If the client included an\n   Option Request option (see Section 21.7) in its message, the server\n   includes options in the response message containing configuration\n   parameters for all of the options identified in the Option Request\n   option that the server has been configured to return to the client.\n   The server MAY return additional options to the client if it has been\n   configured to do so.\n\n   Any message sent from a client may arrive at the server encapsulated\n   in one or more Relay-forward messages.  The server MUST use the\n   received message to construct the proper Relay-reply message to allow\n   the response to the received message to be relayed through the same \n   relay agents (in reverse order) as the original client message; see Section 19.3 for more details.  The server may also need to record\n   this information with each client in case it is needed to send a\n   Reconfigure message at a later time, unless the server has been\n   configured with addresses that can be used to send Reconfigure\n   messages directly to the client (see Section 18.3.11).  Note that\n   servers that support leasequery [RFC5007] also need to record this\n   information.\n\n   By sending Reconfigure messages, the server MAY initiate a\n   configuration exchange to cause DHCP clients to obtain new addresses,\n   prefixes, and other configuration information.  For example, an\n   administrator may use a server-initiated configuration exchange when\n   links in the DHCP domain are to be renumbered or when other\n   configuration options are updated, perhaps because servers are moved,\n   added, or removed.\n\n   When a client receives a Reconfigure message from the server, the\n   client initiates sending a Renew, Rebind, or Information-request\n   message as indicated by msg-type in the Reconfigure Message option\n   (see Section 21.19).  The server sends IAs and/or other configuration\n   information to the client in a Reply message.  The server MAY include\n   options containing the IAs and new values for other configuration\n   parameters in the Reply message, even if those IAs and parameters\n   were not requested in the client's message.",
            "children": {
              "18.3.1": {
                "title": "Receipt of Solicit Messages",
                "content": "   The server determines the information about the client and its\n   location as described in Section 13 and checks its administrative\n   policy about responding to the client.  If the server is not\n   permitted to respond to the client, the server discards the Solicit\n   message.  For example, if the administrative policy for the server is\n   that it may only respond to a client that is willing to accept a\n   Reconfigure message, if the client does not include a Reconfigure\n   Accept option (see Section 21.20) in the Solicit message, the server\n   discards the Solicit message.\n\n   If (1) the server is permitted to respond to the client, (2) the\n   client has not included a Rapid Commit option (see Section 21.14) in\n   the Solicit message, or (3) the server has not been configured to\n   respond with committed assignments of leases and other resources, the\n   server sends an Advertise message to the client as described in Section 18.3.9.\n\n   If the client has included a Rapid Commit option in the Solicit\n   message and the server has been configured to respond with committed\n   assignments of leases and other resources, the server responds to the \n   Solicit with a Reply message.  The server produces the Reply message\n   as though it had received a Request message as described in Section 18.3.2.  The server transmits the Reply message as described\n   in Section 18.3.10.  The server MUST commit the assignment of any\n   addresses and delegated prefixes or other configuration information\n   before sending a Reply message to a client.  In this case, the server\n   includes a Rapid Commit option in the Reply message to indicate that\n   the Reply is in response to a Solicit message.\n\n   DISCUSSION:\n\n      When using the Solicit/Reply message exchange, the server commits\n      the assignment of any leases before sending the Reply message.\n      The client can assume that it has been assigned the leases in the\n      Reply message and does not need to send a Request message for\n      those leases.\n\n      Typically, servers that are configured to use the Solicit/Reply\n      message exchange will be deployed so that only one server will\n      respond to a Solicit message.  If more than one server responds,\n      the client will only use the leases from one of the servers, while\n      the leases from the other servers will be committed to the client\n      but not used by the client.",
                "children": {}
              },
              "18.3.2": {
                "title": "Receipt of Request Messages",
                "content": "   When the server receives a valid Request message, the server creates\n   the bindings for that client according to the server's policy and\n   configuration information and records the IAs and other information\n   requested by the client.\n\n   The server constructs a Reply message by setting the \"msg-type\" field\n   to REPLY and copying the transaction ID from the Request message into\n   the \"transaction-id\" field.\n\n   The server MUST include in the Reply message a Server Identifier\n   option (see Section 21.3) containing the server's DUID and the Client\n   Identifier option (see Section 21.2) from the Request message.\n\n   The server examines all IAs in the message from the client.\n\n   For each IA_NA option (see Section 21.4) in the Request message, the\n   server checks if the prefixes of included addresses are appropriate\n   for the link to which the client is connected.  If any of the\n   prefixes of the included addresses are not appropriate for the link\n   to which the client is connected, the server MUST return the IA to\n   the client with a Status Code option (see Section 21.13) with the\n   value NotOnLink.  If the server does not send the NotOnLink status \n   code but it cannot assign any IP addresses to an IA, the server MUST\n   return the IA option in the Reply message with no addresses in the IA\n   and a Status Code option containing status code NoAddrsAvail in the\n   IA.\n\n   For any IA_PD option (see Section 21.21) in the Request message to\n   which the server cannot assign any delegated prefixes, the server\n   MUST return the IA_PD option in the Reply message with no prefixes in\n   the IA_PD and with a Status Code option containing status code\n   NoPrefixAvail in the IA_PD.\n\n   The server MAY assign different addresses and/or delegated prefixes\n   to an IA than those included within the IA of the client's Request\n   message.\n\n   For all IAs to which the server can assign addresses or delegated\n   prefixes, the server includes the IAs with addresses (for IA_NAs),\n   prefixes (for IA_PDs), and other configuration parameters and records\n   the IA as a new client binding.  The server MUST NOT include any\n   addresses or delegated prefixes in the IA that the server does not\n   assign to the client.\n\n   The T1/T2 times set in each applicable IA option for a Reply MUST be\n   the same values across all IAs.  The server MUST determine the T1/T2\n   times across all of the applicable client's bindings in the Reply.\n   This facilitates the client being able to renew all of the bindings\n   at the same time.\n\n   The server SHOULD include a Reconfigure Accept option (see Section 21.20) if the server policy enables the reconfigure mechanism\n   and the client supports it.  Currently, sending this option in a\n   Reply is technically redundant, as the use of the reconfiguration\n   mechanism requires authentication; at present, the only defined\n   mechanism is RKAP (see Section 20.4), and the presence of the\n   reconfigure key signals support for the acceptance of Reconfigure\n   messages.  However, there may be better security mechanisms defined\n   in the future that would cause RKAP to not be used anymore.\n\n   The server includes other options containing configuration\n   information to be returned to the client as described in Section 18.3.\n\n   If the server finds that the client has included an IA in the Request\n   message for which the server already has a binding that associates\n   the IA with the client, the server sends a Reply message with\n   existing bindings, possibly with updated lifetimes.  The server may\n   update the bindings according to its local policies, but the server\n   SHOULD generate the response again and not simply retransmit \n   previously sent information, even if the \"transaction-id\" field value\n   matches a previous transmission.  The server MUST NOT cache its\n   responses.\n\n   DISCUSSION:\n\n      Cached replies are bad because lifetimes need to be updated\n      (either decrease the timers by the amount of time elapsed since\n      the original transmission or keep the lifetime values and update\n      the lease information in the server's database).  Also, if the\n      message uses any security protection (such as the Replay Detection\n      Method (RDM), as described in Section 20.3), its value must be\n      updated.  Additionally, any digests must be updated.  Given all of\n      the above, caching replies is far more complex than simply sending\n      the same buffer as before, and it is easy to miss some of those\n      steps.",
                "children": {}
              },
              "18.3.3": {
                "title": "Receipt of Confirm Messages",
                "content": "   When the server receives a Confirm message, the server determines\n   whether the addresses in the Confirm message are appropriate for the\n   link to which the client is attached.  If all of the addresses in the\n   Confirm message pass this test, the server returns a status of\n   Success.  If any of the addresses do not pass this test, the server\n   returns a status of NotOnLink.  If the server is unable to perform\n   this test (for example, the server does not have information about\n   prefixes on the link to which the client is connected) or there were\n   no addresses in any of the IAs sent by the client, the server\n   MUST NOT send a Reply to the client.\n\n   The server ignores the T1 and T2 fields in the IA options and the\n   preferred-lifetime and valid-lifetime fields in the IA Address\n   options (see Section 21.6).\n\n   The server constructs a Reply message by setting the \"msg-type\" field\n   to REPLY and copying the transaction ID from the Confirm message into\n   the \"transaction-id\" field.\n\n   The server MUST include in the Reply message a Server Identifier\n   option (see Section 21.3) containing the server's DUID and the Client\n   Identifier option (see Section 21.2) from the Confirm message.  The\n   server includes a Status Code option (see Section 21.13) indicating\n   the status of the Confirm message. \n\n\n\n",
                "children": {}
              },
              "18.3.4": {
                "title": "Receipt of Renew Messages",
                "content": "   For each IA in the Renew message from a client, the server locates\n   the client's binding and verifies that the information in the IA from\n   the client matches the information stored for that client.\n\n   If the server finds the client entry for the IA, the server sends the\n   IA back to the client with new lifetimes and, if applicable, T1/T2\n   times.  If the server is unable to extend the lifetimes of an address\n   or delegated prefix in the IA, the server MAY choose not to include\n   the IA Address option (see Section 21.6) for that address or IA\n   Prefix option (see Section 21.22) for that delegated prefix.  If the\n   server chooses to include the IA Address or IA Prefix option for such\n   an address or delegated prefix, the server SHOULD set T1 and T2\n   values to the valid lifetime for the IA option unless the server also\n   includes other addresses or delegated prefixes that the server is\n   able to extend for the IA.  Setting T1 and T2 to values equal to the\n   valid lifetime informs the client that the leases associated with\n   said IA will not be extended, so there is no point in trying.  Also,\n   it avoids generating unnecessary traffic as the remaining lifetime\n   approaches 0.\n\n   The server may choose to change the list of addresses or delegated\n   prefixes and the lifetimes in IAs that are returned to the client.\n\n   If the server finds that any of the addresses in the IA are not\n   appropriate for the link to which the client is attached, the server\n   returns the address to the client with lifetimes of 0.\n\n   If the server finds that any of the delegated prefixes in the IA are\n   not appropriate for the link to which the client is attached, the\n   server returns the delegated prefix to the client with lifetimes\n   of 0.\n\n   For each IA for which the server cannot find a client entry, the\n   server has the following choices, depending on the server's policy\n   and configuration information:\n\n   *  If the server is configured to create new bindings as a result of\n      processing Renew messages, the server SHOULD create a binding and\n      return the IA with assigned addresses or delegated prefixes with\n      lifetimes and, if applicable, T1/T2 times and other information\n      requested by the client.  If the client included the IA Prefix\n      option within the IA_PD option (see Section 21.21) with a zero\n      value in the \"IPv6-prefix\" field and a non-zero value in the\n      \"prefix-length\" field, the server MAY use the \"prefix-length\"\n      value as a hint for the length of the prefixes to be assigned (see\n      [RFC8168] for further details on prefix-length hints). \n   *  If the server is configured to create new bindings as a result of\n      processing Renew messages but the server will not assign any\n      leases to an IA, the server returns the IA option containing a\n      Status Code option (see Section 21.13) with the NoAddrsAvail or\n      NoPrefixAvail status code and a status message for a user.\n\n   *  If the server does not support creation of new bindings for the\n      client sending a Renew message or if this behavior is disabled\n      according to the server's policy or configuration information, the\n      server returns the IA option containing a Status Code option with\n      the NoBinding status code and a status message for a user.\n\n   The server constructs a Reply message by setting the \"msg-type\" field\n   to REPLY and copying the transaction ID from the Renew message into\n   the \"transaction-id\" field.\n\n   The server MUST include in the Reply message a Server Identifier\n   option (see Section 21.3) containing the server's DUID and the Client\n   Identifier option (see Section 21.2) from the Renew message.\n\n   The server includes other options containing configuration\n   information to be returned to the client as described in Section 18.3.\n\n   The server MAY include options containing the IAs and values for\n   other configuration parameters, even if those parameters were not\n   requested in the Renew message.\n\n   The T1/T2 values set in each applicable IA option for a Reply MUST be\n   the same across all IAs.  The server MUST determine the T1/T2 values\n   across all of the applicable client's bindings in the Reply.  This\n   facilitates the client being able to renew all of the bindings at the\n   same time.",
                "children": {}
              },
              "18.3.5": {
                "title": "Receipt of Rebind Messages",
                "content": "   When the server receives a Rebind message that contains an IA option\n   from a client, it locates the client's binding and verifies that the\n   information in the IA from the client matches the information stored\n   for that client.\n\n   If the server finds the client entry for the IA and the server\n   determines that the addresses or delegated prefixes in the IA are\n   appropriate for the link to which the client's interface is attached\n   according to the server's explicit configuration information, the\n   server SHOULD send the IA back to the client with new lifetimes and,\n   if applicable, T1/T2 values.  If the server is unable to extend the\n   lifetimes of an address in the IA, the server MAY choose not to \n   include the IA Address option (see Section 21.6) for this address.\n   If the server is unable to extend the lifetimes of a delegated prefix\n   in the IA, the server MAY choose not to include the IA Prefix option\n   (see Section 21.22) for this prefix.\n\n   If the server finds that the client entry for the IA and any of the\n   addresses or delegated prefixes are no longer appropriate for the\n   link to which the client's interface is attached according to the\n   server's explicit configuration information, the server returns those\n   addresses or delegated prefixes to the client with lifetimes of 0.\n\n   If the server cannot find a client entry for the IA, the server\n   checks if the IA contains addresses (for IA_NAs) or delegated\n   prefixes (for IA_PDs).  The server checks if the addresses and\n   delegated prefixes are appropriate for the link to which the client's\n   interface is attached according to the server's explicit\n   configuration information.  For any address that is not appropriate\n   for the link to which the client's interface is attached, the server\n   MAY include the IA Address option with lifetimes of 0.  For any\n   delegated prefix that is not appropriate for the link to which the\n   client's interface is attached, the server MAY include the IA Prefix\n   option with lifetimes of 0.  The Reply with lifetimes of 0\n   constitutes an explicit notification to the client that the specific\n   addresses and delegated prefixes are no longer valid and MUST NOT be\n   used by the client.  If the server chooses to not include any IAs\n   containing IA Address or IA Prefix options with lifetimes of 0 and\n   the server does not include any other IAs with leases and/or status\n   codes, the server does not send a Reply message.  In this situation,\n   the server discards the Rebind message.\n\n   Otherwise, for each IA for which the server cannot find a client\n   entry, the server has the following choices, depending on the\n   server's policy and configuration information:\n\n   *  If the server is configured to create new bindings as a result of\n      processing Rebind messages (also see the note below about the\n      Rapid Commit option (Section 21.14)), the server SHOULD create a\n      binding and return the IA with allocated leases with lifetimes\n      and, if applicable, T1/T2 values and other information requested\n      by the client.  The server MUST NOT return any addresses or\n      delegated prefixes in the IA that the server does not assign to\n      the client.\n\n   *  If the server is configured to create new bindings as a result of\n      processing Rebind messages but the server will not assign any\n      leases to an IA, the server returns the IA option containing a\n      Status Code option (see Section 21.13) with the NoAddrsAvail or\n      NoPrefixAvail status code and a status message for a user. \n   *  If the server does not support creation of new bindings for the\n      client sending a Rebind message or if this behavior is disabled\n      according to the server's policy or configuration information, the\n      server returns the IA option containing a Status Code option with\n      the NoBinding status code and a status message for a user.\n\n   When the server creates new bindings for the IA, it is possible that\n   other servers also create bindings as a result of receiving the same\n   Rebind message; see the \"DISCUSSION\" text in Section 21.14.\n   Therefore, the server SHOULD only create new bindings during\n   processing of a Rebind message if the server is configured to respond\n   with a Reply message to a Solicit message containing the Rapid Commit\n   option.\n\n   The server constructs a Reply message by setting the \"msg-type\" field\n   to REPLY and copying the transaction ID from the Rebind message into\n   the \"transaction-id\" field.\n\n   The server MUST include in the Reply message a Server Identifier\n   option (see Section 21.3) containing the server's DUID and the Client\n   Identifier option (see Section 21.2) from the Rebind message.\n\n   The server includes other options containing configuration\n   information to be returned to the client as described in Section 18.3.\n\n   The server MAY include options containing the IAs and values for\n   other configuration parameters, even if those IAs and parameters were\n   not requested in the Rebind message.\n\n   The T1 or T2 values set in each applicable IA option for a Reply MUST\n   be the same values across all IAs.  The server MUST determine the T1\n   or T2 values across all of the applicable client's bindings in the\n   Reply.  This facilitates the client being able to renew all of the\n   bindings at the same time.",
                "children": {}
              },
              "18.3.6": {
                "title": "Receipt of Information-request Messages",
                "content": "   When the server receives an Information-request message, the client\n   is requesting configuration information that does not include the\n   assignment of any leases.  The server determines all configuration\n   parameters appropriate to the client, based on the server\n   configuration policies known to the server.\n\n   The server constructs a Reply message by setting the \"msg-type\" field\n   to REPLY and copying the transaction ID from the Information-request\n   message into the \"transaction-id\" field. \n   The server MUST include a Server Identifier option (see Section 21.3)\n   containing the server's DUID in the Reply message.  If the client\n   included a Client Identifier option (see Section 21.2) in the\n   Information-request message, the server copies that option to the\n   Reply message.\n\n   The server includes options containing configuration information to\n   be returned to the client as described in Section 18.3.  The server\n   MAY include additional options that were not requested by the client\n   in the Information-request message.\n\n   If the Information-request message received from the client did not\n   include a Client Identifier option, the server SHOULD respond with a\n   Reply message containing any configuration parameters that are not\n   determined by the client's identity.  If the server chooses not to\n   respond, the client may continue to retransmit the\n   Information-request message indefinitely.",
                "children": {}
              },
              "18.3.7": {
                "title": "Receipt of Release Messages",
                "content": "   The server constructs a Reply message by setting the \"msg-type\" field\n   to REPLY and copying the transaction ID from the Release message into\n   the \"transaction-id\" field.\n\n   Upon the receipt of a valid Release message, the server examines the\n   IAs and the leases in the IAs for validity.  If the IAs in the\n   message are in a binding for the client and the leases in the IAs\n   have been assigned by the server to those IAs, the server deletes the\n   leases from the IAs and makes the leases available for assignment to\n   other clients.  The server ignores leases not assigned to the IAs,\n   although it may choose to log an error.\n\n   After all the leases have been processed, the server generates a\n   Reply message and includes a Status Code option (see Section 21.13)\n   with the value Success, a Server Identifier option (see Section 21.3)\n   with the server's DUID, and a Client Identifier option (see Section 21.2) with the client's DUID.  For each IA in the Release\n   message for which the server has no binding information, the server\n   adds an IA option using the IAID from the Release message and\n   includes a Status Code option with the value NoBinding in the IA\n   option.  No other options are included in the IA option.\n\n   A server may choose to retain a record of assigned leases and IAs\n   after the lifetimes on the leases have expired to allow the server to\n   reassign the previously assigned leases to a client. \n\n\n\n",
                "children": {}
              },
              "18.3.8": {
                "title": "Receipt of Decline Messages",
                "content": "   Upon the receipt of a valid Decline message, the server examines the\n   IAs and the addresses in the IAs for validity.  If the IAs in the\n   message are in a binding for the client and the addresses in the IAs\n   have been assigned by the server to those IAs, the server deletes the\n   addresses from the IAs.  The server ignores addresses not assigned to\n   the IAs (though it may choose to log an error if it finds such\n   addresses).\n\n   The client has found any addresses in the Decline messages to be\n   already in use on its link.  Therefore, the server SHOULD mark the\n   addresses declined by the client so that those addresses are not\n   assigned to other clients and MAY choose to make a notification that\n   addresses were declined.  Local policy on the server determines when\n   the addresses identified in a Decline message may be made available\n   for assignment.\n\n   After all the addresses have been processed, the server generates a\n   Reply message by setting the \"msg-type\" field to REPLY and copying\n   the transaction ID from the Decline message into the \"transaction-id\"\n   field.  The server includes a Status Code option (see Section 21.13)\n   with the value Success, a Server Identifier option (see Section 21.3)\n   with the server's DUID, and a Client Identifier option (see Section 21.2) with the client's DUID.  For each IA in the Decline\n   message for which the server has no binding information, the server\n   adds an IA option using the IAID from the Decline message and\n   includes a Status Code option with the value NoBinding in the IA\n   option.  No other options are included in the IA option.",
                "children": {}
              },
              "18.3.9": {
                "title": "Creation of Advertise Messages",
                "content": "   The server sets the \"msg-type\" field to ADVERTISE and copies the\n   contents of the \"transaction-id\" field from the Solicit message\n   received from the client to the Advertise message.  The server\n   includes its server identifier in a Server Identifier option (see Section 21.3) and copies the Client Identifier option (see Section 21.2) from the Solicit message into the Advertise message.\n\n   The server MAY add a Preference option (see Section 21.8) to carry\n   the preference value for the Advertise message.  The server\n   implementation SHOULD allow the setting of a server preference value\n   by the administrator.  The server preference value MUST default to 0\n   unless otherwise configured by the server administrator. \n   The server includes a Reconfigure Accept option (see Section 21.20)\n   if the server wants to indicate that it supports the Reconfigure\n   mechanism.  This information may be used by the client during the\n   server selection process.\n\n   The server includes the options the server will return to the client\n   in a subsequent Reply message.  The information in these options may\n   be used by the client in the selection of a server if the client\n   receives more than one Advertise message.  The server MUST include\n   options in the Advertise message containing configuration parameters\n   for all of the options identified in the Option Request option (see Section 21.7) in the Solicit message that the server has been\n   configured to return to the client.  If the Option Request option\n   includes a container option, the server MUST include all the options\n   that are eligible to be encapsulated in the container.  The Option\n   Request option MAY be used to signal support for a feature even when\n   that option is encapsulated, as in the case of the Prefix Exclude\n   option [RFC6603].  In this case, special processing is required by\n   the server.  The server MAY return additional options to the client\n   if it has been configured to do so.\n\n   The server MUST include IA options in the Advertise message\n   containing any addresses and/or delegated prefixes that would be\n   assigned to IAs contained in the Solicit message from the client.  If\n   the client has included addresses in the IA Address options (see Section 21.6) in the Solicit message, the server MAY use those\n   addresses as hints about the addresses that the client would like to\n   receive.  If the client has included IA Prefix options (see Section 21.22), the server MAY use the prefix contained in the\n   \"IPv6-prefix\" field and/or the prefix length contained in the\n   \"prefix-length\" field as hints about the prefixes the client would\n   like to receive.  If the server is not going to assign an address or\n   delegated prefix received as a hint in the Solicit message, the\n   server MUST NOT include this address or delegated prefix in the\n   Advertise message.\n\n   If the server will not assign any addresses to an IA_NA in subsequent\n   Request messages from the client, the server MUST include the IA\n   option in the Advertise message with no addresses in that IA and a\n   Status Code option (see Section 21.13) encapsulated in the IA option\n   containing status code NoAddrsAvail.\n\n   If the server will not assign any prefixes to an IA_PD in subsequent\n   Request messages from the client, the server MUST include the IA_PD\n   option (see Section 21.21) in the Advertise message with no prefixes\n   in the IA_PD option and a Status Code option encapsulated in the\n   IA_PD containing status code NoPrefixAvail. \n   Transmission of Advertise messages is described in the next section.",
                "children": {}
              },
              "18.3.10": {
                "title": "Transmission of Advertise and Reply Messages",
                "content": "   If the original message was received directly by the server, the\n   server unicasts the Advertise or Reply message directly to the client\n   using the address in the source address field from the IP datagram in\n   which the original message was received.  The Advertise or Reply\n   message MUST be unicast through the interface on which the original\n   message was received.\n\n   If the original message was received in a Relay-forward message, the\n   server constructs a Relay-reply message with the Reply message in the\n   payload of a Relay Message option (see Section 21.10).  If the\n   Relay-forward messages included an Interface-Id option (see Section 21.18), the server copies that option to the Relay-reply\n   message.  The server unicasts the Relay-reply message directly to the\n   relay agent using the address in the source address field from the IP\n   datagram in which the Relay-forward message was received.  See Section 19.3 for more details on the construction of Relay-reply\n   messages.",
                "children": {}
              },
              "18.3.11": {
                "title": "Creation and Transmission of Reconfigure Messages",
                "content": "   The server sets the \"msg-type\" field to RECONFIGURE and sets the\n   \"transaction-id\" field to 0.  The server includes a Server Identifier\n   option (see Section 21.3) containing its DUID and a Client Identifier\n   option (see Section 21.2) containing the client's DUID in the\n   Reconfigure message.\n\n   Because of the risk of denial-of-service (DoS) attacks against DHCP\n   clients, the use of a security mechanism is mandated in Reconfigure\n   messages.  The server MUST use DHCP authentication in the Reconfigure\n   message (see Section 20.4).\n\n   The server MUST include a Reconfigure Message option (see Section 21.19) to select whether the client responds with a Renew\n   message, a Rebind message, or an Information-request message.\n\n   The server MUST NOT include any other options in the Reconfigure\n   message, except as specifically allowed in the definition of\n   individual options.\n\n   A server sends each Reconfigure message to a single DHCP client,\n   using an IPv6 unicast address of sufficient scope belonging to the\n   DHCP client.  If the server does not have an address to which it can\n   send the Reconfigure message directly to the client, the server uses\n   a Relay-reply message (as described in Section 19.3) to send the \n   Reconfigure message to a relay agent that will relay the message to\n   the client.  The server may obtain the address of the client (and the\n   appropriate relay agent, if required) through the information the\n   server has about clients that have been in contact with the server\n   (see Section 18.3) or through some external agent.\n\n   To reconfigure more than one client, the server unicasts a separate\n   message to each client.  The server may initiate the reconfiguration\n   of multiple clients concurrently; for example, a server may send a\n   Reconfigure message to additional clients while previous\n   reconfiguration message exchanges are still in progress.\n\n   The Reconfigure message causes the client to initiate a Renew/Reply,\n   Rebind/Reply, or Information-request/Reply message exchange with the\n   server.  The server interprets the receipt of a Renew, Rebind, or\n   Information-request message (whichever was specified in the original\n   Reconfigure message) from the client as satisfying the Reconfigure\n   message request.\n\n   When transmitting the Reconfigure message, the server sets the\n   retransmission time (RT) to REC_TIMEOUT.  If the server does not\n   receive a Renew, Rebind, or Information-request message from the\n   client before the RT elapses, the server retransmits the Reconfigure\n   message, doubles the RT value, and waits again.  The server continues\n   this process until REC_MAX_RC unsuccessful attempts have been made,\n   at which point the server SHOULD abort the reconfigure process for\n   that client.\n\n   Default and initial values for REC_TIMEOUT and REC_MAX_RC are\n   documented in Section 7.6.",
                "children": {}
              }
            }
          }
        }
      },
      "19": {
        "title": "Relay Agent Behavior",
        "content": "   The relay agent SHOULD be configured to use a list of destination\n   addresses that includes unicast addresses.  The list of destination\n   addresses MAY include the All_DHCP_Servers multicast address or other\n   addresses selected by the network administrator.  If the relay agent\n   has not been explicitly configured, it MUST use the All_DHCP_Servers\n   multicast address as the default.\n\n   If the relay agent relays messages to the All_DHCP_Servers multicast\n   address or other multicast addresses, it sets the Hop Limit field\n   to 8.\n\n   If the relay agent receives a message other than Relay-forward and\n   Relay-reply and the relay agent does not recognize its message type,\n   it MUST forward the message as described in Section 19.1.1. \n\n\n\n",
        "children": {
          "19.1": {
            "title": "Relaying a Client Message or a Relay-forward Message",
            "content": "   A relay agent relays both messages from clients and Relay-forward\n   messages from other relay agents.  When a relay agent receives a\n   Relay-forward message, a recognized message type for which it is not\n   the intended target, or an unrecognized message type, it constructs a\n   new Relay-forward message.  The relay agent copies the source address\n   from the header of the IP datagram in which the message was received\n   into the peer-address field of the Relay-forward message.  The relay\n   agent copies the received DHCP message (excluding any IP or UDP\n   headers) into a Relay Message option (see Section 21.10) in the new\n   message.  The relay agent adds to the Relay-forward message any other\n   options it is configured to include.\n\n   [RFC6221] defines a Lightweight DHCPv6 Relay Agent (LDRA) that allows\n   relay agent information to be inserted by an access node that\n   performs a link-layer bridging (i.e., non-routing) function.",
            "children": {
              "19.1.1": {
                "title": "Relaying a Message from a Client",
                "content": "   If the relay agent received the message to be relayed from a client,\n   the relay agent places a globally scoped unicast address (i.e., GUA\n   or ULA) from a prefix assigned to the link on which the client should\n   be assigned leases into the link-address field.  If such an address\n   is not available, the relay agent may set the link-address field to a\n   link-local address from the interface on which the original message\n   was received.  This is not recommended, as it may require that\n   additional information be provided in the server configuration.  See Section 3.2 of [RFC7969] for a detailed discussion.\n\n   This address will be used by the server to determine the link from\n   which the client should be assigned leases and other configuration\n   information.\n\n   The hop-count value in the Relay-forward message is set to 0.\n\n   The relay SHOULD insert a Client Link-Layer Address option as\n   described in [RFC6939].\n\n   If the relay agent cannot use the address in the link-address field\n   to identify the interface through which the response to the client\n   will be relayed, the relay agent MUST include an Interface-Id option\n   (see Section 21.18) in the Relay-forward message.  The server will\n   include the Interface-Id option in its Relay-reply message.  The\n   relay agent sets the link-address field as described earlier in this\n   subsection, regardless of whether the relay agent includes an\n   Interface-Id option in the Relay-forward message. \n\n\n\n",
                "children": {}
              },
              "19.1.2": {
                "title": "Relaying a Message from a Relay Agent",
                "content": "   If the message received by the relay agent is a Relay-forward message\n   and the hop-count value in the message is greater than or equal to\n   HOP_COUNT_LIMIT, the relay agent discards the received message.\n\n   The relay agent copies the source address from the IP datagram in\n   which the message was received into the peer-address field in the\n   Relay-forward message and sets the hop-count field to the value of\n   the hop-count field in the received message incremented by 1.\n\n   If the source address from the IP datagram header of the received\n   message is a globally scoped unicast address (i.e., GUA or ULA), the\n   relay agent sets the link-address field to 0; otherwise, the relay\n   agent sets the link-address field to a globally scoped unicast\n   address (i.e., GUA or ULA) assigned to the interface on which the\n   message was received or includes an Interface-Id option (see Section 21.18) to identify the interface on which the message was\n   received.",
                "children": {}
              },
              "19.1.3": {
                "title": "Relay Agent Behavior with Prefix Delegation",
                "content": "   A relay agent forwards messages containing prefix delegation options\n   in the same way as it would relay addresses (i.e., per\n   Sections 19.1.1 and 19.1.2).\n\n   If a server communicates with a client through a relay agent about\n   delegated prefixes, the server may need a protocol or other\n   out-of-band communication to configure routing information for\n   delegated prefixes on any router through which the client may forward\n   traffic.",
                "children": {}
              }
            }
          },
          "19.2": {
            "title": "Relaying a Relay-reply Message",
            "content": "   The relay agent processes any options included in the Relay-reply\n   message in addition to the Relay Message option (see Section 21.10).\n\n   The relay agent extracts the message from the Relay Message option\n   and relays it to the address contained in the peer-address field of\n   the Relay-reply message.  Relay agents MUST NOT modify the message.\n\n   If the Relay-reply message includes an Interface-Id option (see Section 21.18), the relay agent relays the message from the server to\n   the client on the link identified by the Interface-Id option.\n   Otherwise, if the link-address field is not set to 0, the relay agent\n   relays the message on the link identified by the link-address field. \n   If the relay agent receives a Relay-reply message, it MUST process\n   the message as defined above, regardless of the type of message\n   encapsulated in the Relay Message option.",
            "children": {}
          },
          "19.3": {
            "title": "Construction of Relay-reply Messages",
            "content": "   A server uses a Relay-reply message to (1) return a response to a\n   client if the original message from the client was relayed to the\n   server in a Relay-forward message or (2) send a Reconfigure message\n   to a client if the server does not have an address it can use to send\n   the message directly to the client.\n\n   A response to the client MUST be relayed through the same relay\n   agents as the original client message.  The server causes this to\n   happen by creating a Relay-reply message that includes a Relay\n   Message option (see Section 21.10) containing the message for the\n   next relay agent in the return path to the client.  The contained\n   Relay-reply message contains another Relay Message option to be sent\n   to the next relay agent, and so on.  The server must record the\n   contents of the peer-address fields in the received message so it can\n   construct the appropriate Relay-reply message carrying the response\n   from the server.\n\n   For example, if client C sent a message that was relayed by relay\n   agent A to relay agent B and then to the server, the server would\n   send the following Relay-reply message to relay agent B:\n\n      msg-type:       RELAY-REPL\n      hop-count:      1\n      link-address:   0\n      peer-address:   A\n      Relay Message option containing the following:\n         msg-type:     RELAY-REPL\n         hop-count:    0\n         link-address: address from link to which C is attached\n         peer-address: C\n         Relay Message option: <response from server>\n\n                       Figure 10: Relay-reply Example \n   When sending a Reconfigure message to a client through a relay agent,\n   the server creates a Relay-reply message that includes a Relay\n   Message option containing the Reconfigure message for the next relay\n   agent in the return path to the client.  The server sets the\n   peer-address field in the Relay-reply message header to the address\n   of the client and sets the link-address field as required by the\n   relay agent to relay the Reconfigure message to the client.  The\n   server obtains the addresses of the client and the relay agent\n   through prior interaction with the client or through some external\n   mechanism.",
            "children": {}
          },
          "19.4": {
            "title": "Interaction between Relay Agents and Servers",
            "content": "   Each time a message is relayed by a relay agent towards a server, a\n   new encapsulation level is added around the message.  Each relay is\n   allowed to insert additional options on the encapsulation level it\n   added but MUST NOT change anything in the message being encapsulated.\n   If there are multiple relays between a client and a server, multiple\n   encapsulations are used.  Although it makes message processing\n   slightly more complex, it provides the major advantage of having a\n   clear indication as to which relay inserted which option.  The\n   response message is expected to travel through the same relays, but\n   in reverse order.  Each time a response message is relayed back\n   towards a client, one encapsulation level is removed.\n\n   In certain cases, relays can add one or more options.  These options\n   can be added for several reasons:\n\n   *  First, relays can provide additional information about the client.\n      That source of information is usually more trusted by a server\n      administrator, as it comes from the network infrastructure rather\n      than the client and cannot be easily spoofed.  These options can\n      be used by the server to determine its allocation policy.\n\n   *  Second, a relay may need some information to send a response back\n      to the client.  Relay agents are expected to be stateless (not\n      retain any state after a message has been processed).  A relay\n      agent may include the Interface-Id option (see Section 21.18),\n      which will be echoed back in the response.  It can include other\n      options and ask the server to echo one or more of the options back\n      in the response.  These options can then be used by the relay\n      agent to send the response back to the client, or for other needs.\n      The client will never see these options.  See [RFC4994] for\n      details.\n\n   *  Third, sometimes a relay is the best device to provide values for\n      certain options.  A relay can insert an option into the message\n      being forwarded to the server and ask the server to pass that \n      option back to the client.  The client will receive that option.\n      It should be noted that the server is the ultimate authority here,\n      and -- depending on its configuration -- it may or may not send\n      the option back to the client.  See [RFC6422] for details.\n\n   For various reasons, servers may need to retain the relay information\n   after the message processing is completed.  One is a bulk leasequery\n   mechanism that may ask for all addresses and/or prefixes that were\n   assigned via a specific relay.  A second is for the reconfigure\n   mechanism.  The server may choose to not send the Reconfigure message\n   directly to the client but rather to send it via relays.  This\n   particular behavior is considered an implementation detail and is out\n   of scope for this document.",
            "children": {}
          }
        }
      },
      "20": {
        "title": "Authentication of DHCP Messages",
        "content": "   This document introduces two security mechanisms for the\n   authentication of DHCP messages: (1) authentication (and encryption)\n   of messages sent between servers and relay agents using IPsec and\n   (2) protection against misconfiguration of a client caused by a\n   Reconfigure message sent by a malicious DHCP server.",
        "children": {
          "20.1": {
            "title": "Security of Messages Sent between Servers and Relay Agents",
            "content": "   Relay agents and servers that exchange messages can use IPsec as\n   detailed in [RFC8213].",
            "children": {}
          },
          "20.2": {
            "title": "Summary of DHCP Authentication",
            "content": "   Authentication of DHCP messages is accomplished through the use of\n   the Authentication option (see Section 21.11).  The authentication\n   information carried in the Authentication option can be used to\n   reliably identify the source of a DHCP message and to confirm that\n   the contents of the DHCP message have not been tampered with.\n\n   The Authentication option provides a framework for multiple\n   authentication protocols.  One such protocol, RKAP, is defined in Section 20.4.  Other protocols defined in the future will be\n   specified in separate documents.\n\n   Any DHCP message MUST NOT include more than one Authentication\n   option.\n\n   The protocol field in the Authentication option identifies the\n   specific protocol used to generate the authentication information\n   carried in the option.  The algorithm field identifies a specific\n   algorithm within the authentication protocol; for example, the\n   algorithm field specifies the hash algorithm used to generate the \n   Message Authentication Code (MAC) in the Authentication option.  The\n   RDM field specifies the type of replay detection used in the replay\n   detection field.",
            "children": {}
          },
          "20.3": {
            "title": "Replay Detection",
            "content": "   The RDM field of the Authentication option (see Section 21.11)\n   determines the type of replay detection used in the replay detection\n   field.\n\n   If the RDM field contains 0x00, the replay detection field MUST be\n   set to the value of a strictly monotonically increasing 64-bit\n   unsigned integer (modulo 2^64).  Using this technique can reduce the\n   danger of replay attacks.  This method MUST be supported by all\n   Authentication option protocols.  One choice might be to use the\n   64-bit NTP timestamp format [RFC5905]).\n\n   A client that receives a message with the RDM field set to 0x00 MUST\n   compare its replay detection field with the previous value sent by\n   that same server (based on the Server Identifier option; see Section 21.3) and only accept the message if the received value is\n   greater and record this as the new value.  If this is the first time\n   a client processes an Authentication option sent by a server, the\n   client MUST record the replay detection value and skip the replay\n   detection check.\n\n   Servers that support the reconfigure mechanism MUST ensure that the\n   replay detection value is retained between restarts.  Failing to do\n   so may cause clients to refuse Reconfigure messages sent by the\n   server, effectively rendering the reconfigure mechanism useless.",
            "children": {}
          },
          "20.4": {
            "title": "Reconfiguration Key Authentication Protocol (RKAP)",
            "content": "   RKAP provides protection against misconfiguration of a client caused\n   by a Reconfigure message sent by a malicious DHCP server.  In this\n   protocol, a DHCP server sends a reconfigure key to the client in the\n   initial exchange of DHCP messages.  The client records the\n   reconfigure key for use in authenticating subsequent Reconfigure\n   messages from that server.  The server then includes a Hashed Message\n   Authentication Code (HMAC) computed from the reconfigure key in\n   subsequent Reconfigure messages.\n\n   Both the reconfigure key sent from the server to the client and the\n   HMAC in subsequent Reconfigure messages are carried as the\n   authentication information in an Authentication option (see Section 21.11).  The format of the authentication information is\n   defined in the following section. \n   RKAP is used (initiated by the server) only if the client and server\n   have negotiated to use Reconfigure messages.",
            "children": {
              "20.4.1": {
                "title": "Use of the Authentication Option in RKAP",
                "content": "   The following fields are set in an Authentication option (see Section 21.11) for RKAP:\n\n   protocol      3\n\n   algorithm     1\n\n   RDM           0\n\n   The format of the authentication information for RKAP is:\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |     Type      |                 Value (128 bits)              |\n      +-+-+-+-+-+-+-+-+                                               |\n      .                                                               .\n      .                                                               .\n      .                                               +-+-+-+-+-+-+-+-+\n      |                                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                 Figure 11: RKAP Authentication Information\n\n   Type                Type of data in the Value field carried in this\n                       option:\n\n                       1       Reconfigure key value (used in the Reply\n                               message).\n\n                       2       HMAC-MD5 digest of the message (used in\n                               the Reconfigure message).\n\n                       A 1-octet field.\n\n   Value               Data as defined by the Type field.  A 16-octet\n                       field. \n\n\n\n",
                "children": {}
              },
              "20.4.2": {
                "title": "Server Considerations for RKAP",
                "content": "   The server selects a reconfigure key for a client during the\n   Request/Reply, Solicit/Reply, or Information-request/Reply message\n   exchange.  The server records the reconfigure key and transmits that\n   key to the client in an Authentication option (see Section 21.11) in\n   the Reply message.\n\n   The reconfigure key is 128 bits long and MUST be a cryptographically\n   strong random or pseudorandom number that cannot easily be predicted.\n\n   To provide authentication for a Reconfigure message, the server\n   selects a replay detection value according to the RDM selected by the\n   server and computes an HMAC-MD5 of the Reconfigure message using the\n   reconfigure key for the client.  The server computes the HMAC-MD5\n   over the entire DHCP Reconfigure message, including the\n   Authentication option; the HMAC-MD5 field in the Authentication\n   option is set to 0 for the HMAC-MD5 computation.  The server includes\n   the HMAC-MD5 in the authentication information field in an\n   Authentication option included in the Reconfigure message sent to the\n   client.",
                "children": {}
              },
              "20.4.3": {
                "title": "Client Considerations for RKAP",
                "content": "   The client will receive a reconfigure key from the server in an\n   Authentication option (see Section 21.11) in the initial Reply\n   message from the server.  The client records the reconfigure key for\n   use in authenticating subsequent Reconfigure messages.\n\n   To authenticate a Reconfigure message, the client computes an\n   HMAC-MD5 over the Reconfigure message, with zeroes substituted for\n   the HMAC-MD5 field, using the reconfigure key received from the\n   server.  If this computed HMAC-MD5 matches the value in the\n   Authentication option, the client accepts the Reconfigure message.",
                "children": {}
              }
            }
          }
        }
      },
      "21": {
        "title": "DHCP Options",
        "content": "   Options are used to carry additional information and parameters in\n   DHCP messages.  Every option shares a common base format, as\n   described in Section 21.1.  All values in options are represented in\n   network byte order.\n\n   This document specifies the DHCP options defined as part of this base\n   DHCP specification.  Other options have been or may be defined in the\n   future in separate documents.  See [RFC7227] for guidelines regarding\n   the definition of new options.  See Section 25 for additional\n   information about the DHCPv6 \"Option Codes\" registry maintained by\n   IANA. \n   Unless otherwise noted, each option may appear only in the options\n   area of a DHCP message and may appear only once.  If an option does\n   appear multiple times, each instance is considered separate and the\n   data areas of the options MUST NOT be concatenated or otherwise\n   combined.\n\n   Options that are allowed to appear only once are called \"singleton\n   options\".  The only non-singleton options defined in this document\n   are the IA_NA (see Section 21.4), Vendor Class (see Section 21.16),\n   Vendor-specific Information (see Section 21.17), and IA_PD (see Section 21.21) options.  Also, IA Address (see Section 21.6) and IA\n   Prefix (see Section 21.22) may appear in their respective IA options\n   more than once.",
        "children": {
          "21.1": {
            "title": "Format of DHCP Options",
            "content": "   The format of DHCP options is:\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |          option-code          |           option-len          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                          option-data                          |\n      |                      (option-len octets)                      |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                          Figure 12: Option Format\n\n   option-code             An unsigned integer identifying the specific\n                           option type carried in this option.\n                           A 2-octet field.\n\n   option-len              An unsigned integer giving the length of the\n                           option-data field in this option in octets.\n                           A 2-octet field.\n\n   option-data             The data for the option; the format of this\n                           data depends on the definition of the option.\n                           A variable-length field (the length, in\n                           octets, is specified by option-len).\n\n   DHCP options are scoped by using encapsulation.  Some options apply\n   generally to the client, some are specific to an IA, and some are\n   specific to the addresses within an IA.  These latter two cases are\n   discussed in Sections 21.4, 21.5, and 21.6. \n\n\n\n",
            "children": {}
          },
          "21.2": {
            "title": "Client Identifier Option",
            "content": "   The Client Identifier option is used to carry a DUID (see Section 11)\n   that identifies the client.  The format of the Client Identifier\n   option is:\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |        OPTION_CLIENTID        |          option-len           |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      .                                                               .\n      .                              DUID                             .\n      .                        (variable length)                      .\n      .                                                               .\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                 Figure 13: Client Identifier Option Format\n\n   option-code             OPTION_CLIENTID (1).\n\n   option-len              Length of DUID in octets.\n\n   DUID                    The DUID for the client.",
            "children": {}
          },
          "21.3": {
            "title": "Server Identifier Option",
            "content": "   The Server Identifier option is used to carry a DUID (see Section 11)\n   that identifies the server.  The format of the Server Identifier\n   option is:\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |        OPTION_SERVERID        |          option-len           |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      .                                                               .\n      .                              DUID                             .\n      .                        (variable length)                      .\n      .                                                               .\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                 Figure 14: Server Identifier Option Format\n\n   option-code             OPTION_SERVERID (2).\n\n   option-len              Length of DUID in octets. \n   DUID                    The DUID for the server.",
            "children": {}
          },
          "21.4": {
            "title": "Identity Association for Non-temporary Addresses Option",
            "content": "   The Identity Association for Non-temporary Addresses (IA_NA) option\n   is used to carry an IA_NA, the parameters associated with the IA_NA,\n   and the non-temporary addresses associated with the IA_NA.\n\n   A client that needs a short-term / special purpose address can use a\n   new IA_NA binding to request an address and release it when finished\n   with it.\n\n   Note: Addresses appearing in an IA_NA option are not temporary\n   addresses (see Section 21.5).\n\n   The format of the IA_NA option is:\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |          OPTION_IA_NA         |          option-len           |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                        IAID (4 octets)                        |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                              T1                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                              T2                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                                                               |\n      .                         IA_NA-options                         .\n      .                                                               .\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n        Figure 15: Identity Association for Non-temporary Addresses\n                               Option Format\n\n   option-code             OPTION_IA_NA (3).\n\n   option-len              12 + length of IA_NA-options field.\n\n   IAID                    The unique identifier for this IA_NA; the\n                           IAID must be unique among the identifiers for\n                           all of this client's IA_NAs.  The number\n                           space for IA_NA IAIDs is separate from the\n                           number space for other IA option types (i.e.,\n                           IA_PD).  A 4-octet field containing an\n                           unsigned integer. \n   T1                      The time interval after which the client\n                           should contact the server from which the\n                           addresses in the IA_NA were obtained to\n                           extend the lifetimes of the addresses\n                           assigned to the IA_NA; T1 is a time duration\n                           relative to the current time expressed in\n                           units of seconds.  A 4-octet field containing\n                           an unsigned integer.\n\n   T2                      The time interval after which the client\n                           should contact any available server to extend\n                           the lifetimes of the addresses assigned to\n                           the IA_NA; T2 is a time duration relative to\n                           the current time expressed in units of\n                           seconds.  A 4-octet field containing an\n                           unsigned integer.\n\n   IA_NA-options           Options associated with this IA_NA.  A\n                           variable-length field (12 octets less than\n                           the value in the option-len field).\n\n   The IA_NA-options field encapsulates those options that are specific\n   to this IA_NA.  For example, all of the IA Address options (see Section 21.6) carrying the addresses associated with this IA_NA are\n   in the IA_NA-options field.\n\n   Each IA_NA carries one \"set\" of non-temporary addresses; it is up to\n   the server policy to determine how many addresses are assigned, but\n   typically at most one address is assigned from each prefix assigned\n   to the link to which the client is attached.\n\n   An IA_NA option may only appear in the options area of a DHCP\n   message.  A DHCP message may contain multiple IA_NA options (though\n   each must have a unique IAID).\n\n   The status of any operations involving this IA_NA is indicated in a\n   Status Code option (see Section 21.13) in the IA_NA-options field.\n\n   Note that an IA_NA has no explicit \"lifetime\" or \"lease length\" of\n   its own.  When the valid lifetimes of all of the addresses in an\n   IA_NA have expired, the IA_NA can be considered as having expired.\n   T1 and T2 are included to give servers explicit control over when a\n   client recontacts the server about a specific IA_NA.\n\n   In a message sent by a client to a server, the T1 and T2 fields\n   SHOULD be set to 0.  The server MUST ignore any values in these\n   fields in messages received from a client. \n   In a message sent by a server to a client, the client MUST use the\n   values in the T1 and T2 fields for the T1 and T2 times, unless values\n   in those fields are 0.  The values in the T1 and T2 fields are the\n   number of seconds until T1 and T2 and are calculated since reception\n   of the message.\n\n   As per Section 7.7, the value 0xffffffff is taken to mean \"infinity\"\n   and should be used carefully.\n\n   The server selects the T1 and T2 values to allow the client to extend\n   the lifetimes of any addresses in the IA_NA before the lifetimes\n   expire, even if the server is unavailable for some short period of\n   time.  Recommended values for T1 and T2 are 0.5 and 0.8 times the\n   shortest preferred lifetime of the addresses in the IA that the\n   server is willing to extend, respectively.  If the \"shortest\"\n   preferred lifetime is 0xffffffff (\"infinity\"), the recommended T1 and\n   T2 values are also 0xffffffff.  If the time at which the addresses in\n   an IA_NA are to be renewed is to be left to the discretion of the\n   client, the server sets the T1 and T2 values to 0.  The client MUST\n   follow the rules defined in Section 14.2.\n\n   If a client receives an IA_NA with T1 greater than T2 and both T1 and\n   T2 are greater than 0, the client discards the IA_NA option and\n   processes the remainder of the message as though the server had not\n   included the invalid IA_NA option.",
            "children": {}
          },
          "21.5": {
            "title": "Identity Association for Temporary Addresses Option",
            "content": "   The Identity Association for Temporary Addresses (IA_TA) option is\n   obsoleted.  Please refer to [RFC8415] for historical information on\n   this option.\n\n   The client SHOULD NOT send this option.  The server SHOULD NOT send\n   this option.  When the server receives IA_TA option, the option\n   SHOULD be ignored and the message processing should continue as\n   usual.\n\n   As this option was never popular among server or client\n   implementations before being deprecated, any implementations that\n   still attempt to send it are unlikely to have the option processed.",
            "children": {}
          },
          "21.6": {
            "title": "IA Address Option",
            "content": "   The IA Address option is used to specify an address.  In this\n   document it is only specified to be encapsulated within an IA_NA.\n   DHCPv6 Leasequery [RFC5007] makes use of the IA Address Option\n   without encapsulating it in IA_NA.  The IAaddr-options field\n   encapsulates those options that are specific to this address. \n   The format of the IA Address option is:\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |          OPTION_IAADDR        |          option-len           |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                                                               |\n      |                         IPv6-address                          |\n      |                                                               |\n      |                                                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                      preferred-lifetime                       |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                        valid-lifetime                         |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      .                                                               .\n      .                        IAaddr-options                         .\n      .                                                               .\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                    Figure 16: IA Address Option Format\n\n   option-code             OPTION_IAADDR (5).\n\n   option-len              24 + length of IAaddr-options field.\n\n   IPv6-address            An IPv6 address.  A client MUST NOT form an\n                           implicit prefix with a length other than 128\n                           for this address.  A 16-octet field.\n\n   preferred-lifetime      The preferred lifetime for the address in the\n                           option, expressed in units of seconds.  A\n                           4-octet field containing an unsigned integer.\n\n   valid-lifetime          The valid lifetime for the address in the\n                           option, expressed in units of seconds.  A\n                           4-octet field containing an unsigned integer.\n\n   IAaddr-options          Options associated with this address.  A\n                           variable-length field (24 octets less than\n                           the value in the option-len field).\n\n   In a message sent by a client to a server, the preferred-lifetime and\n   valid-lifetime fields SHOULD be set to 0.  The server MUST ignore any\n   received values. \n   The client SHOULD NOT send the IA Address option with an unspecified\n   address (::).\n\n   In a message sent by a server to a client, the client MUST use the\n   values in the preferred-lifetime and valid-lifetime fields for the\n   preferred and valid lifetimes.  The values in these fields are the\n   number of seconds remaining in each lifetime.\n\n   The client MUST discard any addresses for which the preferred\n   lifetime is greater than the valid lifetime.\n\n   As per Section 7.7, if the valid lifetime of an address is\n   0xffffffff, it is taken to mean \"infinity\" and should be used\n   carefully.\n\n   More than one IA Address option can appear in an IA_NA option.\n\n   The status of any operations involving this IA Address is indicated\n   in a Status Code option in the IAaddr-options field, as specified in Section 21.13.",
            "children": {}
          },
          "21.7": {
            "title": "Option Request Option",
            "content": "   The Option Request option is used to identify a list of options in a\n   message between a client and a server.  The format of the Option\n   Request option is:\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |           OPTION_ORO          |           option-len          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |    requested-option-code-1    |    requested-option-code-2    |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                              ...                              |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                  Figure 17: Option Request Option Format\n\n   option-code                  OPTION_ORO (6).\n\n   option-len                   2 * number of requested options.\n\n   requested-option-code-n      The option code for an option requested\n                                by the client.  Each option code is a\n                                2-octet field containing an unsigned\n                                integer. \n   A client MUST include an Option Request option in a Solicit, Request,\n   Renew, Rebind, or Information-request message to inform the server\n   about options the client wants the server to send to the client.\n\n   The Option Request option MUST NOT include the following option\n   codes:\n\n   *  Client Identifier (see Section 21.2)\n\n   *  Server Identifier (see Section 21.3)\n\n   *  IA_NA (see Section 21.4)\n\n   *  IA_TA (option obsoleted, see Section 21.5)\n\n   *  IA_PD (see Section 21.21)\n\n   *  IA Address (see Section 21.6)\n\n   *  IA Prefix (see Section 21.22)\n\n   *  Option Request (this section)\n\n   *  Elapsed Time (see Section 21.9)\n\n   *  Preference (see Section 21.8)\n\n   *  Relay Message (see Section 21.10)\n\n   *  Authentication (see Section 21.11)\n\n   *  Server Unicast (option obsoleted, see Section 21.12)\n\n   *  Status Code (see Section 21.13)\n\n   *  Rapid Commit (see Section 21.14)\n\n   *  User Class (see Section 21.15)\n\n   *  Vendor Class (see Section 21.16)\n\n   *  Interface-Id (see Section 21.18)\n\n   *  Reconfigure Message (see Section 21.19)\n\n   *  Reconfigure Accept (see Section 21.20)\n   Other top-level option codes MUST appear in the Option Request option\n   or they will not be sent by the server.  Only top-level option codes\n   MAY appear in the Option Request option.  Option codes encapsulated\n   in a container option SHOULD NOT appear in an Option Request option;\n   see [RFC7598] for an example of container options.  However, options\n   MAY be defined that specify exceptions to this restriction on\n   including encapsulated option codes in an Option Request option.  For\n   example, the Option Request option MAY be used to signal support for\n   a feature even when that option is encapsulated, as in the case of\n   the Prefix Exclude option [RFC6603].  See [IANA-OPTION-DETAILS ].\n\n   See [IANA-OPTION-DETAILS ] for the authoritative list of which option\n   codes are required, permitted or forbidden.",
            "children": {}
          },
          "21.8": {
            "title": "Preference Option",
            "content": "   The Preference option is sent by a server to a client to control the\n   selection of a server by the client.\n\n   The format of the Preference option is:\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |       OPTION_PREFERENCE       |          option-len           |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |  pref-value   |\n      +-+-+-+-+-+-+-+-+\n\n                    Figure 18: Preference Option Format\n\n   option-code             OPTION_PREFERENCE (7).\n\n   option-len              1.\n\n   pref-value              The preference value for the server in this\n                           message.  A 1-octet unsigned integer.\n\n   A server MAY include a Preference option in an Advertise message to\n   control the selection of a server by the client.  See Section 18.2.9   for information regarding the use of the Preference option by the\n   client and the interpretation of the Preference option data value.",
            "children": {}
          },
          "21.9": {
            "title": "Elapsed Time Option",
            "content": "\n\n\n\n\n\n\n\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |      OPTION_ELAPSED_TIME      |           option-len          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |          elapsed-time         |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                   Figure 19: Elapsed Time Option Format\n\n   option-code             OPTION_ELAPSED_TIME (8).\n\n   option-len              2.\n\n   elapsed-time            The amount of time since the client began its\n                           current DHCP transaction.  This time is\n                           expressed in hundredths of a second\n                           (10^-2 seconds).  A 2-octet field containing\n                           an unsigned integer.\n\n   A client MUST include an Elapsed Time option in messages to indicate\n   how long the client has been trying to complete a DHCP message\n   exchange.  The elapsed time is measured from the time at which the\n   client sent the first message in the message exchange, and the\n   elapsed-time field is set to 0 in the first message in the message\n   exchange.  Servers and relay agents use the data value in this option\n   as input to policy that controls how a server responds to a client\n   message.  For example, the Elapsed Time option allows a secondary\n   DHCP server to respond to a request when a primary server has not\n   answered in a reasonable time.  The elapsed-time value is a 16-bit\n   (2-octet) unsigned integer.  The client uses the value 0xffff to\n   represent any elapsed-time values greater than the largest time value\n   that can be represented in the Elapsed Time option.",
            "children": {}
          },
          "21.10": {
            "title": "Relay Message Option",
            "content": "   The Relay Message option carries a DHCP message in a Relay-forward or\n   Relay-reply message.\n\n   The format of the Relay Message option is:\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |        OPTION_RELAY_MSG       |           option-len          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                                                               |\n      .                       DHCP-relay-message                      .\n      .                                                               .\n      .                                                               .\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                   Figure 20: Relay Message Option Format\n\n   option-code             OPTION_RELAY_MSG (9).\n\n   option-len              Length of DHCP-relay-message field.\n\n   DHCP-relay-message      In a Relay-forward message, the received\n                           message, relayed verbatim to the next relay\n                           agent or server; in a Relay-reply message,\n                           the message to be copied and relayed to the\n                           relay agent or client whose address is in the\n                           peer-address field of the Relay-reply\n                           message.  The length, in octets, is specified\n                           by option-len.",
            "children": {}
          },
          "21.11": {
            "title": "Authentication Option",
            "content": "   The Authentication option carries authentication information to\n   authenticate the identity and contents of DHCP messages.  The use of\n   the Authentication option is described in Section 20.  The format of\n   the Authentication option is:\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |          OPTION_AUTH          |          option-len           |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |   protocol    |   algorithm   |      RDM      |               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |\n      |                                                               |\n      |          replay detection (64 bits)           +-+-+-+-+-+-+-+-+\n      |                                               |               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |\n      .                   authentication information                  .\n      .                       (variable length)                       .\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n                  Figure 21: Authentication Option Format\n\n   option-code                     OPTION_AUTH (11).\n\n   option-len                      11 + length of authentication\n                                   information field.\n\n   protocol                        The authentication protocol used in\n                                   this Authentication option.  A\n                                   1-octet unsigned integer.\n\n   algorithm                       The algorithm used in the\n                                   authentication protocol.  A 1-octet\n                                   unsigned integer.\n\n   RDM                             The replay detection method used in\n                                   this Authentication option.  A\n                                   1-octet unsigned integer.\n\n   replay detection                The replay detection information for\n                                   the RDM.  A 64-bit (8-octet) field.\n\n   authentication information      The authentication information, as\n                                   specified by the protocol and\n                                   algorithm used in this Authentication\n                                   option.  A variable-length field\n                                   (11 octets less than the value in the\n                                   option-len field).\n\n   IANA maintains a registry for the protocol, algorithm, and RDM values\n   at <https://www.iana.org/assignments/auth-namespaces >.",
            "children": {}
          },
          "21.12": {
            "title": "Server Unicast Option",
            "content": "   The Server Unicast option is obsolete.  Please refer to [RFC8415] for\n   historical information on this option.\n\n   The client SHOULD NOT request this option in the Option Request\n   option.  The server SHOULD NOT send this option, even when requested\n   by clients.  When any entity receives the Server Unicast option, the\n   option SHOULD be ignored and the message processing should continue\n   as usual.\n\n   As this option was not very popular and it typically required special\n   configuration by those server implementations that did support it,\n   clients still requesting this option in the Option Request option are\n   increasingly unlikely to receive it. \n\n\n\n",
            "children": {}
          },
          "21.13": {
            "title": "Status Code Option",
            "content": "   This option returns a status indication related to the DHCP message\n   or option in which it appears.  The format of the Status Code\n   option is:\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |       OPTION_STATUS_CODE      |         option-len            |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |          status-code          |                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |\n      .                                                               .\n      .                        status-message                         .\n      .                                                               .\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                    Figure 22: Status Code Option Format\n\n   option-code             OPTION_STATUS_CODE (13).\n\n   option-len              2 + length of status-message field.\n\n   status-code             The numeric code for the status encoded in\n                           this option.  A 2-octet field containing an\n                           unsigned integer.\n\n   status-message          A UTF-8 encoded [RFC3629] text string\n                           suitable for display to an end user.\n                           MUST NOT be null-terminated.  A variable-\n                           length field (2 octets less than the value in\n                           the option-len field).\n\n   A Status Code option may appear in the \"options\" field of a DHCP\n   message and/or in the \"options\" field of another option.  If the\n   Status Code option does not appear in a message in which the option\n   could appear, the status of the message is assumed to be Success.\n\n   The status-code values are:\n       +===============+======+===================================+\n       | Name          | Code | Description                       |\n       +===============+======+===================================+\n       | Success       |    0 | Success.                          |\n       +---------------+------+-----------------------------------+\n       | UnspecFail    |    1 | Failure, reason unspecified; this |\n       |               |      | status code is sent by either a   |\n       |               |      | client or a server to indicate a  |\n       |               |      | failure not explicitly specified  |\n       |               |      | in this document.                 |\n       +---------------+------+-----------------------------------+\n       | NoAddrsAvail  |    2 | The server has no addresses       |\n       |               |      | available to assign to the IA(s). |\n       +---------------+------+-----------------------------------+\n       | NoBinding     |    3 | Client record (binding)           |\n       |               |      | unavailable.                      |\n       +---------------+------+-----------------------------------+\n       | NotOnLink     |    4 | The prefix for the address is not |\n       |               |      | appropriate for the link to which |\n       |               |      | the client is attached.           |\n       +---------------+------+-----------------------------------+\n       | UseMulticast  |    5 | Sent by a server to a client to   |\n       |               |      | force the client to send messages |\n       |               |      | to the server using the           |\n       |               |      | All_DHCP_Relay_Agents_and_Servers |\n       |               |      | multicast address.  Obsoleted; no |\n       |               |      | longer used.                      |\n       +---------------+------+-----------------------------------+\n       | NoPrefixAvail |    6 | The server has no prefixes        |\n       |               |      | available to assign to the        |\n       |               |      | IA_PD(s).                         |\n       +---------------+------+-----------------------------------+\n\n                     Table 3: Status Code Definitions\n\n   See the \"Status Codes\" registry at <https://www.iana.org/assignments/\n   dhcpv6-parameters > for the current list of status codes.",
            "children": {}
          },
          "21.14": {
            "title": "Rapid Commit Option",
            "content": "   The Rapid Commit option is used to signal the use of the two-message\n   exchange for address assignment.  The format of the Rapid Commit\n   option is:\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |      OPTION_RAPID_COMMIT      |         option-len            |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                   Figure 23: Rapid Commit Option Format\n\n   option-code             OPTION_RAPID_COMMIT (14).\n\n   option-len              0.\n\n   A client MAY include this option in a Solicit message if the client\n   is prepared to perform the Solicit/Reply message exchange described\n   in Section 18.2.1.\n\n   A server MUST include this option in a Reply message sent in response\n   to a Solicit message when completing the Solicit/Reply message\n   exchange.\n\n   DISCUSSION:\n\n      Each server that responds with a Reply to a Solicit that includes\n      a Rapid Commit option will commit the leases in the Reply message\n      to the client but will not receive any confirmation that the\n      client has received the Reply message.  Therefore, if more than\n      one server responds to a Solicit that includes a Rapid Commit\n      option, all but one server will commit leases that are not\n      actually used by the client; this could result in incorrect\n      address information in DNS if the DHCP servers update DNS\n      [RFC4704], and responses to leasequery requests [RFC5007] may\n      include information on leases not in use by the client.\n\n      The problem of unused leases can be minimized by designing the\n      DHCP service so that only one server responds to the Solicit or by\n      using relatively short lifetimes for newly assigned leases.",
            "children": {}
          },
          "21.15": {
            "title": "User Class Option",
            "content": "   The User Class option is used by a client to identify the type or\n   category of users or applications it represents.\n\n   The format of the User Class option is:\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |       OPTION_USER_CLASS       |          option-len           |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      .                                                               .\n      .                          user-class-data                      .\n      .                                                               .\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                    Figure 24: User Class Option Format\n\n   option-code             OPTION_USER_CLASS (15).\n\n   option-len              Length of user-class-data field.\n\n   user-class-data         The user classes carried by the client.  The\n                           length, in octets, is specified by\n                           option-len.\n\n   The information contained in the data area of this option is\n   contained in one or more opaque fields that represent the user class\n   or classes of which the client is a member.  A server selects\n   configuration information for the client based on the classes\n   identified in this option.  For example, the User Class option can be\n   used to configure all clients of people in the accounting department\n   with a different printer than clients of people in the marketing\n   department.  The user class information carried in this option MUST\n   be configurable on the client.\n\n   The data area of the User Class option MUST contain one or more\n   instances of user-class-data information.  Each instance of\n   user-class-data is formatted as follows:\n\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-...-+-+-+-+-+-+-+\n      |        user-class-len         |          opaque-data          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-...-+-+-+-+-+-+-+\n\n                 Figure 25: Format of user-class-data Field\n\n   The user-class-len field is 2 octets long and specifies the length of\n   the opaque user-class-data in network byte order.\n\n   A server interprets the classes identified in this option according\n   to its configuration to select the appropriate configuration\n   information for the client.  A server may use only those user classes\n   that it is configured to interpret in selecting configuration\n   information for a client and ignore any other user classes.  In \n   response to a message containing a User Class option, a server may\n   include a User Class option containing those classes that were\n   successfully interpreted by the server so that the client can be\n   informed of the classes interpreted by the server.",
            "children": {}
          },
          "21.16": {
            "title": "Vendor Class Option",
            "content": "   This option is used by a client to identify the vendor that\n   manufactured the hardware on which the client is running.  The\n   information contained in the data area of this option is contained in\n   one or more opaque fields that identify details of the hardware\n   configuration.  The format of the Vendor Class option is:\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |      OPTION_VENDOR_CLASS      |           option-len          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                       enterprise-number                       |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      .                                                               .\n      .                       vendor-class-data                       .\n      .                             . . .                             .\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                   Figure 26: Vendor Class Option Format\n\n   option-code             OPTION_VENDOR_CLASS (16).\n\n   option-len              4 + length of vendor-class-data field.\n\n   enterprise-number       The vendor's registered Enterprise Number as\n                           maintained by IANA [IANA-PEN ].  A 4-octet\n                           field containing an unsigned integer.\n\n   vendor-class-data       The hardware configuration of the node on\n                           which the client is running.  A\n                           variable-length field (4 octets less than the\n                           value in the option-len field).\n\n   The vendor-class-data field is composed of a series of separate\n   items, each of which describes some characteristic of the client's\n   hardware configuration.  Examples of vendor-class-data instances\n   might include the version of the operating system the client is\n   running or the amount of memory installed on the client.\n\n   Each instance of vendor-class-data is formatted as follows:\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-...-+-+-+-+-+-+-+\n      |       vendor-class-len        |          opaque-data          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-...-+-+-+-+-+-+-+\n\n                Figure 27: Format of vendor-class-data Field\n\n   The vendor-class-len field is 2 octets long and specifies the length\n   of the opaque vendor-class-data in network byte order.\n\n   Servers and clients MUST NOT include more than one instance of\n   OPTION_VENDOR_CLASS with the same Enterprise Number.  Each instance\n   of OPTION_VENDOR_CLASS can carry multiple vendor-class-data\n   instances.",
            "children": {}
          },
          "21.17": {
            "title": "Vendor-specific Information Option",
            "content": "   This option is used by clients and servers to exchange vendor-\n   specific information.\n\n   The format of the Vendor-specific Information option is:\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |      OPTION_VENDOR_OPTS       |           option-len          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                       enterprise-number                       |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      .                                                               .\n      .                       vendor-option-data                      .\n      .                                                               .\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n            Figure 28: Vendor-specific Information Option Format\n\n   option-code             OPTION_VENDOR_OPTS (17).\n\n   option-len              4 + length of vendor-option-data field.\n\n   enterprise-number       The vendor's registered Enterprise Number as\n                           maintained by IANA [IANA-PEN ].  A 4-octet\n                           field containing an unsigned integer.\n\n   vendor-option-data      Vendor options, interpreted by vendor-\n                           specific code on the clients and servers.  A\n                           variable-length field (4 octets less than the\n                           value in the option-len field). \n   The definition of the information carried in this option is vendor\n   specific.  The vendor is indicated in the enterprise-number field.\n   Use of vendor-specific information allows enhanced operation,\n   utilizing additional features in a vendor's DHCP implementation.  A\n   DHCP client that does not receive requested vendor-specific\n   information will still configure the node's IPv6 stack to be\n   functional.\n\n   The vendor-option-data field MUST be encoded as a sequence of\n   code/length/value fields of format identical to the DHCP options (see Section 21.1).  The suboption codes are defined by the vendor\n   identified in the enterprise-number field and are not managed by\n   IANA.  Each of the suboptions is formatted as follows:\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |          sub-opt-code         |         suboption-len         |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      .                                                               .\n      .                        suboption-data                        .\n      .                                                               .\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                 Figure 29: Vendor-specific Options Format\n\n   sub-opt-code            The code for the suboption.  A 2-octet field.\n\n   suboption-len           An unsigned integer giving the length of the\n                           suboption-data field in this suboption in\n                           octets.  A 2-octet field.\n\n   suboption-data          The data area for the suboption.  The length,\n                           in octets, is specified by sub-option-len.\n\n   Multiple instances of the Vendor-specific Information option may\n   appear in a DHCP message.  Each instance of the option is interpreted\n   according to the option codes defined by the vendor identified by the\n   Enterprise Number in that option.  Servers and clients MUST NOT send\n   more than one instance of the Vendor-specific Information option with\n   the same Enterprise Number.  Each instance of the Vendor-specific\n   Information option MAY contain multiple suboptions.\n\n   A client that is interested in receiving a Vendor-specific\n   Information option:\n\n   *  MUST specify the Vendor-specific Information option in an Option\n      Request option. \n   *  MAY specify an associated Vendor Class option (see Section 21.16).\n\n   *  MAY specify the Vendor-specific Information option with\n      appropriate data.\n\n   Servers only return the Vendor-specific Information options if\n   specified in Option Request options from clients and:\n\n   *  MAY use the Enterprise Numbers in the associated Vendor Class\n      options to restrict the set of Enterprise Numbers in the\n      Vendor-specific Information options returned.\n\n   *  MAY return all configured Vendor-specific Information options.\n\n   *  MAY use other information in the message or in its configuration\n      to determine which set of Enterprise Numbers in the Vendor-\n      specific Information options to return.",
            "children": {}
          },
          "21.18": {
            "title": "Interface-Id Option",
            "content": "   The relay agent MAY send the Interface-Id option to identify the\n   interface on which the client message was received.  If a relay agent\n   receives a Relay-reply message with an Interface-Id option, the relay\n   agent relays the message to the client through the interface\n   identified by the option.\n\n   The format of the Interface-Id option is:\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |      OPTION_INTERFACE_ID      |         option-len            |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      .                                                               .\n      .                         interface-id                          .\n      .                                                               .\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                   Figure 30: Interface-Id Option Format\n\n   option-code             OPTION_INTERFACE_ID (18).\n\n   option-len              Length of interface-id field.\n\n   interface-id            An opaque value of arbitrary length generated\n                           by the relay agent to identify one of the\n                           relay agent's interfaces.  The length, in\n                           octets, is specified by option-len. \n   The server MUST copy the Interface-Id option from the Relay-forward\n   message into the Relay-reply message the server sends to the relay\n   agent in response to the Relay-forward message.  This option MUST NOT\n   appear in any message except a Relay-forward or Relay-reply message.\n\n   Servers MAY use the interface-id field for parameter assignment\n   policies.  The interface-id value SHOULD be considered an opaque\n   value, with policies based on exact match only; that is, the\n   interface-id field SHOULD NOT be internally parsed by the server.\n   The interface-id value for an interface SHOULD be stable and remain\n   unchanged -- for example, after the relay agent is restarted; if the\n   interface-id value changes, a server will not be able to use it\n   reliably in parameter assignment policies.",
            "children": {}
          },
          "21.19": {
            "title": "Reconfigure Message Option",
            "content": "   A server includes a Reconfigure Message option in a Reconfigure\n   message to indicate to the client whether the client responds with a\n   Renew message, a Rebind message, or an Information-request message.\n   The format of the Reconfigure Message option is:\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |      OPTION_RECONF_MSG        |         option-len            |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |    msg-type   |\n      +-+-+-+-+-+-+-+-+\n\n                Figure 31: Reconfigure Message Option Format\n\n   option-code             OPTION_RECONF_MSG (19).\n\n   option-len              1.\n\n   msg-type                5 for Renew message, 6 for Rebind message,\n                           11 for Information-request message.  A\n                           1-octet unsigned integer.\n\n   The Reconfigure Message option can only appear in a Reconfigure\n   message. \n\n\n\n",
            "children": {}
          },
          "21.20": {
            "title": "Reconfigure Accept Option",
            "content": "   A client uses the Reconfigure Accept option to announce to the server\n   whether the client is willing to accept Reconfigure messages, and a\n   server uses this option to tell the client whether or not to accept\n   Reconfigure messages.  In the absence of this option, the default\n   behavior is that the client is unwilling to accept Reconfigure\n   messages.  The format of the Reconfigure Accept option is:\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |     OPTION_RECONF_ACCEPT      |         option-len            |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                Figure 32: Reconfigure Accept Option Format\n\n   option-code             OPTION_RECONF_ACCEPT (20).\n\n   option-len              0.",
            "children": {}
          },
          "21.21": {
            "title": "Identity Association for Prefix Delegation Option",
            "content": "   The IA_PD option is used to carry a prefix delegation identity\n   association, the parameters associated with the IA_PD, and the\n   prefixes associated with it.  The format of the IA_PD option is:\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |         OPTION_IA_PD          |           option-len          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                         IAID (4 octets)                       |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                              T1                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                              T2                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      .                                                               .\n      .                          IA_PD-options                        .\n      .                                                               .\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n    Figure 33: Identity Association for Prefix Delegation Option Format\n\n   option-code             OPTION_IA_PD (25).\n\n   option-len              12 + length of IA_PD-options field. \n   IAID                    The unique identifier for this IA_PD; the\n                           IAID must be unique among the identifiers for\n                           all of this client's IA_PDs.  The number\n                           space for IA_PD IAIDs is separate from the\n                           number space for other IA option types (i.e.,\n                           IA_NA).  A 4-octet field containing an\n                           unsigned integer.\n\n   T1                      The time interval after which the client\n                           should contact the server from which the\n                           prefixes in the IA_PD were obtained to extend\n                           the lifetimes of the prefixes delegated to\n                           the IA_PD; T1 is a time duration relative to\n                           the message reception time expressed in units\n                           of seconds.  A 4-octet field containing an\n                           unsigned integer.\n\n   T2                      The time interval after which the client\n                           should contact any available server to extend\n                           the lifetimes of the prefixes assigned to the\n                           IA_PD; T2 is a time duration relative to the\n                           message reception time expressed in units of\n                           seconds.  A 4-octet field containing an\n                           unsigned integer.\n\n   IA_PD-options           Options associated with this IA_PD.  A\n                           variable-length field (12 octets less than\n                           the value in the option-len field).\n\n   The IA_PD-options field encapsulates those options that are specific\n   to this IA_PD.  For example, all of the IA Prefix options (see Section 21.22) carrying the prefixes associated with this IA_PD are\n   in the IA_PD-options field.\n\n   An IA_PD option may only appear in the options area of a DHCP\n   message.  A DHCP message may contain multiple IA_PD options (though\n   each must have a unique IAID).\n\n   The status of any operations involving this IA_PD is indicated in a\n   Status Code option (see Section 21.13) in the IA_PD-options field.\n\n   Note that an IA_PD has no explicit \"lifetime\" or \"lease length\" of\n   its own.  When the valid lifetimes of all of the prefixes in an IA_PD\n   have expired, the IA_PD can be considered as having expired.  T1 and\n   T2 fields are included to give the server explicit control over when\n   a client should contact the server about a specific IA_PD. \n   In a message sent by a client to a server, the T1 and T2 fields\n   SHOULD be set to 0.  The server MUST ignore any values in these\n   fields in messages received from a client.\n\n   In a message sent by a server to a client, the client MUST use the\n   values in the T1 and T2 fields for the T1 and T2 timers, unless\n   values in those fields are 0.  The values in the T1 and T2 fields are\n   the number of seconds until T1 and T2.\n\n   The server selects the T1 and T2 times to allow the client to extend\n   the lifetimes of any prefixes in the IA_PD before the lifetimes\n   expire, even if the server is unavailable for some short period of\n   time.  Recommended values for T1 and T2 are 0.5 and 0.8 times the\n   shortest preferred lifetime of the prefixes in the IA_PD that the\n   server is willing to extend, respectively.  If the time at which the\n   prefixes in an IA_PD are to be renewed is to be left to the\n   discretion of the client, the server sets T1 and T2 to 0.  The client\n   MUST follow the rules defined in Section 14.2.\n\n   If a client receives an IA_PD with T1 greater than T2 and both T1 and\n   T2 are greater than 0, the client discards the IA_PD option and\n   processes the remainder of the message as though the server had not\n   included the IA_PD option.",
            "children": {}
          },
          "21.22": {
            "title": "IA Prefix Option",
            "content": "   The IA Prefix option is used to specify a prefix associated with an\n   IA_PD.  The IA Prefix option must be encapsulated in the\n   IA_PD-options field of an IA_PD option (see Section 21.21). \n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |        OPTION_IAPREFIX        |           option-len          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                      preferred-lifetime                       |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                        valid-lifetime                         |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      | prefix-length |                                               |\n      +-+-+-+-+-+-+-+-+          IPv6-prefix                          |\n      |                           (16 octets)                         |\n      |                                                               |\n      |                                                               |\n      |                                                               |\n      |               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |               |                                               .\n      +-+-+-+-+-+-+-+-+                                               .\n      .                       IAprefix-options                        .\n      .                                                               .\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                     Figure 34: IA Prefix Option Format\n\n   option-code             OPTION_IAPREFIX (26).\n\n   option-len              25 + length of IAprefix-options field.\n\n   preferred-lifetime      The preferred lifetime for the prefix in the\n                           option, expressed in units of seconds.  A\n                           value of 0xffffffff represents \"infinity\"\n                           (see Section 7.7).  A 4-octet field\n                           containing an unsigned integer.\n\n   valid-lifetime          The valid lifetime for the prefix in the\n                           option, expressed in units of seconds.  A\n                           value of 0xffffffff represents \"infinity\".  A\n                           4-octet field containing an unsigned integer.\n\n   prefix-length           Length for this prefix in bits.  A 1-octet\n                           unsigned integer.\n\n   IPv6-prefix             An IPv6 prefix.  A 16-octet field.\n\n   IAprefix-options        Options associated with this prefix.  A\n                           variable-length field (25 octets less than\n                           the value in the option-len field). \n   In a message sent by a client to a server, the preferred-lifetime and\n   valid-lifetime fields SHOULD be set to 0.  The server MUST ignore any\n   received values in these lifetime fields.\n\n   The client SHOULD NOT send an IA Prefix option with 0 in the\n   \"prefix-length\" field (and an unspecified value (::) in the\n   \"IPv6-prefix\" field).  A client MAY send a non-zero value in the\n   \"prefix-length\" field and the unspecified value (::) in the\n   \"IPv6-prefix\" field to indicate a preference for the size of the\n   prefix to be delegated.  See [RFC8168] for further details on prefix-\n   length hints.\n\n   The client MUST discard any prefixes for which the preferred lifetime\n   is greater than the valid lifetime.\n\n   The values in the preferred-lifetime and valid-lifetime fields are\n   the number of seconds remaining in each lifetime.  See Section 18.2.10.1 for more details on how these values are used for\n   delegated prefixes.\n\n   As per Section 7.7, the value of 0xffffffff for the preferred\n   lifetime or the valid lifetime is taken to mean \"infinity\" and should\n   be used carefully.\n\n   An IA Prefix option may appear only in an IA_PD option.  More than\n   one IA Prefix option can appear in a single IA_PD option.\n\n   The status of any operations involving this IA Prefix option is\n   indicated in a Status Code option (see Section 21.13) in the\n   IAprefix-options field.",
            "children": {}
          },
          "21.23": {
            "title": "Information Refresh Time Option",
            "content": "   This option is requested by clients and returned by servers to\n   specify an upper bound for how long a client should wait before\n   refreshing information retrieved from a DHCP server.  It is only used\n   in Reply messages in response to Information-request messages.  In\n   other messages, there will usually be other information that\n   indicates when the client should contact the server, e.g., T1/T2\n   times and lifetimes.  This option is useful when the configuration\n   parameters change or during a renumbering event, as clients running\n   in the stateless mode will be able to update their configuration.\n\n   The format of the Information Refresh Time option is:\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |OPTION_INFORMATION_REFRESH_TIME|         option-len            |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                   information-refresh-time                    |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n             Figure 35: Information Refresh Time Option Format\n\n   option-code                   OPTION_INFORMATION_REFRESH_TIME (32).\n\n   option-len                    4.\n\n   information-refresh-time      Time duration relative to the current\n                                 time, expressed in units of seconds.  A\n                                 4-octet field containing an unsigned\n                                 integer.\n\n   A DHCP client MUST request this option in the Option Request option\n   (see Section 21.7) when sending Information-request messages.  A\n   client MUST NOT request this option in the Option Request option in\n   any other messages.\n\n   A server sending a Reply to an Information-request message SHOULD\n   include this option if it is requested in the Option Request option\n   of the Information-request.  The option value MUST NOT be smaller\n   than IRT_MINIMUM.  This option MUST only appear in the top-level\n   options area of Reply messages.\n\n   If the Reply to an Information-request message does not contain this\n   option, the client MUST behave as if the option with the value\n   IRT_DEFAULT was provided.\n\n   A client MUST use the refresh time IRT_MINIMUM if it receives the\n   option with a value less than IRT_MINIMUM.\n\n   As per Section 7.7, the value 0xffffffff is taken to mean \"infinity\"\n   and implies that the client should not refresh its configuration data\n   without some other trigger (such as detecting movement to a new\n   link).\n\n   If a client contacts the server to obtain new data or refresh some\n   existing data before the refresh time expires, then it SHOULD also\n   refresh all data covered by this option. \n   When the client detects that the refresh time has expired, it SHOULD\n   try to update its configuration data by sending an\n   Information-request as specified in Section 18.2.6, except that the\n   client MUST delay sending the first Information-request by a random\n   amount of time between 0 and INF_MAX_DELAY.\n\n   A client MAY have a maximum value for the refresh time, where that\n   value is used whenever the client receives this option with a value\n   higher than the maximum.  This also means that the maximum value is\n   used when the received value is \"infinity\".  A maximum value might\n   make the client less vulnerable to attacks based on forged DHCP\n   messages.  Without a maximum value, a client may be made to use wrong\n   information for a possibly infinite period of time.  There may,\n   however, be reasons for having a very long refresh time, so it may be\n   useful for this maximum value to be configurable.",
            "children": {}
          },
          "21.24": {
            "title": "SOL_MAX_RT Option",
            "content": "   A DHCP server sends the SOL_MAX_RT option to a client to override the\n   default value of SOL_MAX_RT.  The value of SOL_MAX_RT in the option\n   replaces the default value defined in Section 7.6.  One use for the\n   SOL_MAX_RT option is to set a higher value for SOL_MAX_RT; this\n   reduces the Solicit traffic from a client that has not received a\n   response to its Solicit messages.\n\n   The format of the SOL_MAX_RT option is:\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |      OPTION_SOL_MAX_RT        |         option-len            |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                       SOL_MAX_RT value                        |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                    Figure 36: SOL_MAX_RT Option Format\n\n   option-code             OPTION_SOL_MAX_RT (82).\n\n   option-len              4.\n\n   SOL_MAX_RT value        Overriding value for SOL_MAX_RT in seconds;\n                           MUST be in this range: 60 <= \"value\" <= 86400\n                           (1 day).  A 4-octet field containing an\n                           unsigned integer.\n\n   A DHCP client MUST include the SOL_MAX_RT option code in any Option\n   Request option (see Section 21.7) it sends in a Solicit message. \n   The DHCP server MAY include the SOL_MAX_RT option in any response it\n   sends to a client that has included the SOL_MAX_RT option code in an\n   Option Request option.  The SOL_MAX_RT option is sent as a top-level\n   option in the message to the client.\n\n   A DHCP client MUST ignore any SOL_MAX_RT option values that are less\n   than 60 or more than 86400.\n\n   If a DHCP client receives a message containing a SOL_MAX_RT option\n   that has a valid value for SOL_MAX_RT, the client MUST set its\n   internal SOL_MAX_RT parameter to the value contained in the\n   SOL_MAX_RT option.  This value of SOL_MAX_RT is then used by the\n   retransmission mechanism defined in Sections 15 and 18.2.1.\n\n   The purpose of this mechanism is to give network administrators a way\n   to avoid excessive DHCP traffic if all DHCP servers become\n   unavailable.  Therefore, this value is expected to be retained for as\n   long as practically possible.\n\n   An updated SOL_MAX_RT value applies only to the network interface on\n   which the client received the SOL_MAX_RT option.",
            "children": {}
          },
          "21.25": {
            "title": "INF_MAX_RT Option",
            "content": "   A DHCP server sends the INF_MAX_RT option to a client to override the\n   default value of INF_MAX_RT.  The value of INF_MAX_RT in the option\n   replaces the default value defined in Section 7.6.  One use for the\n   INF_MAX_RT option is to set a higher value for INF_MAX_RT; this\n   reduces the Information-request traffic from a client that has not\n   received a response to its Information-request messages.\n\n   The format of the INF_MAX_RT option is:\n\n       0                   1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |      OPTION_INF_MAX_RT        |         option-len            |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |                       INF_MAX_RT value                        |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                    Figure 37: INF_MAX_RT Option Format\n\n   option-code             OPTION_INF_MAX_RT (83).\n\n   option-len              4.\n\n   INF_MAX_RT value        Overriding value for INF_MAX_RT in seconds;\n                           MUST be in this range: 60 <= \"value\" <= 86400\n                           (1 day).  A 4-octet field containing an\n                           unsigned integer.\n\n   A DHCP client MUST include the INF_MAX_RT option code in any Option\n   Request option (see Section 21.7) it sends in an Information-request\n   message.\n\n   The DHCP server MAY include the INF_MAX_RT option in any response it\n   sends to a client that has included the INF_MAX_RT option code in an\n   Option Request option.  The INF_MAX_RT option is a top-level option\n   in the message to the client.\n\n   A DHCP client MUST ignore any INF_MAX_RT option values that are less\n   than 60 or more than 86400.\n\n   If a DHCP client receives a message containing an INF_MAX_RT option\n   that has a valid value for INF_MAX_RT, the client MUST set its\n   internal INF_MAX_RT parameter to the value contained in the\n   INF_MAX_RT option.  This value of INF_MAX_RT is then used by the\n   retransmission mechanism defined in Sections 15 and 18.2.6.\n\n   An updated INF_MAX_RT value applies only to the network interface on\n   which the client received the INF_MAX_RT option.",
            "children": {}
          }
        }
      },
      "22": {
        "title": "Implementation status",
        "content": "   NOTE TO RFC EDITOR: Please remove this section before publication.\n   It is intended for the IESG evaluation.\n\n   This section records the status of known implementations of the\n   protocol defined by this specification at the time of posting of this\n   Internet-Draft, and is based on a proposal described in RFC 7942.\n   The description of implementations in this section is intended to\n   assist the IETF in its decision processes in progressing drafts to\n   RFCs.  Please note that the listing of any individual implementation\n   here does not imply endorsement by the IETF.  Furthermore, no effort\n   has been spent to verify the information presented here that was\n   supplied by IETF contributors.  This is not intended as, and must not\n   be construed to be, a catalog of available implementations or their\n   features.  Readers are advised to note that other implementations may\n   exist. \n   According to RFC 7942, \"this will allow reviewers and working groups\n   to assign due consideration to documents that have the benefit of\n   running code, which may serve as evidence of valuable experimentation\n   and feedback that have made the implemented protocols more mature.\n   It is up to the individual working groups to use this information as\n   they see fit\".\n\n   The DHCPv6 protocol was originally published as RFC 3315 in July\n   2003.  Many extensions were defined and RFC 8415 was published in\n   November 2018.  The protocol was implemented by many vendors that\n   claim DHCPv6 compliance.  It is sometimes difficult to determine\n   whether full compliance with 8415 is claimed.\n\n   The DHCPv6 protocol enjoys multiple interoperable implementations\n   from all sectors of industry.  There are many open source and\n   proprietary implementations, both general software and hardware-\n   specific.  The following implementations (listed alphabetically) are\n   known to support DHCPv6:\n\n   *  Android (Google): In March 2023 (IETF'115) Google revealed it is\n      working on the PD client implementation for Android.  Open source.\n      Maturity: prototype.  Details are scarce, but it seems the\n      implementation will focus on PD functionality.  Source:https://datatracker.ietf.org/meeting/116/materials/slides-116-\n      v6ops-using-dhcp-pd-to-allocate-64-per-host-in-broadcast-networks-      00, slide 17.\n\n   *  Cisco Prime Network Registrar: Cisco's software suite that\n      supports many protocols, including RFC8415 compliant server\n      functionality.  Proprietary.  Maturity: widely used.  One of the\n      authors of this I-D was heavily involved in CPNR development.\n      Source: https://www.cisco.com/c/en/us/products/collateral/cloud-\n      systems-management/prime-network-registrar/datasheet-      c78-729989.html.\n\n   *  dhcpcd: Client implementation.  Works on many Linux and BSD\n      distributions, but seems to be the default client for various BSD\n      flavors.  Open source (BSD).  Maturity: widely used, in particular\n      on BSD systems.  Source: https://github.com/NetworkConfiguration/\n      dhcpcd  .\n\n   *  dhcpd (ISC): Client, relay and server implementation, present in\n      most Linux and BSD distributions.  Open source (Mozilla Public\n      License v2).  The project is no longer developed, but the software\n      is still in wide use.  Source: https://www.isc.org/dhcp/ . \n   *  dibbler: Client, relay and server implementation.  Limited\n      compatibility with RFC8415.  Open source (GNU GPLv2).  The project\n      is no longer developed, but the software is still in wide use.\n      The biggest known deployment is 16 million devices.  One of the\n      authors of this I-D was the leading developer.  Source:https://klub.com.pl/dhcpv6/ .\n\n   *  dnsmasq: Probably the most popular implementation in terms of\n      number of devices.  Very popular among CPE and various home\n      appliances.  Client and server implementation with some relay\n      capabilities.  Open source (GPL v2 or v3).  Source:https://dnsmasq.org/ .\n\n   *  EdgeMax (Ubiquiti): Proprietary implementation running on EdgeMax\n      hardware, home and small enterprise gateways and switches.\n      Focused on DHCPv6-PD.  Source: https://help.ui.com/hc/en-us/\n      articles/115002531728-EdgeRouter-Beginners-Guide-to-EdgeRouter .\n\n   *  EOS (Arista): Proprietary implementation for network switches,\n      routers and other networking hardware.  RFC8415 support explicitly\n      stated.  Server, client, relay implementation.  Source:https://www.arista.com/en/um-eos/eos-ipv6 .\n\n   *  FreeRADIUS: RADIUS implementation that also provides DHCPv6 server\n      functionality.  Open source.\n\n   *  Huawei: Server, client and relay functionalities are available on\n      most routers and switches.  Proprietary.  Source:https://support.huawei.com/hedex/\n      hdx .do?docid=EDOC1100247463&id=EN-US_TASK_0176372622, see\n      \"Configuring Server/Relay/client/PD client\" on the left panel.\n\n   *  iOS (Apple): Client implementation running on Apple portable\n      devices (iPhones, iPads, etc.).  Proprietary.  The implementation\n      is widely used.\n\n   *  IOS (Cisco): Server, relay, and client implementation that runs on\n      Cisco routers, switches and other networking hardware.\n      Proprietary.  Widely used.  Source:https://community.cisco.com/t5/networking-knowledge-base/part-1-\n      implementing-dhcpv6-stateful-dhcpv6/ta-p/3145631 .\n\n   *  Kea (ISC): Server implementation.  Open source (Mozilla Public\n      License v2).  It is a modern replacement for now retired isc-dhcp.\n      More than 500 users subscribed to the mailing list.  One of the\n      authors of this I-D is the lead developer.  Source:https://kea.readthedocs.io/en/kea-2.4.0/arm/dhcp6-\n      srv.html#supported-dhcpv6-standards  . \n   *  JunOS (Juniper): Server, relay, and client implementation that\n      runs on Juniper routers, switches, and other networking hardware.\n      Proprietary.  Widely used.  Source:https://www.juniper.net/documentation/us/en/software/junos/dhcp/\n      topics/topic-map/dhcpv6-server.html  .\n\n   *  macOS (Apple): Client implementation for Macs (laptops and\n      desktops).  Proprietary.  Widely used.\n\n   *  odhcp6c (OpenWRT): Minimalistic client implementation intended for\n      embedded environment.  Open source (GPL-2).  Source:https://github.com/openwrt/odhcp6c  .\n\n   *  RouterOS (Mikrotik): Server, relay, and client implementation\n      running on Mikrotik networking hardware (routers, switches, many\n      other appliances).  Proprietary.  Sources:https://wiki.mikrotik.com/wiki/Manual:IPv6/DHCP_Client ,https://wiki.mikrotik.com/wiki/Manual:IPv6/DHCP_Server ,https://wiki.mikrotik.com/wiki/Manual:RouterOS6_news  .\n\n   *  ServPoET (Finepoint): Server implementation.  Proprietary.  One of\n      the authors of this I-D was the lead developer.  Source:https://finepoint.com/servpoet/ .\n\n   *  udhcpc6 (busybox): Minimum footprint implementation, intended for\n      embedded devices.  It used to be a separate project (udhcpc6), but\n      it is now part of the BusyBox project.  Open source (GPL-v2).\n      Client implementation.  Source: https://udhcp.busybox.net/\n      README.udhcpc  .\n\n   *  Unifi (Ubiquiti): Server, relay, and client implementation running\n      on UniFi hardware (routers, switches, firewalls).  Proprietary.\n      Source: https://help.ui.com/hc/en-us/articles/115005868927-UniFi-\n      Gateway-Static-IPv6-and-DHCPv6-Prefix-Delegation .\n\n   *  Windows (Microsoft): Microsoft Windows provides client\n      implementation, which is probably still the most popular OS on\n      desktops and laptops.  The server version of Windows provides\n      DHCPv6 server implementation.  Proprietary.\n\n   The DHCPv6 support is also mandated by some third party specs.  For\n   example, all cable modems conformant to DOCSIS3.0 or later must\n   support DHCPv6 client functionality.\n\n   There are many large scale deployments that use DHCPv6.  One of them\n   is Comcast's Xfinity.  Authors are aware of many other large scale\n   country wide deployments, but due to signed Non-Disclosure Agreements\n   cannot list them. \n   University of New Hampshire's InterOperability Laboratory runs USGv6\n   Testing Program.  Testing DHCPv6 compliance is one aspect of the\n   program.\n\n   While the original IPv6 Ready Logo testing involved the original\n   DHCPv6 specifications (primarily RFC3315, RFC3633), the large number\n   of tested and certified implementations supports the breadth and\n   depth of DHCPv6 implementations available and deployed in the\n   marketplace over the years that confirm the protocol specifications\n   are up to Internet Standard.  See https://www.ipv6ready.org/db/index.php/public/   search/?l=&c=&ds=&de=&pc=&ap=2&oem=&etc=D&fw=&vn=&do=1&o=6.-",
        "children": {}
      },
      "23": {
        "title": "Security Considerations",
        "content": "   This section discusses security considerations that are not related\n   to privacy.  See Section 24 for a discussion dedicated to privacy.\n\n   The threat to DHCP is inherently an insider threat (assuming a\n   properly configured network where DHCP ports are blocked on the\n   perimeter gateways of the enterprise).  Regardless of the gateway\n   configuration, however, the potential attacks by insiders and\n   outsiders are the same.\n\n   DHCP lacks end-to-end encryption between clients and servers; thus,\n   hijacking, tampering, and eavesdropping attacks are all possible as a\n   result.  Some network environments (discussed below) can be secured\n   through various means to minimize these attacks.\n\n   The threat common to both the client and the server is the \"resource-\n   exhaustion\" DoS attack.  These attacks typically involve the\n   exhaustion of available assigned addresses or delegatable prefixes,\n   or the exhaustion of CPU or network bandwidth, and are present any\n   time there is a shared resource.  Some forms of these exhaustion\n   attacks can be partially mitigated by appropriate server policy,\n   e.g., limiting the maximum number of leases any one client can get,\n   limiting the number of leases one client can decline, and limiting\n   number of messages a single client can transmit of a period of time.",
        "children": {
          "23.1": {
            "title": "Client Security Considerations",
            "content": "   One attack specific to a DHCP client is the establishment of a\n   malicious server with the intent of providing incorrect configuration\n   information to the client.  The motivation for doing so may be to\n   mount a \"man in the middle\" attack that causes the client to\n   communicate with a malicious server instead of a valid server for\n   some service (such as DNS or NTP).  The malicious server may also\n   mount a DoS attack through misconfiguration of the client; this \n   attack would cause all network communication from the client to fail.\n\n   A malicious DHCP server might cause a client to set its SOL_MAX_RT\n   and INF_MAX_RT parameters to an unreasonably high value with the\n   SOL_MAX_RT (see Section 21.24) and INF_MAX_RT (see Section 21.25)\n   options; this may cause an undue delay in a client completing its\n   DHCP protocol transaction in the case where no other valid response\n   is received.  Assuming that the client also receives a response from\n   a valid DHCP server, large values for SOL_MAX_RT and INF_MAX_RT will\n   not have any effect.\n\n   Another threat to DHCP clients originates from mistakenly or\n   accidentally configured DHCP servers that answer DHCP client requests\n   with unintentionally incorrect configuration parameters.\n\n   If a client implementation supports the reconfigure mechanism, also\n   see Section 23.3 below.",
            "children": {}
          },
          "23.2": {
            "title": "Server Security Considerations",
            "content": "   The threat specific to a DHCP server is an invalid client\n   masquerading as a valid client.  The motivation for this may be for\n   theft of service, or to circumvent auditing for any number of\n   nefarious purposes.\n\n   The messages exchanged between relay agents and servers may be used\n   to mount a man-in-the-middle or DoS attack.  Communication between a\n   server and a relay agent, and communication between relay agents, can\n   be authenticated and encrypted through the use of IPsec, as described\n   in [RFC8213].\n\n   However, the use of manually configured pre-shared keys for IPsec\n   between relay agents and servers does not defend against replayed\n   DHCP messages.  Replayed messages can represent a DoS attack through\n   exhaustion of processing resources but not through misconfiguration\n   or exhaustion of other resources such as assignable addresses and\n   delegatable prefixes.\n\n   If a server implementation supports the reconfigure mechanism, also\n   see Section 23.3 below.",
            "children": {}
          },
          "23.3": {
            "title": "Reconfigure Security Considerations",
            "content": "   RKAP, described in Section 20.4, provides protection against the use\n   of a Reconfigure message by a malicious DHCP server to mount a DoS or\n   man-in-the-middle attack on a client.  This protocol can be\n   compromised by an attacker that can intercept the initial message in\n   which the DHCP server sends the key as plain text to the client. \n   Because of the opportunity for attack through the Reconfigure\n   message, a DHCP client MUST discard any Reconfigure message that does\n   not include authentication or that does not pass the validation\n   process for the authentication protocol.\n\n   A DHCP client may also be subject to attack through the receipt of a\n   Reconfigure message from a malicious server that causes the client to\n   obtain incorrect configuration information from that server.  Note\n   that although a client sends its response (Renew, Rebind, or\n   Information-request message) through a relay agent and, therefore,\n   that response will only be received by servers to which DHCP messages\n   are relayed, a malicious server could send a Reconfigure message to a\n   client, followed (after an appropriate delay) by a Reply message that\n   would be accepted by the client.  Thus, a malicious server that is\n   not on the network path between the client and the server may still\n   be able to mount a Reconfigure attack on a client.  The use of\n   transaction IDs that are cryptographically sound and cannot easily be\n   predicted will also reduce the probability that such an attack will\n   be successful.",
            "children": {}
          },
          "23.4": {
            "title": "Mitigation Considerations",
            "content": "   Various network environments also offer levels of security if\n   deployed as described below.\n\n   *  In enterprise and factory networks, use of authentication per\n      [IEEE-802.1x ] can prevent unknown or untrusted clients from\n      connecting to the network.  However, this does not necessarily\n      assure that the connected client will be a good DHCP or network\n      actor.\n\n   *  For wired networks where clients typically are connected to a\n      switch port, snooping DHCP multicast (or unicast) traffic becomes\n      difficult, as the switches limit the traffic delivered to a port.\n      The client's DHCP multicast messages (with destination address\n      fe02::1:2) are only forwarded to the DHCP server's (or relay's)\n      switch port -- not all ports.  Also, the server's (or relay's)\n      unicast replies are only delivered to the target client's port --\n      not all ports.\n\n   *  In public networks (such as a Wi-Fi network in a coffee shop or\n      airport), it is possible for others within radio range to snoop\n      DHCP and other traffic.  But in these environments, there is very\n      little if anything that can be learned from the DHCP traffic\n      itself (either from client to server or from server to client) if\n      the privacy considerations provided in Section 24 are followed.\n      Even for devices that do not follow the privacy considerations,\n      there is little that can be learned that would not be available \n      from subsequent communications anyway (such as the device's Media\n      Access Control (MAC) address).  Also, because all clients will\n      typically receive similar configuration details, a bad actor that\n      initiates a DHCP request itself can learn much of such\n      information.  As mentioned above, one threat is that the RKAP key\n      for a client can be learned (if the initial\n      Solicit/Advertise/Request/Reply exchange is monitored) and trigger\n      a premature reconfiguration, but this is relatively easily\n      prevented by disallowing direct client-to-client communication on\n      these networks or using [RFC7610] and [RFC7513].\n\n   Many of the attacks by rogue servers can be mitigated by making use\n   of the mechanisms described in [RFC7610] and [RFC7513].",
            "children": {}
          }
        }
      },
      "24": {
        "title": "Privacy Considerations",
        "content": "   For an extended discussion about privacy considerations for the\n   client, see [RFC7824]:\n\n   *  In particular, its Section 3 discusses various identifiers that\n      could be misused to track the client.\n\n   *  Its Section 4 discusses existing mechanisms that may have an\n      impact on a client's privacy.\n\n   *  Finally, its Section 5 discusses potential attack vectors.\n\n   For recommendations regarding how to address or mitigate those\n   issues, see [RFC7844].\n\n   This specification does not define any allocation strategies for\n   servers.  Implementers are expected to develop their own algorithm\n   for the server to choose a resource out of the available pool.\n   Several possible allocation strategies are mentioned in Section 4.3\n   of [RFC7824].  Please keep in mind that the list in [RFC7824] is not\n   exhaustive; there are certainly other possible strategies.  Readers\n   are also encouraged to read [RFC7707] -- in particular, its Section 4.1.2, which discusses the problems with certain allocation\n   strategies.",
        "children": {}
      },
      "25": {
        "title": "IANA Considerations",
        "content": "   This document does not define any new DHCP name spaces or\n   definitions.\n\n   The publication of this document does not change the assignment rules\n   for new values for message types, option codes, DUID types, or status\n   codes. \n   The list of assigned values used in DHCPv6 is available at\n   <https://www.iana.org/assignments/dhcpv6-parameters >.\n\n   IANA is requested to update all references to [RFC8415] to this\n   document at <https://www.iana.org/assignments/dhcpv6-parameters >.\n\n   IANA is requested to add a new column \"Status\" to all registries on\n   the DHCPv6 parameters page at <https://www.iana.org/assignments/\n   dhcpv6-parameters > and leave each entry blank except as indicated\n   below:\n\n   *  In the Option Code registry, set the \"Status\" column value to\n      \"Obsolete\" for the IA_TA (option code 4) and UNICAST (option code\n      12) rows.\n\n   *  In the Status Codes registry, set the \"Status\" column value to\n      \"Obsolete\" for the UseMulticast (status code 5) row.\n\n   IANA is requested to update other references to [RFC8415] with\n   references to this document at:\n\n   *  https://www.iana.org/assignments/auth-namespaces  (four entries)\n\n   *  https://www.iana.org/assignments/bootp-dhcp-parameters  (two\n      entries)\n\n   *  https://www.iana.org/assignments/ipv6-multicast-addresses  (two\n      entries)\n\n   *  https://www.iana.org/assignments/service-names-port-numbers  (two\n      entries; UDP ports 546 and 547)",
        "children": {}
      },
      "A": {
        "title": "Summary of Changes",
        "content": "   This appendix provides a summary of the changes made from RFC8415:\n\n   1.  The following mechanisms were obsoleted.  These were not widely\n       deployed while adding complexity to client and server\n       implementations.  Legacy implementations MAY support them, but\n       implementations conformant to this document MUST NOT rely on\n       them.  Obsoleting these features does not cause any\n       interoperatability issues when mixing updated and non-updated\n       clients, relay agents, and servers as these mechanisms were\n       \"optional\".\n\n       IA_TA option.  The Identity Association for Temporary Addresses\n          option has been obsoleted.  A client that needs a short-term /\n          special purpose address can use a new IA_NA binding to request\n          an address and release it when finished with it.\n\n       UNICAST option.  The Server Unicast option has been obsoleted.\n          Use of this was rarely practical as typically relay agents\n          between the client and server need to glean information from\n          the communication and cannot be bypassed.\n\n       UseMulticast status code.  The UseMulticast status code has been\n          obsoleted.  Clients will always multicast messages (as Server\n          Unicast option has been obsoleted) and servers will no longer\n          check for unicast traffic.\n\n   2.  The following errata for RFC 8415 were incorporated: erratum IDs\n       6159, 6269 and 6183.  Note that erratum ID 6269 was no longer\n       applicable after the Server Unicast Option was obsoleted.  Note\n       that erratum 6159 is also no longer applicable now that temporary\n       addresses have been obsoleted.  Indeed, the section (6.5) that\n       erratum 6159 corrects has been deleted. \n   3.  A reference to RFC 7943 was added to Section 13.1 as it documents\n       a method that might be used to generate addresses and was\n       inadvertently missed when compiling RFC 8415.\n\n   4.  Clarified the UDP ports used by clients, servers, and relay\n       agents (Section 7.2).\n\n   5.  Several additional RFCs have been referenced and editorial and\n       reviews comments incorporated.",
        "children": {}
      },
      "B": {
        "title": "Appearance of Options in Message Types",
        "content": "   The following tables indicate with a \"*\" the options that are allowed\n   in each DHCP message type.\n\n   These tables are informational.  If they conflict with text earlier\n   in this document, that text should be considered authoritative.\n\n           Client Server                         Elap. Relay\n             ID     ID   IA_NA IA_PD  ORO   Pref Time   Msg. Auth.\n   Solicit   *             *     *     *           *\n   Advert.   *      *      *     *           *\n   Request   *      *      *     *     *           *\n   Confirm   *             *                       *\n   Renew     *      *      *     *     *           *\n   Rebind    *             *     *     *           *\n   Decline   *      *      *     *                 *\n   Release   *      *      *     *                 *\n   Reply     *      *      *     *                             *\n   Reconf.   *      *                                          *\n   Inform.   * (see note)              *           *\n   R-forw.                                               *\n   R-repl.                                               *\n\n   NOTE: The Server Identifier option (see Section 21.3) is only\n   included in Information-request messages that are sent in response to\n   a Reconfigure (see Section 18.2.6). \n                                                                  Info\n           Status  Rap. User  Vendor Vendor Inter. Recon. Recon. Refresh\n            Code  Comm. Class Class  Spec.    ID    Msg.  Accept  Time\n   Solicit          *     *     *      *                    *\n   Advert.   *            *     *      *                    *\n   Request                *     *      *                    *\n   Confirm                *     *      *\n   Renew                  *     *      *                    *\n   Rebind                 *     *      *                    *\n   Decline                *     *      *\n   Release                *     *      *\n   Reply     *      *     *     *      *                    *        *\n   Reconf.                                           *\n   Inform.                *     *      *                    *\n   R-forw.                             *      *\n   R-repl.                             *      *\n\n           SOL_MAX_RT  INF_MAX_RT\n   Solicit\n   Advert.    *\n   Request\n   Confirm\n   Renew\n   Rebind\n   Decline\n   Release\n   Reply      *           *\n   Reconf.\n   Inform.\n   R-forw.\n   R-repl.",
        "children": {}
      },
      "C": {
        "title": "Appearance of Options in the \"options\" Field of DHCP",
        "content": "             Options\n",
        "children": {}
      }
    }
  }
]